[tox]
envlist = 
    py38-sqlalchemy14,
    py38-sqlalchemy20,
    py39-sqlalchemy14,
    py39-sqlalchemy20,
    py310-sqlalchemy14,
    py310-sqlalchemy20,
    py311-sqlalchemy14,
    py311-sqlalchemy20,
    py312-sqlalchemy14,
    py312-sqlalchemy20

[testenv]
deps =
    sqlalchemy14: SQLAlchemy>=1.4.0,<2.0.0
    sqlalchemy20: SQLAlchemy>=2.0.0,<3.0.0
    pytest>=6.0
    pytest-asyncio>=0.18.0
    pytest-cov>=3.0
    PyMySQL>=1.0.0
    aiomysql>=0.1.0
    typing-extensions>=4.0.0
    python-dateutil>=2.8.0

commands =
    pytest tests/offline/ -v --tb=short
    pytest tests/online/ -v --tb=short --maxfail=3

[testenv:lint]
deps =
    black>=22.0
    flake8>=4.0
    mypy>=0.950
    isort>=5.0
commands =
    black matrixone/ --check --diff
    flake8 matrixone/ --max-line-length=120 --ignore=E203,W503
    isort matrixone/ --check-only --diff
    mypy matrixone/ --ignore-missing-imports

[testenv:docs]
deps =
    sphinx>=4.0
    sphinx-rtd-theme>=1.0
    sphinx-autobuild>=2021.3.14
commands =
    sphinx-build -b html docs docs/_build/html
    sphinx-build -b linkcheck docs docs/_build/linkcheck
