drop table if exists t1;
create table t1 (a year not null, primary key(a));
desc t1;
â¤ Field[1,0,0]  Â¦  Type[1,0,0]  Â¦  Null[1,0,0]  Â¦  Key[1,0,0]  Â¦  Default[1,0,0]  Â¦  Extra[1,0,0]  Â¦  Comment[1,0,0]  ğ„€
a  Â¦  YEAR(4)  Â¦  NO  Â¦  PRI  Â¦  null  Â¦    Â¦  
drop table t1;
create table t1 (a year(4) not null);
desc t1;
â¤ Field[1,0,0]  Â¦  Type[1,0,0]  Â¦  Null[1,0,0]  Â¦  Key[1,0,0]  Â¦  Default[1,0,0]  Â¦  Extra[1,0,0]  Â¦  Comment[1,0,0]  ğ„€
a  Â¦  YEAR(4)  Â¦  NO  Â¦    Â¦  null  Â¦    Â¦  
drop table t1;
drop table if exists t_year;
create table t_year (id int, y year);
insert into t_year values (1, 2024);
insert into t_year values (2, 1901);
insert into t_year values (3, 2155);
insert into t_year values (4, 1970);
insert into t_year values (5, 2000);
insert into t_year values (10, '2024');
insert into t_year values (11, '1901');
insert into t_year values (12, '2155');
insert into t_year values (20, '0');
insert into t_year values (21, '00');
insert into t_year values (22, '24');
insert into t_year values (23, '69');
insert into t_year values (24, '70');
insert into t_year values (25, '99');
insert into t_year values (30, 1);
insert into t_year values (31, 24);
insert into t_year values (32, 69);
insert into t_year values (33, 70);
insert into t_year values (34, 99);
insert into t_year values (40, 0);
insert into t_year values (50, NULL);
select * from t_year order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
1  Â¦  2024-01-01  ğ„€
2  Â¦  1901-01-01  ğ„€
3  Â¦  2155-01-01  ğ„€
4  Â¦  1970-01-01  ğ„€
5  Â¦  2000-01-01  ğ„€
10  Â¦  2024-01-01  ğ„€
11  Â¦  1901-01-01  ğ„€
12  Â¦  2155-01-01  ğ„€
20  Â¦  2000-01-01  ğ„€
21  Â¦  2000-01-01  ğ„€
22  Â¦  2024-01-01  ğ„€
23  Â¦  2069-01-01  ğ„€
24  Â¦  1970-01-01  ğ„€
25  Â¦  1999-01-01  ğ„€
30  Â¦  2001-01-01  ğ„€
31  Â¦  2024-01-01  ğ„€
32  Â¦  2069-01-01  ğ„€
33  Â¦  1970-01-01  ğ„€
34  Â¦  1999-01-01  ğ„€
40  Â¦  2000-01-01  ğ„€
50  Â¦  null
select y from t_year where id = 1;
â¤ y[91,2147483647,0]  ğ„€
2024-01-01
select y from t_year where id = 40;
â¤ y[91,2147483647,0]  ğ„€
2000-01-01
select y from t_year where id = 50;
â¤ y[91,2147483647,0]  ğ„€
null
select cast(y as signed) from t_year where id = 1;
â¤ cast(y as signed)[-5,64,0]  ğ„€
2024
select cast(y as signed) from t_year where id = 40;
â¤ cast(y as signed)[-5,64,0]  ğ„€
0
select cast(y as unsigned) from t_year where id = 1;
â¤ cast(y as unsigned)[-5,64,0]  ğ„€
2024
select cast(2024 as year);
â¤ cast(2024 as year)[91,2147483647,0]  ğ„€
2024-01-01
select cast(0 as year);
â¤ cast(0 as year)[91,2147483647,0]  ğ„€
2000-01-01
select cast(24 as year);
â¤ cast(24 as year)[91,2147483647,0]  ğ„€
2024-01-01
select cast(70 as year);
â¤ cast(70 as year)[91,2147483647,0]  ğ„€
1970-01-01
select cast(y as char(4)) from t_year where id = 1;
â¤ cast(y as char(4))[1,4,0]  ğ„€
2024
select cast(y as char(4)) from t_year where id = 40;
â¤ cast(y as char(4))[1,4,0]  ğ„€
0000
select cast(y as varchar(10)) from t_year where id = 1;
â¤ cast(y as varchar(10))[12,-1,0]  ğ„€
2024
select cast('2024' as year);
â¤ cast(2024 as year)[91,2147483647,0]  ğ„€
2024-01-01
select cast('0' as year);
â¤ cast(0 as year)[91,2147483647,0]  ğ„€
2000-01-01
select cast('00' as year);
â¤ cast(00 as year)[91,2147483647,0]  ğ„€
2000-01-01
select cast('24' as year);
â¤ cast(24 as year)[91,2147483647,0]  ğ„€
2024-01-01
select cast('70' as year);
â¤ cast(70 as year)[91,2147483647,0]  ğ„€
1970-01-01
select cast(cast('2024-06-15' as date) as year);
â¤ cast(cast(2024-06-15 as date) as year)[91,2147483647,0]  ğ„€
2024-01-01
select cast(cast('1999-12-31' as date) as year);
â¤ cast(cast(1999-12-31 as date) as year)[91,2147483647,0]  ğ„€
1999-01-01
select cast(cast('2024-06-15 10:30:00' as datetime) as year);
â¤ cast(cast(2024-06-15 10:30:00 as datetime) as year)[91,2147483647,0]  ğ„€
2024-01-01
select cast(cast('2024-06-15 10:30:00' as timestamp) as year);
â¤ cast(cast(2024-06-15 10:30:00 as timestamp) as year)[91,2147483647,0]  ğ„€
2024-01-01
select * from t_year where y = 2024 order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
1  Â¦  2024-01-01  ğ„€
10  Â¦  2024-01-01  ğ„€
22  Â¦  2024-01-01  ğ„€
31  Â¦  2024-01-01
select * from t_year where y = '2024' order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
1  Â¦  2024-01-01  ğ„€
10  Â¦  2024-01-01  ğ„€
22  Â¦  2024-01-01  ğ„€
31  Â¦  2024-01-01
select * from t_year where y < 2000 order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
2  Â¦  1901-01-01  ğ„€
4  Â¦  1970-01-01  ğ„€
11  Â¦  1901-01-01  ğ„€
24  Â¦  1970-01-01  ğ„€
25  Â¦  1999-01-01  ğ„€
33  Â¦  1970-01-01  ğ„€
34  Â¦  1999-01-01  ğ„€
40  Â¦  2000-01-01
select * from t_year where y > 2000 order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
1  Â¦  2024-01-01  ğ„€
3  Â¦  2155-01-01  ğ„€
10  Â¦  2024-01-01  ğ„€
12  Â¦  2155-01-01  ğ„€
22  Â¦  2024-01-01  ğ„€
23  Â¦  2069-01-01  ğ„€
30  Â¦  2001-01-01  ğ„€
31  Â¦  2024-01-01  ğ„€
32  Â¦  2069-01-01
select * from t_year where y <= 1970 order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
2  Â¦  1901-01-01  ğ„€
4  Â¦  1970-01-01  ğ„€
11  Â¦  1901-01-01  ğ„€
24  Â¦  1970-01-01  ğ„€
33  Â¦  1970-01-01  ğ„€
40  Â¦  2000-01-01
select * from t_year where y >= 2024 order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
1  Â¦  2024-01-01  ğ„€
3  Â¦  2155-01-01  ğ„€
10  Â¦  2024-01-01  ğ„€
12  Â¦  2155-01-01  ğ„€
22  Â¦  2024-01-01  ğ„€
23  Â¦  2069-01-01  ğ„€
31  Â¦  2024-01-01  ğ„€
32  Â¦  2069-01-01
select * from t_year where y between 1970 and 2000 order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
4  Â¦  1970-01-01  ğ„€
5  Â¦  2000-01-01  ğ„€
20  Â¦  2000-01-01  ğ„€
21  Â¦  2000-01-01  ğ„€
24  Â¦  1970-01-01  ğ„€
25  Â¦  1999-01-01  ğ„€
33  Â¦  1970-01-01  ğ„€
34  Â¦  1999-01-01
select * from t_year where y in (2024, 1901, 2155) order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
1  Â¦  2024-01-01  ğ„€
2  Â¦  1901-01-01  ğ„€
3  Â¦  2155-01-01  ğ„€
10  Â¦  2024-01-01  ğ„€
11  Â¦  1901-01-01  ğ„€
12  Â¦  2155-01-01  ğ„€
22  Â¦  2024-01-01  ğ„€
31  Â¦  2024-01-01
select * from t_year where y is null;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
50  Â¦  null
select * from t_year where y is not null order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
1  Â¦  2024-01-01  ğ„€
2  Â¦  1901-01-01  ğ„€
3  Â¦  2155-01-01  ğ„€
4  Â¦  1970-01-01  ğ„€
5  Â¦  2000-01-01  ğ„€
10  Â¦  2024-01-01  ğ„€
11  Â¦  1901-01-01  ğ„€
12  Â¦  2155-01-01  ğ„€
20  Â¦  2000-01-01  ğ„€
21  Â¦  2000-01-01  ğ„€
22  Â¦  2024-01-01  ğ„€
23  Â¦  2069-01-01  ğ„€
24  Â¦  1970-01-01  ğ„€
25  Â¦  1999-01-01  ğ„€
30  Â¦  2001-01-01  ğ„€
31  Â¦  2024-01-01  ğ„€
32  Â¦  2069-01-01  ğ„€
33  Â¦  1970-01-01  ğ„€
34  Â¦  1999-01-01  ğ„€
40  Â¦  2000-01-01
select * from t_year where y is not null order by y asc;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
40  Â¦  2000-01-01  ğ„€
2  Â¦  1901-01-01  ğ„€
11  Â¦  1901-01-01  ğ„€
24  Â¦  1970-01-01  ğ„€
4  Â¦  1970-01-01  ğ„€
33  Â¦  1970-01-01  ğ„€
34  Â¦  1999-01-01  ğ„€
25  Â¦  1999-01-01  ğ„€
5  Â¦  2000-01-01  ğ„€
20  Â¦  2000-01-01  ğ„€
21  Â¦  2000-01-01  ğ„€
30  Â¦  2001-01-01  ğ„€
22  Â¦  2024-01-01  ğ„€
1  Â¦  2024-01-01  ğ„€
31  Â¦  2024-01-01  ğ„€
10  Â¦  2024-01-01  ğ„€
23  Â¦  2069-01-01  ğ„€
32  Â¦  2069-01-01  ğ„€
12  Â¦  2155-01-01  ğ„€
3  Â¦  2155-01-01
select * from t_year where y is not null order by y desc;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
12  Â¦  2155-01-01  ğ„€
3  Â¦  2155-01-01  ğ„€
32  Â¦  2069-01-01  ğ„€
23  Â¦  2069-01-01  ğ„€
22  Â¦  2024-01-01  ğ„€
1  Â¦  2024-01-01  ğ„€
31  Â¦  2024-01-01  ğ„€
10  Â¦  2024-01-01  ğ„€
30  Â¦  2001-01-01  ğ„€
20  Â¦  2000-01-01  ğ„€
21  Â¦  2000-01-01  ğ„€
5  Â¦  2000-01-01  ğ„€
25  Â¦  1999-01-01  ğ„€
34  Â¦  1999-01-01  ğ„€
4  Â¦  1970-01-01  ğ„€
24  Â¦  1970-01-01  ğ„€
33  Â¦  1970-01-01  ğ„€
11  Â¦  1901-01-01  ğ„€
2  Â¦  1901-01-01  ğ„€
40  Â¦  2000-01-01
select min(y), max(y) from t_year where y is not null and y > 0;
â¤ min(y)[91,2147483647,0]  Â¦  max(y)[91,2147483647,0]  ğ„€
1901-01-01  Â¦  2155-01-01
select count(y) from t_year;
â¤ count(y)[-5,64,0]  ğ„€
20
select count(*) from t_year where y is null;
â¤ count(*)[-5,64,0]  ğ„€
1
update t_year set y = 2025 where id = 1;
select * from t_year where id = 1;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
1  Â¦  2025-01-01
update t_year set y = '75' where id = 2;
select * from t_year where id = 2;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
2  Â¦  1975-01-01
delete from t_year where y = 0;
select * from t_year where id = 40;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]
select cast(1901 as year);
â¤ cast(1901 as year)[91,2147483647,0]  ğ„€
1901-01-01
select cast(2155 as year);
â¤ cast(2155 as year)[91,2147483647,0]  ğ„€
2155-01-01
drop table if exists t_year_pk;
create table t_year_pk (y year primary key, name varchar(50));
insert into t_year_pk values (2020, 'year2020');
insert into t_year_pk values (2021, 'year2021');
insert into t_year_pk values (2022, 'year2022');
select * from t_year_pk order by y;
â¤ y[91,2147483647,0]  Â¦  name[12,-1,0]  ğ„€
2020-01-01  Â¦  year2020  ğ„€
2021-01-01  Â¦  year2021  ğ„€
2022-01-01  Â¦  year2022
drop table t_year_pk;
drop table if exists t_year_default;
create table t_year_default (id int, y year default 2024);
insert into t_year_default (id) values (1);
insert into t_year_default values (2, 2023);
select * from t_year_default order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
1  Â¦  2024-01-01  ğ„€
2  Â¦  2023-01-01
drop table t_year_default;
drop table if exists t1;
drop table if exists t2;
create table t1 (y year, val int);
create table t2 (y year, name varchar(20));
insert into t1 values (2020, 1), (2021, 2), (2022, 3);
insert into t2 values (2020, 'a'), (2021, 'b'), (2023, 'c');
select t1.y, t1.val, t2.name from t1 join t2 on t1.y = t2.y order by t1.y;
â¤ y[91,2147483647,0]  Â¦  val[4,32,0]  Â¦  name[12,-1,0]  ğ„€
2020-01-01  Â¦  1  Â¦  a  ğ„€
2021-01-01  Â¦  2  Â¦  b
drop table t1;
drop table t2;
drop table if exists t_year_boundary;
create table t_year_boundary (id int, y year);
insert into t_year_boundary values (1, 1901);
insert into t_year_boundary values (2, 2155);
insert into t_year_boundary values (3, 0);
insert into t_year_boundary values (4, '0000');
select * from t_year_boundary order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
1  Â¦  1901-01-01  ğ„€
2  Â¦  2155-01-01  ğ„€
3  Â¦  2000-01-01  ğ„€
4  Â¦  2000-01-01
drop table t_year_boundary;
select cast(1900 as year);
â¤ cast(1900 as year)[91,2147483647,0]  ğ„€
null
select cast(2156 as year);
â¤ cast(2156 as year)[91,2147483647,0]  ğ„€
null
select cast(-1 as year);
â¤ cast(-1 as year)[91,2147483647,0]  ğ„€
null
select cast(10000 as year);
â¤ cast(10000 as year)[91,2147483647,0]  ğ„€
null
select cast('abc' as year);
â¤ cast(abc as year)[91,2147483647,0]  ğ„€
null
select cast('20.24' as year);
â¤ cast(20.24 as year)[91,2147483647,0]  ğ„€
null
select cast('2024.5' as year);
â¤ cast(2024.5 as year)[91,2147483647,0]  ğ„€
null
drop table if exists t_year_arith;
create table t_year_arith (y year);
insert into t_year_arith values (2020), (2021), (2022);
select y, y + 1 from t_year_arith order by y;
â¤ y[91,2147483647,0]  Â¦  y + 1[-5,64,0]  ğ„€
2020-01-01  Â¦  2021  ğ„€
2021-01-01  Â¦  2022  ğ„€
2022-01-01  Â¦  2023
select y, y + 10 from t_year_arith order by y;
â¤ y[91,2147483647,0]  Â¦  y + 10[-5,64,0]  ğ„€
2020-01-01  Â¦  2030  ğ„€
2021-01-01  Â¦  2031  ğ„€
2022-01-01  Â¦  2032
select y, y - 1 from t_year_arith order by y;
â¤ y[91,2147483647,0]  Â¦  y - 1[-5,64,0]  ğ„€
2020-01-01  Â¦  2019  ğ„€
2021-01-01  Â¦  2020  ğ„€
2022-01-01  Â¦  2021
select y, y - 20 from t_year_arith order by y;
â¤ y[91,2147483647,0]  Â¦  y - 20[-5,64,0]  ğ„€
2020-01-01  Â¦  2000  ğ„€
2021-01-01  Â¦  2001  ğ„€
2022-01-01  Â¦  2002
select y, y * 2 from t_year_arith order by y;
â¤ y[91,2147483647,0]  Â¦  y * 2[-5,64,0]  ğ„€
2020-01-01  Â¦  4040  ğ„€
2021-01-01  Â¦  4042  ğ„€
2022-01-01  Â¦  4044
select y, y / 2 from t_year_arith order by y;
â¤ y[91,2147483647,0]  Â¦  y / 2[8,54,0]  ğ„€
2020-01-01  Â¦  1010.0  ğ„€
2021-01-01  Â¦  1010.5  ğ„€
2022-01-01  Â¦  1011.0
select y, y / 4 from t_year_arith order by y;
â¤ y[91,2147483647,0]  Â¦  y / 4[8,54,0]  ğ„€
2020-01-01  Â¦  505.0  ğ„€
2021-01-01  Â¦  505.25  ğ„€
2022-01-01  Â¦  505.5
select max(y) - min(y) as year_diff from t_year_arith;
â¤ year_diff[-5,64,0]  ğ„€
2
drop table t_year_arith;
drop table if exists t_year_group;
create table t_year_group (id int, y year, category varchar(10));
insert into t_year_group values (1, 2020, 'A');
insert into t_year_group values (2, 2020, 'B');
insert into t_year_group values (3, 2021, 'A');
insert into t_year_group values (4, 2021, 'B');
insert into t_year_group values (5, 2022, 'A');
select y, count(*) as cnt from t_year_group group by y order by y;
â¤ y[91,2147483647,0]  Â¦  cnt[-5,64,0]  ğ„€
2020-01-01  Â¦  2  ğ„€
2021-01-01  Â¦  2  ğ„€
2022-01-01  Â¦  1
select distinct y from t_year_group order by y;
â¤ y[91,2147483647,0]  ğ„€
2020-01-01  ğ„€
2021-01-01  ğ„€
2022-01-01
select y, count(*) as cnt from t_year_group group by y having count(*) > 1 order by y;
â¤ y[91,2147483647,0]  Â¦  cnt[-5,64,0]  ğ„€
2020-01-01  Â¦  2  ğ„€
2021-01-01  Â¦  2
drop table t_year_group;
drop table if exists t_year_sub;
create table t_year_sub (id int, y year);
insert into t_year_sub values (1, 2020), (2, 2021), (3, 2022), (4, 2023);
select * from t_year_sub where y = (select max(y) from t_year_sub);
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
4  Â¦  2023-01-01
select * from t_year_sub where y in (select y from t_year_sub where y > 2021) order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
3  Â¦  2022-01-01  ğ„€
4  Â¦  2023-01-01
select * from (select y, count(*) as cnt from t_year_sub group by y) as sub order by y;
â¤ y[91,2147483647,0]  Â¦  cnt[-5,64,0]  ğ„€
2020-01-01  Â¦  1  ğ„€
2021-01-01  Â¦  1  ğ„€
2022-01-01  Â¦  1  ğ„€
2023-01-01  Â¦  1
drop table t_year_sub;
drop table if exists t_year_u1;
drop table if exists t_year_u2;
create table t_year_u1 (y year);
create table t_year_u2 (y year);
insert into t_year_u1 values (2020), (2021);
insert into t_year_u2 values (2021), (2022);
select y from t_year_u1 union select y from t_year_u2 order by y;
â¤ y[-5,64,0]  ğ„€
2020  ğ„€
2021  ğ„€
2022
select y from t_year_u1 union all select y from t_year_u2 order by y;
â¤ y[-5,64,0]  ğ„€
2020  ğ„€
2021  ğ„€
2021  ğ„€
2022
drop table t_year_u1;
drop table t_year_u2;
drop table if exists t_year_idx;
create table t_year_idx (id int, y year, index idx_year(y));
insert into t_year_idx values (1, 2020), (2, 2021), (3, 2022), (4, 2020);
select * from t_year_idx where y = 2020 order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
1  Â¦  2020-01-01  ğ„€
4  Â¦  2020-01-01
select * from t_year_idx where y between 2020 and 2021 order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
1  Â¦  2020-01-01  ğ„€
2  Â¦  2021-01-01  ğ„€
4  Â¦  2020-01-01
drop table t_year_idx;
drop table if exists t_year_uniq;
create table t_year_uniq (y year unique, name varchar(20));
insert into t_year_uniq values (2020, 'first');
insert into t_year_uniq values (2021, 'second');
insert into t_year_uniq values (2020, 'duplicate');
Duplicate entry '2020' for key 'y'
select * from t_year_uniq order by y;
â¤ y[91,2147483647,0]  Â¦  name[12,-1,0]  ğ„€
2020-01-01  Â¦  first  ğ„€
2021-01-01  Â¦  second
drop table t_year_uniq;
drop table if exists t_year_notnull;
create table t_year_notnull (id int, y year not null);
insert into t_year_notnull values (1, 2024);
insert into t_year_notnull values (2, null);
constraint violation: Column 'y' cannot be null
select * from t_year_notnull;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
1  Â¦  2024-01-01
drop table t_year_notnull;
drop table if exists t_year_2digit;
create table t_year_2digit (id int, y year);
insert into t_year_2digit values (1, '69');
insert into t_year_2digit values (2, '70');
insert into t_year_2digit values (3, 0);
insert into t_year_2digit values (4, '0');
insert into t_year_2digit values (5, '00');
insert into t_year_2digit values (6, '1');
insert into t_year_2digit values (7, '9');
select * from t_year_2digit order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
1  Â¦  2069-01-01  ğ„€
2  Â¦  1970-01-01  ğ„€
3  Â¦  2000-01-01  ğ„€
4  Â¦  2000-01-01  ğ„€
5  Â¦  2000-01-01  ğ„€
6  Â¦  2001-01-01  ğ„€
7  Â¦  2009-01-01
drop table t_year_2digit;
drop table if exists t_year_null;
create table t_year_null (id int, y year);
insert into t_year_null values (1, 2024);
insert into t_year_null values (2, null);
select id, coalesce(y, 1999) as y_val from t_year_null order by id;
â¤ id[4,32,0]  Â¦  y_val[-5,64,0]  ğ„€
1  Â¦  2024  ğ„€
2  Â¦  1999
select id, ifnull(y, 2000) as y_val from t_year_null order by id;
â¤ id[4,32,0]  Â¦  y_val[-5,64,0]  ğ„€
1  Â¦  2024  ğ„€
2  Â¦  2000
drop table t_year_null;
drop table if exists t_year_case;
create table t_year_case (id int, y year);
insert into t_year_case values (1, 1990), (2, 2000), (3, 2010), (4, 2020);
select id, y,
case
when y < 2000 then '20th century'
when y >= 2000 and y < 2010 then '2000s'
when y >= 2010 and y < 2020 then '2010s'
else '2020s'
end as era
from t_year_case order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  Â¦  era[12,-1,0]  ğ„€
1  Â¦  1990-01-01  Â¦  20th century  ğ„€
2  Â¦  2000-01-01  Â¦  2000s  ğ„€
3  Â¦  2010-01-01  Â¦  2010s  ğ„€
4  Â¦  2020-01-01  Â¦  2020s
drop table t_year_case;
drop table if exists t_year_cmp;
create table t_year_cmp (y year);
insert into t_year_cmp values (2024);
select * from t_year_cmp where y = 2024;
â¤ y[91,2147483647,0]  ğ„€
2024-01-01
select * from t_year_cmp where y > 2000;
â¤ y[91,2147483647,0]  ğ„€
2024-01-01
select * from t_year_cmp where y = '2024';
â¤ y[91,2147483647,0]  ğ„€
2024-01-01
select * from t_year_cmp where y > '2000';
â¤ y[91,2147483647,0]  ğ„€
2024-01-01
drop table t_year_cmp;
drop table if exists t_year_multi;
create table t_year_multi (id int, start_year year, end_year year);
insert into t_year_multi values (1, 2020, 2024);
insert into t_year_multi values (2, 2015, 2020);
insert into t_year_multi values (3, 2010, 2015);
select * from t_year_multi where end_year > start_year order by id;
â¤ id[4,32,0]  Â¦  start_year[91,2147483647,0]  Â¦  end_year[91,2147483647,0]  ğ„€
1  Â¦  2020-01-01  Â¦  2024-01-01  ğ„€
2  Â¦  2015-01-01  Â¦  2020-01-01  ğ„€
3  Â¦  2010-01-01  Â¦  2015-01-01
select id, end_year - start_year as duration from t_year_multi order by id;
â¤ id[4,32,0]  Â¦  duration[-5,64,0]  ğ„€
1  Â¦  4  ğ„€
2  Â¦  5  ğ„€
3  Â¦  5
drop table t_year_multi;
drop table if exists t_year_like;
create table t_year_like (y year);
insert into t_year_like values (2020), (2021), (2022), (2120);
select * from t_year_like where cast(y as char) like '202%' order by y;
â¤ y[91,2147483647,0]  ğ„€
2020-01-01  ğ„€
2021-01-01  ğ„€
2022-01-01
select * from t_year_like where cast(y as char) like '21%' order by y;
â¤ y[91,2147483647,0]  ğ„€
2120-01-01
drop table t_year_like;
select 2024 + 0 as year_expr;
â¤ year_expr[-5,64,0]  ğ„€
2024
select cast(2024 as year) + 0;
â¤ cast(2024 as year) + 0[-5,64,0]  ğ„€
2024
select cast(2024 as year) * 1;
â¤ cast(2024 as year) * 1[-5,64,0]  ğ„€
2024
drop table if exists t_year_alter;
create table t_year_alter (id int);
alter table t_year_alter add column y year;
desc t_year_alter;
â¤ Field[1,0,0]  Â¦  Type[1,0,0]  Â¦  Null[1,0,0]  Â¦  Key[1,0,0]  Â¦  Default[1,0,0]  Â¦  Extra[1,0,0]  Â¦  Comment[1,0,0]  ğ„€
id  Â¦  INT(32)  Â¦  YES  Â¦    Â¦  null  Â¦    Â¦    ğ„€
y  Â¦  YEAR(4)  Â¦  YES  Â¦    Â¦  null  Â¦    Â¦  
insert into t_year_alter values (1, 2024);
select * from t_year_alter;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
1  Â¦  2024-01-01
alter table t_year_alter modify column y year not null default 2000;
desc t_year_alter;
â¤ Field[1,0,0]  Â¦  Type[1,0,0]  Â¦  Null[1,0,0]  Â¦  Key[1,0,0]  Â¦  Default[1,0,0]  Â¦  Extra[1,0,0]  Â¦  Comment[1,0,0]  ğ„€
id  Â¦  INT(32)  Â¦  YES  Â¦    Â¦  null  Â¦    Â¦    ğ„€
y  Â¦  YEAR(4)  Â¦  NO  Â¦    Â¦  2000  Â¦    Â¦  
drop table t_year_alter;
drop table if exists t_year_src;
create table t_year_src (y year);
insert into t_year_src values (2020), (2021), (2022);
drop table if exists t_year_copy;
create table t_year_copy as select * from t_year_src;
desc t_year_copy;
â¤ Field[1,0,0]  Â¦  Type[1,0,0]  Â¦  Null[1,0,0]  Â¦  Key[1,0,0]  Â¦  Default[1,0,0]  Â¦  Extra[1,0,0]  Â¦  Comment[1,0,0]  ğ„€
y  Â¦  YEAR(4)  Â¦  YES  Â¦    Â¦  null  Â¦    Â¦  
select * from t_year_copy order by y;
â¤ y[91,2147483647,0]  ğ„€
2020-01-01  ğ„€
2021-01-01  ğ„€
2022-01-01
drop table t_year_src;
drop table t_year_copy;
drop table if exists t_year_src2;
drop table if exists t_year_dst;
create table t_year_src2 (y year);
create table t_year_dst (y year);
insert into t_year_src2 values (2020), (2021);
insert into t_year_dst select * from t_year_src2;
select * from t_year_dst order by y;
â¤ y[91,2147483647,0]  ğ„€
2020-01-01  ğ„€
2021-01-01
drop table t_year_src2;
drop table t_year_dst;
drop table if exists t_year_replace;
create table t_year_replace (y year primary key, val int);
insert into t_year_replace values (2020, 1);
insert into t_year_replace values (2021, 2);
replace into t_year_replace values (2020, 100);
select * from t_year_replace order by y;
â¤ y[91,2147483647,0]  Â¦  val[4,32,0]  ğ„€
2020-01-01  Â¦  100  ğ„€
2021-01-01  Â¦  2
drop table t_year_replace;
drop table if exists t_year_dup;
create table t_year_dup (y year primary key, val int);
insert into t_year_dup values (2020, 1);
insert into t_year_dup values (2020, 2) on duplicate key update val = val + 10;
select * from t_year_dup;
â¤ y[91,2147483647,0]  Â¦  val[4,32,0]  ğ„€
2020-01-01  Â¦  11
insert into t_year_dup values (2021, 3) on duplicate key update val = val + 10;
select * from t_year_dup order by y;
â¤ y[91,2147483647,0]  Â¦  val[4,32,0]  ğ„€
2020-01-01  Â¦  11  ğ„€
2021-01-01  Â¦  3
drop table t_year_dup;
select year('2024-06-15');
â¤ year(2024-06-15)[-5,64,0]  ğ„€
2024
select year('1999-12-31');
â¤ year(1999-12-31)[-5,64,0]  ğ„€
1999
select year('2000-01-01');
â¤ year(2000-01-01)[-5,64,0]  ğ„€
2000
select year('2024-06-15 10:30:00');
â¤ year(2024-06-15 10:30:00)[-5,64,0]  ğ„€
2024
select year(cast('2024-06-15 10:30:00' as datetime));
â¤ year(cast(2024-06-15 10:30:00 as datetime))[-5,64,0]  ğ„€
2024
select year(null);
â¤ year(null)[-5,64,0]  ğ„€
null
select extract(year from '2024-06-15');
â¤ extract(year, 2024-06-15)[12,-1,0]  ğ„€
2024
select extract(year from '1999-12-31');
â¤ extract(year, 1999-12-31)[12,-1,0]  ğ„€
1999
drop table if exists t_year_date;
create table t_year_date (id int, d date, y year);
insert into t_year_date values (1, '2024-06-15', 2024);
insert into t_year_date values (2, '1999-12-31', 1999);
insert into t_year_date values (3, '2000-01-01', 2000);
select * from t_year_date where y = year(d) order by id;
â¤ id[4,32,0]  Â¦  d[91,64,0]  Â¦  y[91,2147483647,0]  ğ„€
1  Â¦  2024-06-15  Â¦  2024-01-01  ğ„€
2  Â¦  1999-12-31  Â¦  1999-01-01  ğ„€
3  Â¦  2000-01-01  Â¦  2000-01-01
insert into t_year_date values (4, '2023-03-20', year('2023-03-20'));
select * from t_year_date where id = 4;
â¤ id[4,32,0]  Â¦  d[91,64,0]  Â¦  y[91,2147483647,0]  ğ„€
4  Â¦  2023-03-20  Â¦  2023-01-01
drop table t_year_date;
drop table if exists t_year_left;
drop table if exists t_year_right;
create table t_year_left (y year, val int);
create table t_year_right (y year, name varchar(20));
insert into t_year_left values (2020, 1), (2021, 2), (2022, 3);
insert into t_year_right values (2021, 'a'), (2022, 'b'), (2023, 'c');
select l.y, l.val, r.name from t_year_left l left join t_year_right r on l.y = r.y order by l.y;
â¤ y[91,2147483647,0]  Â¦  val[4,32,0]  Â¦  name[12,-1,0]  ğ„€
2020-01-01  Â¦  1  Â¦  null  ğ„€
2021-01-01  Â¦  2  Â¦  a  ğ„€
2022-01-01  Â¦  3  Â¦  b
select l.y, l.val, r.y as ry, r.name from t_year_left l right join t_year_right r on l.y = r.y order by r.y;
â¤ y[91,2147483647,0]  Â¦  val[4,32,0]  Â¦  ry[91,2147483647,0]  Â¦  name[12,-1,0]  ğ„€
2021-01-01  Â¦  2  Â¦  2021-01-01  Â¦  a  ğ„€
2022-01-01  Â¦  3  Â¦  2022-01-01  Â¦  b  ğ„€
null  Â¦  null  Â¦  2023-01-01  Â¦  c
drop table t_year_left;
drop table t_year_right;
drop table if exists t_year_upd1;
drop table if exists t_year_upd2;
create table t_year_upd1 (y year, val int);
create table t_year_upd2 (y year, multiplier int);
insert into t_year_upd1 values (2020, 10), (2021, 20), (2022, 30);
insert into t_year_upd2 values (2020, 2), (2021, 3);
update t_year_upd1 t1, t_year_upd2 t2 set t1.val = t1.val * t2.multiplier where t1.y = t2.y;
select * from t_year_upd1 order by y;
â¤ y[91,2147483647,0]  Â¦  val[4,32,0]  ğ„€
2020-01-01  Â¦  20  ğ„€
2021-01-01  Â¦  60  ğ„€
2022-01-01  Â¦  30
drop table t_year_upd1;
drop table t_year_upd2;
drop table if exists t_year_del1;
drop table if exists t_year_del2;
create table t_year_del1 (y year, val int);
create table t_year_del2 (y year);
insert into t_year_del1 values (2020, 1), (2021, 2), (2022, 3);
insert into t_year_del2 values (2020), (2021);
delete t1 from t_year_del1 t1, t_year_del2 t2 where t1.y = t2.y;
select * from t_year_del1;
â¤ y[91,2147483647,0]  Â¦  val[4,32,0]  ğ„€
2022-01-01  Â¦  3
drop table t_year_del1;
drop table t_year_del2;
drop table if exists t_year_view_base;
drop view if exists v_year;
create table t_year_view_base (id int, y year, name varchar(20));
insert into t_year_view_base values (1, 2020, 'a'), (2, 2021, 'b'), (3, 2022, 'c');
create view v_year as select id, y, name from t_year_view_base where y >= 2021;
select * from v_year order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  Â¦  name[12,-1,0]  ğ„€
2  Â¦  2021-01-01  Â¦  b  ğ„€
3  Â¦  2022-01-01  Â¦  c
update v_year set name = 'updated' where y = 2021;
invalid input: cannot insert/update/delete from view
select * from t_year_view_base order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  Â¦  name[12,-1,0]  ğ„€
1  Â¦  2020-01-01  Â¦  a  ğ„€
2  Â¦  2021-01-01  Â¦  b  ğ„€
3  Â¦  2022-01-01  Â¦  c
drop view v_year;
drop table t_year_view_base;
drop table if exists t_year_agg;
create table t_year_agg (y year);
insert into t_year_agg values (2020), (2021), (2022), (2023), (2024);
select avg(y) from t_year_agg;
â¤ avg(y)[8,54,0]  ğ„€
2022.0
select sum(y) from t_year_agg;
â¤ sum(y)[-5,64,0]  ğ„€
10110
select avg(y), sum(y), min(y), max(y), count(y) from t_year_agg;
â¤ avg(y)[8,54,0]  Â¦  sum(y)[-5,64,0]  Â¦  min(y)[91,2147483647,0]  Â¦  max(y)[91,2147483647,0]  Â¦  count(y)[-5,64,0]  ğ„€
2022.0  Â¦  10110  Â¦  2020-01-01  Â¦  2024-01-01  Â¦  5
drop table t_year_agg;
drop table if exists t_year_window;
create table t_year_window (id int, y year, val int);
insert into t_year_window values (1, 2020, 100), (2, 2020, 200), (3, 2021, 150), (4, 2022, 300), (5, 2022, 250);
select id, y, val, row_number() over (order by y, id) as rn from t_year_window;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  Â¦  val[4,32,0]  Â¦  rn[-5,64,0]  ğ„€
1  Â¦  2020-01-01  Â¦  100  Â¦  1  ğ„€
2  Â¦  2020-01-01  Â¦  200  Â¦  2  ğ„€
3  Â¦  2021-01-01  Â¦  150  Â¦  3  ğ„€
4  Â¦  2022-01-01  Â¦  300  Â¦  4  ğ„€
5  Â¦  2022-01-01  Â¦  250  Â¦  5
select id, y, val, rank() over (order by y) as rnk from t_year_window;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  Â¦  val[4,32,0]  Â¦  rnk[-5,64,0]  ğ„€
1  Â¦  2020-01-01  Â¦  100  Â¦  1  ğ„€
2  Â¦  2020-01-01  Â¦  200  Â¦  1  ğ„€
3  Â¦  2021-01-01  Â¦  150  Â¦  3  ğ„€
4  Â¦  2022-01-01  Â¦  300  Â¦  4  ğ„€
5  Â¦  2022-01-01  Â¦  250  Â¦  4
select id, y, val, dense_rank() over (order by y) as drnk from t_year_window;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  Â¦  val[4,32,0]  Â¦  drnk[-5,64,0]  ğ„€
1  Â¦  2020-01-01  Â¦  100  Â¦  1  ğ„€
2  Â¦  2020-01-01  Â¦  200  Â¦  1  ğ„€
3  Â¦  2021-01-01  Â¦  150  Â¦  2  ğ„€
4  Â¦  2022-01-01  Â¦  300  Â¦  3  ğ„€
5  Â¦  2022-01-01  Â¦  250  Â¦  3
select id, y, val, row_number() over (partition by y order by val desc) as rn from t_year_window;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  Â¦  val[4,32,0]  Â¦  rn[-5,64,0]  ğ„€
2  Â¦  2020-01-01  Â¦  200  Â¦  1  ğ„€
1  Â¦  2020-01-01  Â¦  100  Â¦  2  ğ„€
3  Â¦  2021-01-01  Â¦  150  Â¦  1  ğ„€
4  Â¦  2022-01-01  Â¦  300  Â¦  1  ğ„€
5  Â¦  2022-01-01  Â¦  250  Â¦  2
select id, y, val, sum(val) over (partition by y) as sum_by_year from t_year_window;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  Â¦  val[4,32,0]  Â¦  sum_by_year[-5,64,0]  ğ„€
1  Â¦  2020-01-01  Â¦  100  Â¦  300  ğ„€
2  Â¦  2020-01-01  Â¦  200  Â¦  300  ğ„€
3  Â¦  2021-01-01  Â¦  150  Â¦  150  ğ„€
4  Â¦  2022-01-01  Â¦  300  Â¦  550  ğ„€
5  Â¦  2022-01-01  Â¦  250  Â¦  550
drop table t_year_window;
drop table if exists t_year_limit;
create table t_year_limit (id int, y year);
insert into t_year_limit values (1, 2020), (2, 2021), (3, 2022), (4, 2023), (5, 2024);
select * from t_year_limit order by y limit 3;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
1  Â¦  2020-01-01  ğ„€
2  Â¦  2021-01-01  ğ„€
3  Â¦  2022-01-01
select * from t_year_limit order by y limit 2 offset 2;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
3  Â¦  2022-01-01  ğ„€
4  Â¦  2023-01-01
select * from t_year_limit order by y desc limit 2;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
5  Â¦  2024-01-01  ğ„€
4  Â¦  2023-01-01
drop table t_year_limit;
drop table if exists t_year_composite_pk;
create table t_year_composite_pk (y year, category varchar(10), val int, primary key(y, category));
insert into t_year_composite_pk values (2020, 'A', 1);
insert into t_year_composite_pk values (2020, 'B', 2);
insert into t_year_composite_pk values (2021, 'A', 3);
select * from t_year_composite_pk order by y, category;
â¤ y[91,2147483647,0]  Â¦  category[12,-1,0]  Â¦  val[4,32,0]  ğ„€
2020-01-01  Â¦  A  Â¦  1  ğ„€
2020-01-01  Â¦  B  Â¦  2  ğ„€
2021-01-01  Â¦  A  Â¦  3
drop table t_year_composite_pk;
drop table if exists t_year_composite_idx;
create table t_year_composite_idx (id int, y year, category varchar(10), index idx_year_cat(y, category));
insert into t_year_composite_idx values (1, 2020, 'A'), (2, 2020, 'B'), (3, 2021, 'A'), (4, 2021, 'B');
select * from t_year_composite_idx where y = 2020 and category = 'A';
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  Â¦  category[12,-1,0]  ğ„€
1  Â¦  2020-01-01  Â¦  A
select * from t_year_composite_idx where y = 2020 order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  Â¦  category[12,-1,0]  ğ„€
1  Â¦  2020-01-01  Â¦  A  ğ„€
2  Â¦  2020-01-01  Â¦  B
drop table t_year_composite_idx;
drop table if exists t_year_truncate;
create table t_year_truncate (y year);
insert into t_year_truncate values (2020), (2021), (2022);
select count(*) from t_year_truncate;
â¤ count(*)[-5,64,0]  ğ„€
3
truncate table t_year_truncate;
select count(*) from t_year_truncate;
â¤ count(*)[-5,64,0]  ğ„€
0
insert into t_year_truncate values (2023), (2024);
select * from t_year_truncate order by y;
â¤ y[91,2147483647,0]  ğ„€
2023-01-01  ğ„€
2024-01-01
drop table t_year_truncate;
drop table if exists t_year_txn;
create table t_year_txn (y year);
begin;
insert into t_year_txn values (2020);
insert into t_year_txn values (2021);
commit;
select * from t_year_txn order by y;
â¤ y[91,2147483647,0]  ğ„€
2020-01-01  ğ„€
2021-01-01
begin;
insert into t_year_txn values (2099);
rollback;
select * from t_year_txn order by y;
â¤ y[91,2147483647,0]  ğ„€
2020-01-01  ğ„€
2021-01-01
drop table t_year_txn;
drop table if exists t_year_between;
create table t_year_between (y year);
insert into t_year_between values (1901), (1950), (2000), (2050), (2100), (2155);
select * from t_year_between where y between 1901 and 2155 order by y;
â¤ y[91,2147483647,0]  ğ„€
1901-01-01  ğ„€
1950-01-01  ğ„€
2000-01-01  ğ„€
2050-01-01  ğ„€
2100-01-01  ğ„€
2155-01-01
select * from t_year_between where y between 2000 and 2000;
â¤ y[91,2147483647,0]  ğ„€
2000-01-01
select * from t_year_between where y between 2050 and 2100 order by y;
â¤ y[91,2147483647,0]  ğ„€
2050-01-01  ğ„€
2100-01-01
select * from t_year_between where y not between 1950 and 2050 order by y;
â¤ y[91,2147483647,0]  ğ„€
1901-01-01  ğ„€
2100-01-01  ğ„€
2155-01-01
drop table t_year_between;
select cast('' as year);
â¤ cast( as year)[91,2147483647,0]  ğ„€
null
drop table if exists t_year_empty;
create table t_year_empty (y year);
insert into t_year_empty values ('');
select * from t_year_empty;
â¤ y[91,2147483647,0]  ğ„€
null
drop table t_year_empty;
select cast('  ' as year);
â¤ cast(   as year)[91,2147483647,0]  ğ„€
null
select cast(' 2024 ' as year);
â¤ cast( 2024  as year)[91,2147483647,0]  ğ„€
null
select cast('0024' as year);
â¤ cast(0024 as year)[91,2147483647,0]  ğ„€
2024-01-01
select cast('0070' as year);
â¤ cast(0070 as year)[91,2147483647,0]  ğ„€
1970-01-01
select cast('0000' as year);
â¤ cast(0000 as year)[91,2147483647,0]  ğ„€
2000-01-01
drop table if exists t_year_leading_zero;
create table t_year_leading_zero (y year);
insert into t_year_leading_zero values ('0024');
insert into t_year_leading_zero values ('0070');
select * from t_year_leading_zero order by y;
â¤ y[91,2147483647,0]  ğ„€
1970-01-01  ğ„€
2024-01-01
drop table t_year_leading_zero;
select cast('-1' as year);
â¤ cast(-1 as year)[91,2147483647,0]  ğ„€
null
select cast('-2024' as year);
â¤ cast(-2024 as year)[91,2147483647,0]  ğ„€
null
select cast(2024.0 as year);
â¤ cast(2024.0 as year)[91,2147483647,0]  ğ„€
2024-01-01
select cast(2024.5 as year);
â¤ cast(2024.5 as year)[91,2147483647,0]  ğ„€
2025-01-01
select cast(2024.9 as year);
â¤ cast(2024.9 as year)[91,2147483647,0]  ğ„€
2025-01-01
select cast(99999 as year);
â¤ cast(99999 as year)[91,2147483647,0]  ğ„€
null
select cast(2147483647 as year);
â¤ cast(2147483647 as year)[91,2147483647,0]  ğ„€
null
select cast(true as year);
â¤ cast(true as year)[91,2147483647,0]  ğ„€
2001-01-01
select cast(false as year);
â¤ cast(false as year)[91,2147483647,0]  ğ„€
2000-01-01
drop table if exists t_year_null_cmp;
create table t_year_null_cmp (id int, y year);
insert into t_year_null_cmp values (1, 2024), (2, null), (3, 2020);
select * from t_year_null_cmp where y = null;
invalid argument operator cast, bad value [ANY YEAR]
select * from t_year_null_cmp where y <> null;
invalid argument operator cast, bad value [ANY YEAR]
select * from t_year_null_cmp where y is null;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
2  Â¦  null
select * from t_year_null_cmp where y is not null order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
1  Â¦  2024-01-01  ğ„€
3  Â¦  2020-01-01
select * from t_year_null_cmp where y <=> null;
'' is not yet implemented
select * from t_year_null_cmp where y <=> 2024;
'' is not yet implemented
drop table t_year_null_cmp;
select greatest(2020, 2021, 2022);
â¤ greatest(2020, 2021, 2022)[-5,64,0]  ğ„€
2022
select least(2020, 2021, 2022);
â¤ least(2020, 2021, 2022)[-5,64,0]  ğ„€
2020
drop table if exists t_year_greatest;
create table t_year_greatest (y1 year, y2 year, y3 year);
insert into t_year_greatest values (2020, 2025, 2022);
select greatest(y1, y2, y3) from t_year_greatest;
â¤ greatest(y1, y2, y3)[91,2147483647,0]  ğ„€
2025-01-01
select least(y1, y2, y3) from t_year_greatest;
â¤ least(y1, y2, y3)[91,2147483647,0]  ğ„€
2020-01-01
drop table t_year_greatest;
drop table if exists t_year_if;
create table t_year_if (y year);
insert into t_year_if values (1999), (2000), (2001);
select y, if(y < 2000, '20th century', '21st century') as century from t_year_if order by y;
â¤ y[91,2147483647,0]  Â¦  century[12,-1,0]  ğ„€
1999-01-01  Â¦  20th century  ğ„€
2000-01-01  Â¦  21st century  ğ„€
2001-01-01  Â¦  21st century
drop table t_year_if;
select nullif(2024, 2024);
â¤ nullif(2024, 2024)[-5,64,0]  ğ„€
null
select nullif(2024, 2025);
â¤ nullif(2024, 2025)[-5,64,0]  ğ„€
2024
drop table if exists t_year_nullif;
create table t_year_nullif (y year);
insert into t_year_nullif values (2020), (0), (2022);
select y, nullif(y, 0) as non_zero_year from t_year_nullif order by y;
â¤ y[91,2147483647,0]  Â¦  non_zero_year[-5,64,0]  ğ„€
2000-01-01  Â¦  null  ğ„€
2020-01-01  Â¦  2020  ğ„€
2022-01-01  Â¦  2022
drop table t_year_nullif;
select abs(cast(2024 as year));
â¤ abs(cast(2024 as year))[-5,64,0]  ğ„€
2024
select mod(2024, 4);
â¤ mod(2024, 4)[-5,64,0]  ğ„€
0
select mod(2024, 100);
â¤ mod(2024, 100)[-5,64,0]  ğ„€
24
select mod(2024, 400);
â¤ mod(2024, 400)[-5,64,0]  ğ„€
24
drop table if exists t_year_mod;
create table t_year_mod (y year);
insert into t_year_mod values (2020), (2021), (2022), (2023), (2024);
select y, mod(y, 4) as mod4 from t_year_mod order by y;
â¤ y[91,2147483647,0]  Â¦  mod4[-5,64,0]  ğ„€
2020-01-01  Â¦  0  ğ„€
2021-01-01  Â¦  1  ğ„€
2022-01-01  Â¦  2  ğ„€
2023-01-01  Â¦  3  ğ„€
2024-01-01  Â¦  0
drop table t_year_mod;
select concat('Year: ', 2024);
â¤ concat(Year: , 2024)[12,-1,0]  ğ„€
Year: 2024
select concat(2020, '-', 2024);
â¤ concat(2020, -, 2024)[12,-1,0]  ğ„€
2020-2024
drop table if exists t_year_concat;
create table t_year_concat (y year, name varchar(20));
insert into t_year_concat values (2024, 'Event');
select concat(name, ' (', y, ')') as full_name from t_year_concat;
â¤ full_name[12,-1,0]  ğ„€
Event (2024)
drop table t_year_concat;
drop table if exists t_year_prep;
create table t_year_prep (y year);
set @y = 2024;
insert into t_year_prep values (@y);
select * from t_year_prep;
â¤ y[91,2147483647,0]  ğ„€
2024-01-01
set @y = 1999;
select * from t_year_prep where y > @y;
â¤ y[91,2147483647,0]  ğ„€
2024-01-01
drop table t_year_prep;
drop table if exists t_year_auto;
create table t_year_auto (id int auto_increment primary key, y year);
insert into t_year_auto (y) values (2020);
insert into t_year_auto (y) values (2021);
insert into t_year_auto (y) values (2022);
select * from t_year_auto order by id;
â¤ id[4,32,0]  Â¦  y[91,2147483647,0]  ğ„€
1  Â¦  2020-01-01  ğ„€
2  Â¦  2021-01-01  ğ„€
3  Â¦  2022-01-01
drop table t_year_auto;
drop table if exists t_year_temp;
create temporary table t_year_temp (y year);
insert into t_year_temp values (2020), (2021), (2022);
select * from t_year_temp order by y;
â¤ y[91,2147483647,0]  ğ„€
2020-01-01  ğ„€
2021-01-01  ğ„€
2022-01-01
drop table t_year_temp;
drop table if exists t_year;
