drop table if exists s_t1;
create table s_t1 (c1 int, c2 int, c3 int);
insert into s_t1 values (1, 1, 0), (1, 1, 1), (1, 1, 2), (1, 1, null);
insert into s_t1 values (2, 1, 0);
insert into s_t1 values (2, 2, 0), (2, 2, null);
insert into s_t1 values (3, 1, null), (3, 2, null), (3, 2, null);
select c1, sample(c2, 1 rows), sample(c3, 1 rows) from s_t1;
SQL syntax error: cannot use more than one sample function at select clause.
select c1, max(c2), sample(c3, 1 rows) from s_t1;
SQL syntax error: cannot fixed non-scalar function and scalar function in the same query
select sample(c1, 0 rows) from s_t1;
SQL syntax error: sample(expr list, N rows) requires N between 1 and 11000.
select sample(c1, 11001 rows) from s_t1;
SQL syntax error: sample(expr list, N rows) requires N between 1 and 11000.
select sample(c1, 101 percent) from s_t1;
SQL syntax error: sample(expr list, K percent) requires K between 0.00 and 100.00
select sample(c1, 100.01 percent) from s_t1;
SQL syntax error: sample(expr list, K percent) requires K between 0.00 and 100.00
select c1, c2, c3 from s_t1 where sample(c1, 1 rows) = 1;
expr 'sample' is not yet implemented
select c1, c2, c3 from s_t1 where sample(c1, 1 percent) = 1;
expr 'sample' is not yet implemented
select sample(c1, 1 rows) from s_t1 group by c1;
internal error: cannot sample the group by column.
select sample(*, 1 rows) from s_t1 group by c1;
internal error: cannot sample the group by column.
select count(*) from (select sample(c1, 2 rows) from s_t1);
count(*)  ğ„€
2
select count(*) from (select sample(c2, 2 rows) from s_t1);
count(*)  ğ„€
2
select count(*) from (select sample(c2, 2 rows) from s_t1 group by c1);
count(*)  ğ„€
6
select sample(c3, 3 rows) from s_t1 where c1 = 2;
c3  ğ„€
0  ğ„€
0
select c1, c2, sample(c3, 3 rows) from s_t1 where c1 = 1 order by c3;
c1  Â¦  c2  Â¦  c3  ğ„€
1  Â¦  1  Â¦  0  ğ„€
1  Â¦  1  Â¦  1  ğ„€
1  Â¦  1  Â¦  2
select sample(c3, 100 percent) from s_t1 order by c3;
c3  ğ„€
0  ğ„€
0  ğ„€
0  ğ„€
1  ğ„€
2
select sample(c1, 0 percent) from s_t1;
c1
select count(*) from (select c1, c2, sample(c2, 100 percent), c3 from s_t1);
count(*)  ğ„€
10
select count(*) from (select c1, sample(c2, 100 percent), c2, c3 from s_t1);
count(*)  ğ„€
10
select count(*) from (select sample(c2, 2 rows) from s_t1 limit 1);
count(*)  ğ„€
1
select count(*) from (select sample(c2, 2 rows) from s_t1 group by c1 limit 2);
count(*)  ğ„€
2
select sample(c3, 3 rows) as k from s_t1 where c1 = 2;
k  ğ„€
0  ğ„€
0
select sample(c3, 1 rows) from s_t1 where c1 = 3;
c3  ğ„€
null
select sample(c3, 2 rows) from s_t1 where c1 = 3;
c3  ğ„€
null
select c1, sample(c3, 3 rows) from s_t1 where c1 = 3 group by c1;
c1  Â¦  c3  ğ„€
3  Â¦  null
select c1, sample(c3, 3 rows) from s_t1 group by c1 order by c1, c3;
c1  Â¦  c3  ğ„€
1  Â¦  0  ğ„€
1  Â¦  1  ğ„€
1  Â¦  2  ğ„€
2  Â¦  0  ğ„€
2  Â¦  0  ğ„€
3  Â¦  null
select * from (select c1, sample(c3, 3 rows) as k from s_t1 group by c1) where k < 2 order by c1, k;
c1  Â¦  k  ğ„€
1  Â¦  0  ğ„€
1  Â¦  1  ğ„€
2  Â¦  0  ğ„€
2  Â¦  0
drop table if exists s_t2;
create table s_t2 (cc1 int, cc2 int);
insert into s_t2 values (1, 1), (null, 2), (3, null), (null, null);
select sample(cc1, cc2, 1 rows) as k from s_t2;
SQL syntax error: sample multi columns cannot have alias
select count(*) from (select sample(cc1, cc2, 2 rows) from s_t2);
count(*)  ğ„€
3
select sample(cc1, cc2, 100 percent) from s_t2 order by cc1 asc;
cc1  Â¦  cc2  ğ„€
null  Â¦  2  ğ„€
1  Â¦  1  ğ„€
3  Â¦  null
select sample(cc1, cc2, 0 percent) from s_t2;
cc1  Â¦  cc2
select sample(*, 100 percent) from s_t2 order by cc1 asc;
cc1  Â¦  cc2  ğ„€
null  Â¦  2  ğ„€
1  Â¦  1  ğ„€
3  Â¦  null
select sample(*, 0 percent) from s_t2;
cc1  Â¦  cc2
select sample(*, 2 rows) from s_t2 order by cc1 asc;
cc1  Â¦  cc2  ğ„€
null  Â¦  2  ğ„€
1  Â¦  1  ğ„€
3  Â¦  null
drop table if exists s_t3;
create table s_t3 (c1 int, c2 int);
insert into s_t3 values (1, 3), (2, 5), (3, 6), (4, 7), (5, 8);
select sample(max(c1), 1 rows) from s_t3;
SQL syntax error: cannot fixed non-scalar function and scalar function in the same query
select c1, sample(c1+1, 100 percent) from s_t3 order by c1;
c1  Â¦  c1 + 1  ğ„€
1  Â¦  2  ğ„€
2  Â¦  3  ğ„€
3  Â¦  4  ğ„€
4  Â¦  5  ğ„€
5  Â¦  6
select count(*) from (select sample(c1, 2 rows, 'row') from s_t3);
count(*)  ğ„€
2
select count(*) from (select sample(c1, 2 rows, 'block') from s_t3);
count(*)  ğ„€
2
select c1, sample(c2, 1 rows, 'row') from s_t3 group by c1 order by c1;
c1  Â¦  c2  ğ„€
1  Â¦  3  ğ„€
2  Â¦  5  ğ„€
3  Â¦  6  ğ„€
4  Â¦  7  ğ„€
5  Â¦  8
