drop database if exists test;
create database test;
use test;
create table t1(a int, b varchar(10), primary key(a));
insert into t1 values(1, "1"),(2, "2"),(3, "3");
create snapshot sp1 for table test t1;
create table t2 like t1;
insert into t2 values(1, "1"), (2, "2"), (4, "4");
create snapshot sp2 for table test t2;
data branch diff t2{snapshot="sp2"} against t1{snapshot="sp1"};
diff t2 against t1    flag    a    b
t1    INSERT    3    3
t2    INSERT    4    4
data branch diff t1{snapshot="sp1"} against t2{snapshot="sp2"};
diff t1 against t2    flag    a    b
t1    INSERT    3    3
t2    INSERT    4    4
drop snapshot sp1;
drop snapshot sp2;
drop table t1;
drop table t2;
create table t0(a int, b int, primary key(a));
insert into t0 values(1,1),(2,2),(3,3);
create snapshot sp0 for table test t0;
data branch create table t1 from t0{snapshot="sp0"};
insert into t1 values(4,4);
create snapshot sp1 for table test t1;
data branch create table t2 from t0{snapshot="sp0"};
insert into t2 values(5, 5);
create snapshot sp2 for table test t2;
data branch diff t2{snapshot="sp2"} against t1{snapshot="sp1"};
diff t2 against t1    flag    a    b
t2    INSERT    5    5
t1    INSERT    4    4
data branch diff t1{snapshot="sp1"} against t2{snapshot="sp2"};
diff t1 against t2    flag    a    b
t1    INSERT    4    4
t2    INSERT    5    5
drop snapshot sp1;
drop snapshot sp2;
drop snapshot sp0;
drop table t0;
drop table t1;
drop table t2;
create table t0(a int, b int, primary key(a));
insert into t0 values(1,1);
create snapshot sp00 for table test t0;
insert into t0 values(2,2);
create snapshot sp01 for table test t0;
data branch create table t1 from t0{snapshot="sp00"};
insert into t1 values(4,4);
create snapshot sp1 for table test t1;
data branch create table t2 from t0{snapshot="sp01"};
insert into t2 values(5, 5);
create snapshot sp2 for table test t2;
data branch diff t2{snapshot="sp2"} against t1{snapshot="sp1"};
diff t2 against t1    flag    a    b
t2    INSERT    2    2
t2    INSERT    5    5
t1    INSERT    4    4
data branch diff t1{snapshot="sp1"} against t2{snapshot="sp2"};
diff t1 against t2    flag    a    b
t1    INSERT    4    4
t2    INSERT    2    2
t2    INSERT    5    5
drop snapshot sp1;
drop snapshot sp2;
drop snapshot sp00;
drop snapshot sp01;
drop table t0;
drop table t1;
drop table t2;
create table t1(a int, b int, primary key(a));
insert into t1 values(1,1),(2,2);
create snapshot sp1 for table test t1;
insert into t1 values(3,3);
data branch create table t2 from t1;
insert into t2 values(4, 4);
create snapshot sp2 for table test t2;
data branch diff t2{snapshot="sp2"} against t1{snapshot="sp1"};
diff t2 against t1    flag    a    b
t2    INSERT    3    3
t2    INSERT    4    4
data branch diff t1{snapshot="sp1"} against t2{snapshot="sp2"};
diff t1 against t2    flag    a    b
t2    INSERT    3    3
t2    INSERT    4    4
drop snapshot sp1;
drop snapshot sp2;
drop table t1;
drop table t2;
create table t1(a int, b int, primary key(a));
insert into t1 values(1,1),(2,2);
create snapshot sp1 for table test t1;
insert into t1 values(3,3);
data branch create table t2 from t1{snapshot="sp1"};
insert into t2 values(4, 4);
create snapshot sp2 for table test t2;
data branch diff t2{snapshot="sp2"} against t1{snapshot="sp1"};
diff t2 against t1    flag    a    b
t2    INSERT    4    4
data branch diff t1{snapshot="sp1"} against t2{snapshot="sp2"};
diff t1 against t2    flag    a    b
t2    INSERT    4    4
drop snapshot sp1;
drop snapshot sp2;
drop table t1;
drop table t2;
create table t1(a int, b int, primary key(a));
insert into t1 values(1,1),(2,2);
data branch create table t2 from t1;
insert into t2 values(4, 4);
create snapshot sp2 for table test t2;
create snapshot sp1 for table test t1;
insert into t1 values(3,3);
data branch diff t2{snapshot="sp2"} against t1{snapshot="sp1"};
diff t2 against t1    flag    a    b
t2    INSERT    4    4
data branch diff t1{snapshot="sp1"} against t2{snapshot="sp2"};
diff t1 against t2    flag    a    b
t2    INSERT    4    4
drop snapshot sp1;
drop snapshot sp2;
drop table t1;
drop table t2;
drop database test;
