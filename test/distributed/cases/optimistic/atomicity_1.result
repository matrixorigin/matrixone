drop table if exists atomic_table_1;
drop table if exists atomic_table_2;
drop table if exists atomic_table_3;
drop table if exists atomic_view_1;
drop table if exists atomic_view_2;
drop table if exists t_code_rule_2;
create table atomic_table_2(a bigint ,b varchar(200),c double);
begin;
create table atomic_table_1(a bigint not null,b varchar(200),c double,primary key(a,b));
insert into atomic_table_1 select 1,"gooooooge",8092.9;
insert into atomic_table_1 select 2,"caaaaaate",92.09;
commit;
select * from atomic_table_1;
â¤ a[-5,64,0]  Â¦  b[12,-1,0]  Â¦  c[8,54,0]  ğ„€
1  Â¦  gooooooge  Â¦  8092.9  ğ„€
2  Â¦  caaaaaate  Â¦  92.09
start transaction ;
insert into atomic_table_2 select * from atomic_table_1;
select * from atomic_table_2;
â¤ a[-5,64,0]  Â¦  b[12,-1,0]  Â¦  c[8,54,0]  ğ„€
1  Â¦  gooooooge  Â¦  8092.9  ğ„€
2  Â¦  caaaaaate  Â¦  92.09
rollback ;
select * from atomic_table_2;
â¤ a[-5,64,0]  Â¦  b[12,-1,0]  Â¦  c[8,54,0]
begin;
insert into atomic_table_2 select * from atomic_table_1;
commit;
select * from atomic_table_2;
â¤ a[-5,64,0]  Â¦  b[12,-1,0]  Â¦  c[8,54,0]  ğ„€
1  Â¦  gooooooge  Â¦  8092.9  ğ„€
2  Â¦  caaaaaate  Â¦  92.09
begin;
create view atomic_view_1 as select * from atomic_table_1;
insert into atomic_table_1 select 10,"eeeeee",20.3;
commit;
select * from atomic_view_1;
â¤ a[-5,64,0]  Â¦  b[12,-1,0]  Â¦  c[8,54,0]  ğ„€
1  Â¦  gooooooge  Â¦  8092.9  ğ„€
2  Â¦  caaaaaate  Â¦  92.09  ğ„€
10  Â¦  eeeeee  Â¦  20.3
start transaction ;
insert into atomic_table_1 select 10,"eeeeee",20.3;
insert into atomic_table_1 select 11,"ffff",2.3;
commit;
Duplicate entry '(10,eeeeee)' for key '__mo_cpkey_col'
select * from atomic_table_1;
â¤ a[-5,64,0]  Â¦  b[12,-1,0]  Â¦  c[8,54,0]  ğ„€
1  Â¦  gooooooge  Â¦  8092.9  ğ„€
2  Â¦  caaaaaate  Â¦  92.09  ğ„€
10  Â¦  eeeeee  Â¦  20.3
select * from atomic_view_1;
â¤ a[-5,64,0]  Â¦  b[12,-1,0]  Â¦  c[8,54,0]  ğ„€
1  Â¦  gooooooge  Â¦  8092.9  ğ„€
2  Â¦  caaaaaate  Â¦  92.09  ğ„€
10  Â¦  eeeeee  Â¦  20.3
begin;
create view atomic_view_2 as select * from atomic_table_2;
rollback ;
select * from atomic_view_2;
SQL parser error: table "atomic_view_2" does not exist
show create table atomic_view_2;
no such table atomicity_1.atomic_view_2
begin;
drop view atomic_view_2;
invalid view 'atomicity_1.atomic_view_2'
commit ;
drop view atomic_view_2;
invalid view 'atomicity_1.atomic_view_2'
create table atomic_table_3a(col1 tinyint,col2 smallint,col3 int,clo4 bigint,col5 tinyint unsigned,col6 smallint unsigned,col7 int unsigned,col8 bigint unsigned,col9 float,col10 double,col11 varchar(255),col12 Date,col13 DateTime,col14 timestamp,col15 bool,col16 decimal(5,2),col17 text,col18 varchar(255),col19 varchar(255),col20 text,primary key(col1))partition by hash(col1)partitions 4;
begin;
[unknown result because it is related to issue#5941]
load data infile '$resources/external_table_file/pt_table_data.csv' into table  atomic_table_3a fields terminated by ',';
[unknown result because it is related to issue#5941]
select col1,col2 from atomic_table_3a;
[unknown result because it is related to issue#5941]
update atomic_table_3a set col1=40;
[unknown result because it is related to issue#5941]
rollback;
[unknown result because it is related to issue#5941]
select col1 from atomic_table_3a;
[unknown result because it is related to issue#5941]
start transaction ;
[unknown result because it is related to issue#5941]
load data infile '$resources/external_table_file/pt_table_data.csv' into table  atomic_table_3a fields terminated by ',';
[unknown result because it is related to issue#5941]
select count(*) from atomic_table_3a;
[unknown result because it is related to issue#5941]
update atomic_table_3a set col1=100;
[unknown result because it is related to issue#5941]
commit;
[unknown result because it is related to issue#5941]
select col1 from atomic_table_3a;
[unknown result because it is related to issue#5941]
create table atomic_table_3(col1 tinyint,col2 smallint,col3 int,clo4 bigint,col5 tinyint unsigned,col6 smallint unsigned,col7 int unsigned,col8 bigint unsigned,col9 float,col10 double,col11 varchar(255),col12 Date,col13 DateTime,col14 timestamp,col15 bool,col16 decimal(5,2),col17 text,col18 varchar(255),col19 varchar(255),col20 text,primary key(col1))partition by hash(col1)partitions 4;
[unknown result because it is related to issue#16438]
load data infile '$resources/external_table_file/pt_table_data.csv' into table  atomic_table_3 fields terminated by ',';
[unknown result because it is related to issue#16438]
start transaction ;
[unknown result because it is related to issue#16438]
update  atomic_table_3 set col2=20;
[unknown result because it is related to issue#16438]
select  col1,col2 from atomic_table_3;
[unknown result because it is related to issue#16438]
show create table atomic_table_3;
[unknown result because it is related to issue#16438]
rollback ;
[unknown result because it is related to issue#16438]
select  col1,col2 from atomic_table_3;
[unknown result because it is related to issue#16438]
begin;
create external table atomic_ex_table(num_col1 tinyint,num_col2 smallint,num_col3 int,num_col4 bigint,num_col5 tinyint unsigned,num_col6 smallint unsigned,num_col7 int unsigned,num_col8 bigint unsigned ,num_col9 float(5,3),num_col10 double(6,5),num_col11 decimal(38,19)) infile{"filepath"='$resources/external_table_file/ex_table_number.csv'} fields terminated by ',' enclosed by '\"' lines terminated by '\n';
select num_col1  from  atomic_ex_table;
â¤ num_col1[-6,8,0]  ğ„€
60  ğ„€
-128  ğ„€
127  ğ„€
null
rollback ;
select num_col1  from  atomic_ex_table;
SQL parser error: table "atomic_ex_table" does not exist
show create table atomic_ex_table;
no such table atomicity_1.atomic_ex_table
desc atomic_ex_table;
no such table atomicity_1.atomic_ex_table
create TEMPORARY TABLE atomic_temp(a int);
[unknown result because it is related to issue#9124]
begin;
[unknown result because it is related to issue#9124]
insert into atomic_temp values (5);
[unknown result because it is related to issue#9124]
rollback ;
[unknown result because it is related to issue#9124]
select * from atomic_temp;
[unknown result because it is related to issue#9124]
drop table atomic_temp;
[unknown result because it is related to issue#9124]
start transaction ;
[unknown result because it is related to issue#9124]
create TEMPORARY TABLE atomic_temp(a int);
[unknown result because it is related to issue#9124]
insert into atomic_temp values (5);
[unknown result because it is related to issue#9124]
select * from atomic_temp;
[unknown result because it is related to issue#9124]
rollback ;
[unknown result because it is related to issue#9124]
select * from atomic_temp;
[unknown result because it is related to issue#9124]
show create table atomic_temp;
[unknown result because it is related to issue#9124]
start transaction ;
[unknown result because it is related to issue#9124]
create TEMPORARY TABLE atomic_temp(a int);
[unknown result because it is related to issue#9124]
insert into atomic_temp values (5);
[unknown result because it is related to issue#9124]
commit ;
[unknown result because it is related to issue#9124]
select * from atomic_temp;
[unknown result because it is related to issue#9124]
CREATE TABLE `t_code_rule` (
`code_id` bigint(20) NOT NULL AUTO_INCREMENT,
`code_no` varchar(50) NOT NULL,
`org_no` varchar(50) NOT NULL,
`org_name` varchar(50) NOT NULL,
`code_type` int(11) NOT NULL DEFAULT '0',
PRIMARY KEY (`code_id`),
UNIQUE KEY `code_type` (`code_type`),
KEY `code_no` (`code_no`),
KEY `org_no` (`org_no`)
);
start transaction ;
insert into t_code_rule values (18373453,'aaaaaa','fffff','ccccc',10);
insert into t_code_rule values (18373453,'aaaaaa','fffff','ccccc',20);
commit ;
select * from t_code_rule;
â¤ code_id[-5,64,0]  Â¦  code_no[12,-1,0]  Â¦  org_no[12,-1,0]  Â¦  org_name[12,-1,0]  Â¦  code_type[4,32,0]  ğ„€
18373453  Â¦  aaaaaa  Â¦  fffff  Â¦  ccccc  Â¦  10  ğ„€
18373453  Â¦  aaaaaa  Â¦  fffff  Â¦  ccccc  Â¦  20
begin;
insert into t_code_rule values (18373453,'aaaaaa','fffff','ccccc',5);
[unknown result because it is related to issue#7133]
delete from t_code_rule where code_id=18373453;
[unknown result because it is related to issue#7133]
select * from t_code_rule;
[unknown result because it is related to issue#7133]
rollback ;
select * from t_code_rule;
â¤ code_id[-5,64,0]  Â¦  code_no[12,-1,0]  Â¦  org_no[12,-1,0]  Â¦  org_name[12,-1,0]  Â¦  code_type[4,32,0]  ğ„€
18373453  Â¦  aaaaaa  Â¦  fffff  Â¦  ccccc  Â¦  10  ğ„€
18373453  Â¦  aaaaaa  Â¦  fffff  Â¦  ccccc  Â¦  20
insert into t_code_rule values (18373453,'aaaaaa','fffff','ccccc',5);
Duplicate entry '18373453' for key 'code_id'
begin ;
delete from t_code_rule where code_id=18373453;
[unknown result because it is related to issue#7133]
commit ;
[unknown result because it is related to issue#7133]
begin;
[unknown result because it is related to issue#7133]
insert into t_code_rule(code_no,org_no,org_name,code_type) values ('',null,'ccccc',5);
[unknown result because it is related to issue#7133]
commit ;
[unknown result because it is related to issue#7133]
select * from t_code_rule;
[unknown result because it is related to issue#7133]
insert into t_code_rule values (18373453,'aaaaaa','fffff','ccccc',5);
[unknown result because it is related to issue#7133]
begin;
[unknown result because it is related to issue#7133]
update t_code_rule set org_name=NULL where code_id=18373453;
[unknown result because it is related to issue#7133]
commit ;
[unknown result because it is related to issue#7133]
select * from t_code_rule;
[unknown result because it is related to issue#7133]
begin ;
create account aname admin_name 'admin' identified by '111';
internal error: administrative command is unsupported in transactions
create role role1,role2;
internal error: administrative command is unsupported in transactions
grant role1 to role2;
internal error: administrative command is unsupported in transactions
grant create table ,drop table on database * to role1;
internal error: administrative command is unsupported in transactions
truncate table  t_code_rule;
drop table t_code_rule;
drop database atomic_1;
Can't drop database 'atomic_1'; database doesn't exist
drop role role1,role2;
internal error: administrative command is unsupported in transactions
commit;
