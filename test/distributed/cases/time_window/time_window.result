drop table if exists sensor_data;
CREATE TABLE sensor_data (ts timestamp(3) primary key, temperature FLOAT);
INSERT INTO sensor_data VALUES('2023-08-01 00:00:00', 25.0);
INSERT INTO sensor_data VALUES('2023-08-01 00:05:00', 26.0);
INSERT INTO sensor_data VALUES('2023-08-01 00:15:00', 28.0);
INSERT INTO sensor_data VALUES('2023-08-01 00:20:00', 30.0);
INSERT INTO sensor_data VALUES('2023-08-01 00:25:00', 27.0);
INSERT INTO sensor_data VALUES('2023-08-01 00:30:00', null);
INSERT INTO sensor_data VALUES('2023-08-01 00:35:00', null);
INSERT INTO sensor_data VALUES('2023-08-01 00:40:00', 28);
INSERT INTO sensor_data VALUES('2023-08-01 00:45:00', 38);
INSERT INTO sensor_data VALUES('2023-08-01 00:50:00', 31);
insert into sensor_data values('2023-07-31 23:55:00', 22);
select _wstart, _wend, max(temperature), _wstart from sensor_data where ts > "2023-08-01 00:00:00.000" and ts < "2023-08-01 00:50:00" interval(ts, 10, minute) sliding(5, minute) fill(linear);
_wstart    _wend    max(temperature)    _wstart
2023-08-01 00:00:00    2023-08-01 00:10:00    26.0    2023-08-01 00:00:00
2023-08-01 00:05:00    2023-08-01 00:15:00    26.0    2023-08-01 00:05:00
2023-08-01 00:10:00    2023-08-01 00:20:00    28.0    2023-08-01 00:10:00
2023-08-01 00:15:00    2023-08-01 00:25:00    30.0    2023-08-01 00:15:00
2023-08-01 00:20:00    2023-08-01 00:30:00    30.0    2023-08-01 00:20:00
2023-08-01 00:25:00    2023-08-01 00:35:00    27.0    2023-08-01 00:25:00
2023-08-01 00:30:00    2023-08-01 00:40:00    27.5    2023-08-01 00:30:00
2023-08-01 00:35:00    2023-08-01 00:45:00    28.0    2023-08-01 00:35:00
2023-08-01 00:40:00    2023-08-01 00:50:00    38.0    2023-08-01 00:40:00
2023-08-01 00:45:00    2023-08-01 00:55:00    38.0    2023-08-01 00:45:00
select _wstart, _wend, max(temperature), min(temperature) from sensor_data where ts > "2023-08-01 00:00:00.000" and ts < "2023-08-01 00:50:00" interval(ts, 10, minute) sliding(5, minute) fill(prev);
_wstart    _wend    max(temperature)    min(temperature)
2023-08-01 00:00:00    2023-08-01 00:10:00    26.0    26.0
2023-08-01 00:05:00    2023-08-01 00:15:00    26.0    26.0
2023-08-01 00:10:00    2023-08-01 00:20:00    28.0    28.0
2023-08-01 00:15:00    2023-08-01 00:25:00    30.0    28.0
2023-08-01 00:20:00    2023-08-01 00:30:00    30.0    27.0
2023-08-01 00:25:00    2023-08-01 00:35:00    27.0    27.0
2023-08-01 00:30:00    2023-08-01 00:40:00    27.0    27.0
2023-08-01 00:35:00    2023-08-01 00:45:00    28.0    28.0
2023-08-01 00:40:00    2023-08-01 00:50:00    38.0    28.0
2023-08-01 00:45:00    2023-08-01 00:55:00    38.0    38.0
select _wstart, _wend, max(temperature), sum(temperature) from sensor_data where ts > "2023-08-01 00:00:00.000" and ts < "2023-08-01 00:50:00" interval(ts, 10, minute) sliding(5, minute) fill(next);
_wstart    _wend    max(temperature)    sum(temperature)
2023-08-01 00:00:00    2023-08-01 00:10:00    26.0    26.0
2023-08-01 00:05:00    2023-08-01 00:15:00    26.0    26.0
2023-08-01 00:10:00    2023-08-01 00:20:00    28.0    28.0
2023-08-01 00:15:00    2023-08-01 00:25:00    30.0    58.0
2023-08-01 00:20:00    2023-08-01 00:30:00    30.0    57.0
2023-08-01 00:25:00    2023-08-01 00:35:00    27.0    27.0
2023-08-01 00:30:00    2023-08-01 00:40:00    28.0    28.0
2023-08-01 00:35:00    2023-08-01 00:45:00    28.0    28.0
2023-08-01 00:40:00    2023-08-01 00:50:00    38.0    66.0
2023-08-01 00:45:00    2023-08-01 00:55:00    38.0    38.0
select _wstart, _wend, max(temperature), count(temperature) from sensor_data where ts > "2023-08-01 00:00:00.000" and ts < "2023-08-01 00:50:00" interval(ts, 10, minute) sliding(5, minute) fill(next);
_wstart    _wend    max(temperature)    count(temperature)
2023-08-01 00:00:00    2023-08-01 00:10:00    26.0    1
2023-08-01 00:05:00    2023-08-01 00:15:00    26.0    1
2023-08-01 00:10:00    2023-08-01 00:20:00    28.0    1
2023-08-01 00:15:00    2023-08-01 00:25:00    30.0    2
2023-08-01 00:20:00    2023-08-01 00:30:00    30.0    2
2023-08-01 00:25:00    2023-08-01 00:35:00    27.0    1
2023-08-01 00:30:00    2023-08-01 00:40:00    28.0    0
2023-08-01 00:35:00    2023-08-01 00:45:00    28.0    1
2023-08-01 00:40:00    2023-08-01 00:50:00    38.0    2
2023-08-01 00:45:00    2023-08-01 00:55:00    38.0    1
select _wstart, _wend, max(temperature), sum(temperature) from sensor_data where ts > "2023-08-01 00:00:00.000" and ts < "2023-08-01 00:50:00" interval(ts, 10, minute) sliding(5, minute) fill(linear);
_wstart    _wend    max(temperature)    sum(temperature)
2023-08-01 00:00:00    2023-08-01 00:10:00    26.0    26.0
2023-08-01 00:05:00    2023-08-01 00:15:00    26.0    26.0
2023-08-01 00:10:00    2023-08-01 00:20:00    28.0    28.0
2023-08-01 00:15:00    2023-08-01 00:25:00    30.0    58.0
2023-08-01 00:20:00    2023-08-01 00:30:00    30.0    57.0
2023-08-01 00:25:00    2023-08-01 00:35:00    27.0    27.0
2023-08-01 00:30:00    2023-08-01 00:40:00    27.5    27.5
2023-08-01 00:35:00    2023-08-01 00:45:00    28.0    28.0
2023-08-01 00:40:00    2023-08-01 00:50:00    38.0    66.0
2023-08-01 00:45:00    2023-08-01 00:55:00    38.0    38.0
select _wstart, _wend, count(temperature), sum(temperature) from sensor_data where ts > "2023-08-01 00:00:00.000" and ts < "2023-08-01 00:50:00" interval(ts, 10, minute) sliding(5, minute) fill(next);
_wstart    _wend    count(temperature)    sum(temperature)
2023-08-01 00:00:00    2023-08-01 00:10:00    1    26.0
2023-08-01 00:05:00    2023-08-01 00:15:00    1    26.0
2023-08-01 00:10:00    2023-08-01 00:20:00    1    28.0
2023-08-01 00:15:00    2023-08-01 00:25:00    2    58.0
2023-08-01 00:20:00    2023-08-01 00:30:00    2    57.0
2023-08-01 00:25:00    2023-08-01 00:35:00    1    27.0
2023-08-01 00:30:00    2023-08-01 00:40:00    0    28.0
2023-08-01 00:35:00    2023-08-01 00:45:00    1    28.0
2023-08-01 00:40:00    2023-08-01 00:50:00    2    66.0
2023-08-01 00:45:00    2023-08-01 00:55:00    1    38.0
select _wstart, _wend, max(temperature), min(temperature) from sensor_data where ts > "2023-08-01 00:00:00.000" and ts < "2023-08-01 00:50:00" interval(ts, 10, minute) sliding(5, minute) fill(value, 123);
_wstart    _wend    max(temperature)    min(temperature)
2023-08-01 00:00:00    2023-08-01 00:10:00    26.0    26.0
2023-08-01 00:05:00    2023-08-01 00:15:00    26.0    26.0
2023-08-01 00:10:00    2023-08-01 00:20:00    28.0    28.0
2023-08-01 00:15:00    2023-08-01 00:25:00    30.0    28.0
2023-08-01 00:20:00    2023-08-01 00:30:00    30.0    27.0
2023-08-01 00:25:00    2023-08-01 00:35:00    27.0    27.0
2023-08-01 00:30:00    2023-08-01 00:40:00    123.0    123.0
2023-08-01 00:35:00    2023-08-01 00:45:00    28.0    28.0
2023-08-01 00:40:00    2023-08-01 00:50:00    38.0    28.0
2023-08-01 00:45:00    2023-08-01 00:55:00    38.0    38.0
select _wstart, _wend, max(temperature) from sensor_data interval(ts, 1, minute);
_wstart    _wend    max(temperature)
2023-07-31 23:55:00    2023-07-31 23:56:00    22.0
2023-08-01 00:00:00    2023-08-01 00:01:00    25.0
2023-08-01 00:05:00    2023-08-01 00:06:00    26.0
2023-08-01 00:15:00    2023-08-01 00:16:00    28.0
2023-08-01 00:20:00    2023-08-01 00:21:00    30.0
2023-08-01 00:25:00    2023-08-01 00:26:00    27.0
2023-08-01 00:30:00    2023-08-01 00:31:00    null
2023-08-01 00:35:00    2023-08-01 00:36:00    null
2023-08-01 00:40:00    2023-08-01 00:41:00    28.0
2023-08-01 00:45:00    2023-08-01 00:46:00    38.0
2023-08-01 00:50:00    2023-08-01 00:51:00    31.0
select _wstart, _wend, max(temperature) from sensor_data interval(ts, 2, minute);
_wstart    _wend    max(temperature)
2023-07-31 23:54:00    2023-07-31 23:56:00    22.0
2023-08-01 00:00:00    2023-08-01 00:02:00    25.0
2023-08-01 00:04:00    2023-08-01 00:06:00    26.0
2023-08-01 00:14:00    2023-08-01 00:16:00    28.0
2023-08-01 00:20:00    2023-08-01 00:22:00    30.0
2023-08-01 00:24:00    2023-08-01 00:26:00    27.0
2023-08-01 00:30:00    2023-08-01 00:32:00    null
2023-08-01 00:34:00    2023-08-01 00:36:00    null
2023-08-01 00:40:00    2023-08-01 00:42:00    28.0
2023-08-01 00:44:00    2023-08-01 00:46:00    38.0
2023-08-01 00:50:00    2023-08-01 00:52:00    31.0
select _wstart, _wend, max(temperature) from sensor_data interval(ts, 3, minute);
_wstart    _wend    max(temperature)
2023-07-31 23:54:00    2023-07-31 23:57:00    22.0
2023-08-01 00:00:00    2023-08-01 00:03:00    25.0
2023-08-01 00:03:00    2023-08-01 00:06:00    26.0
2023-08-01 00:15:00    2023-08-01 00:18:00    28.0
2023-08-01 00:18:00    2023-08-01 00:21:00    30.0
2023-08-01 00:24:00    2023-08-01 00:27:00    27.0
2023-08-01 00:30:00    2023-08-01 00:33:00    null
2023-08-01 00:33:00    2023-08-01 00:36:00    null
2023-08-01 00:39:00    2023-08-01 00:42:00    28.0
2023-08-01 00:45:00    2023-08-01 00:48:00    38.0
2023-08-01 00:48:00    2023-08-01 00:51:00    31.0
select _wstart, _wend, max(temperature) from sensor_data interval(ts, 4, minute);
_wstart    _wend    max(temperature)
2023-07-31 23:52:00    2023-07-31 23:56:00    22.0
2023-08-01 00:00:00    2023-08-01 00:04:00    25.0
2023-08-01 00:04:00    2023-08-01 00:08:00    26.0
2023-08-01 00:12:00    2023-08-01 00:16:00    28.0
2023-08-01 00:20:00    2023-08-01 00:24:00    30.0
2023-08-01 00:24:00    2023-08-01 00:28:00    27.0
2023-08-01 00:28:00    2023-08-01 00:32:00    null
2023-08-01 00:32:00    2023-08-01 00:36:00    null
2023-08-01 00:40:00    2023-08-01 00:44:00    28.0
2023-08-01 00:44:00    2023-08-01 00:48:00    38.0
2023-08-01 00:48:00    2023-08-01 00:52:00    31.0
select _wstart, _wend, max(temperature) from sensor_data interval(ts, 5, minute);
_wstart    _wend    max(temperature)
2023-07-31 23:55:00    2023-08-01 00:00:00    22.0
2023-08-01 00:00:00    2023-08-01 00:05:00    25.0
2023-08-01 00:05:00    2023-08-01 00:10:00    26.0
2023-08-01 00:15:00    2023-08-01 00:20:00    28.0
2023-08-01 00:20:00    2023-08-01 00:25:00    30.0
2023-08-01 00:25:00    2023-08-01 00:30:00    27.0
2023-08-01 00:30:00    2023-08-01 00:35:00    null
2023-08-01 00:35:00    2023-08-01 00:40:00    null
2023-08-01 00:40:00    2023-08-01 00:45:00    28.0
2023-08-01 00:45:00    2023-08-01 00:50:00    38.0
2023-08-01 00:50:00    2023-08-01 00:55:00    31.0
select _wstart, _wend, max(temperature) from sensor_data interval(ts, 10, minute);
_wstart    _wend    max(temperature)
2023-07-31 23:50:00    2023-08-01 00:00:00    22.0
2023-08-01 00:00:00    2023-08-01 00:10:00    26.0
2023-08-01 00:10:00    2023-08-01 00:20:00    28.0
2023-08-01 00:20:00    2023-08-01 00:30:00    30.0
2023-08-01 00:30:00    2023-08-01 00:40:00    null
2023-08-01 00:40:00    2023-08-01 00:50:00    38.0
2023-08-01 00:50:00    2023-08-01 01:00:00    31.0
select _wstart, _wend, max(temperature) from sensor_data interval(ts, 10, minute) sliding(5, minute);
_wstart    _wend    max(temperature)
2023-07-31 23:50:00    2023-08-01 00:00:00    22.0
2023-07-31 23:55:00    2023-08-01 00:05:00    25.0
2023-08-01 00:00:00    2023-08-01 00:10:00    26.0
2023-08-01 00:05:00    2023-08-01 00:15:00    26.0
2023-08-01 00:10:00    2023-08-01 00:20:00    28.0
2023-08-01 00:15:00    2023-08-01 00:25:00    30.0
2023-08-01 00:20:00    2023-08-01 00:30:00    30.0
2023-08-01 00:25:00    2023-08-01 00:35:00    27.0
2023-08-01 00:30:00    2023-08-01 00:40:00    null
2023-08-01 00:35:00    2023-08-01 00:45:00    28.0
2023-08-01 00:40:00    2023-08-01 00:50:00    38.0
2023-08-01 00:45:00    2023-08-01 00:55:00    38.0
2023-08-01 00:50:00    2023-08-01 01:00:00    31.0
select _wstart, _wend, max(temperature) from sensor_data where ts > "2023-08-01 00:00:00.000" and ts < "2023-08-01 00:50:00.000" interval(ts, 10, minute) sliding(5, minute);
_wstart    _wend    max(temperature)
2023-08-01 00:00:00    2023-08-01 00:10:00    26.0
2023-08-01 00:05:00    2023-08-01 00:15:00    26.0
2023-08-01 00:10:00    2023-08-01 00:20:00    28.0
2023-08-01 00:15:00    2023-08-01 00:25:00    30.0
2023-08-01 00:20:00    2023-08-01 00:30:00    30.0
2023-08-01 00:25:00    2023-08-01 00:35:00    27.0
2023-08-01 00:30:00    2023-08-01 00:40:00    null
2023-08-01 00:35:00    2023-08-01 00:45:00    28.0
2023-08-01 00:40:00    2023-08-01 00:50:00    38.0
2023-08-01 00:45:00    2023-08-01 00:55:00    38.0
select _wstart, _wend, max(temperature) from sensor_data interval(ts, 1, second);
_wstart    _wend    max(temperature)
2023-07-31 23:55:00    2023-07-31 23:55:01    22.0
2023-08-01 00:00:00    2023-08-01 00:00:01    25.0
2023-08-01 00:05:00    2023-08-01 00:05:01    26.0
2023-08-01 00:15:00    2023-08-01 00:15:01    28.0
2023-08-01 00:20:00    2023-08-01 00:20:01    30.0
2023-08-01 00:25:00    2023-08-01 00:25:01    27.0
2023-08-01 00:30:00    2023-08-01 00:30:01    null
2023-08-01 00:35:00    2023-08-01 00:35:01    null
2023-08-01 00:40:00    2023-08-01 00:40:01    28.0
2023-08-01 00:45:00    2023-08-01 00:45:01    38.0
2023-08-01 00:50:00    2023-08-01 00:50:01    31.0
select _wstart, _wend, max(temperature) from sensor_data interval(ts, 2, hour);
_wstart    _wend    max(temperature)
2023-07-31 22:00:00    2023-08-01 00:00:00    22.0
2023-08-01 00:00:00    2023-08-01 02:00:00    38.0
select _wstart, _wend, max(temperature) from sensor_data interval(ts, 3, day);
_wstart    _wend    max(temperature)
2023-07-29 00:00:00    2023-08-01 00:00:00    22.0
2023-08-01 00:00:00    2023-08-04 00:00:00    38.0