set enable_remap_hint = 1;
drop database if exists hint_cte_test;
create database hint_cte_test;
use hint_cte_test;
drop table if exists t1;
create table t1 (id int, name varchar(20), age int);
insert into t1 values (1, 'Alice', 20), (2, 'Bob', 30), (3, 'Charlie', 40);
/*+ {
"rewrites": {
"hint_cte_test.t1": "SELECT * FROM t1 WHERE age > 25"
}
} */
with cte1 as (select * from t1)
select * from cte1 order by id;
â¤ id[4,32,0]  Â¦  name[12,-1,0]  Â¦  age[4,32,0]  ğ„€
2  Â¦  Bob  Â¦  30  ğ„€
3  Â¦  Charlie  Â¦  40
drop table if exists t2;
create table t2 (id int, city varchar(20));
insert into t2 values (1, 'Beijing'), (2, 'Shanghai'), (3, 'Guangzhou');
/*+ {
"rewrites": {
"hint_cte_test.t1": "SELECT * FROM t1 WHERE id > 1",
"hint_cte_test.t2": "SELECT * FROM t2 WHERE city != 'Shanghai'"
}
} */
with cte_t1 as (select * from t1),
cte_t2 as (select * from t2)
select cte_t1.name, cte_t2.city
from cte_t1 join cte_t2 on cte_t1.id = cte_t2.id
order by cte_t1.name;
â¤ name[12,-1,0]  Â¦  city[12,-1,0]  ğ„€
Charlie  Â¦  Guangzhou
/*+ {
"rewrites": {
"hint_cte_test.t1": "SELECT * FROM t1 WHERE age < 35"
}
} */
with cte1 as (select * from t1),
cte2 as (select * from cte1 where id > 1)
select * from cte2 order by id;
â¤ id[4,32,0]  Â¦  name[12,-1,0]  Â¦  age[4,32,0]  ğ„€
2  Â¦  Bob  Â¦  30
/*+ {
"rewrites": {
"hint_cte_test.v1": "WITH cte_internal AS (SELECT * FROM t1 WHERE age > 20) SELECT * FROM cte_internal"
}
} */
select * from v1 order by id;
â¤ id[4,32,0]  Â¦  name[12,-1,0]  Â¦  age[4,32,0]  ğ„€
2  Â¦  Bob  Â¦  30  ğ„€
3  Â¦  Charlie  Â¦  40
/*+ {
"rewrites": {
"hint_cte_test.cte1": "SELECT 1 as id, 'Fake' as name, 99 as age"
}
} */
with cte1 as (select * from t1)
select * from cte1 order by id;
â¤ id[4,32,0]  Â¦  name[12,-1,0]  Â¦  age[4,32,0]  ğ„€
1  Â¦  Alice  Â¦  20  ğ„€
2  Â¦  Bob  Â¦  30  ğ„€
3  Â¦  Charlie  Â¦  40
set mo_recursive_cte_max_iteration = 10;
internal error: the system variable does not exist
/*+ {
"rewrites": {
"hint_cte_test.t1": "SELECT * FROM t1 WHERE id = 1"
}
} */
with recursive cte(n) as (
select id from t1
union all
select n + 1 from cte where n < 3
)
select * from cte order by n;
â¤ n[4,32,0]  ğ„€
1  ğ„€
2  ğ„€
3
/*+ {
"rewrites": {
"hint_cte_test.t1": "SELECT * FROM t1 WHERE age > 25"
}
} */
with cte1 as (select * from t1)
select a.name, b.age
from cte1 a join cte1 b on a.id = b.id
order by a.name;
â¤ name[12,-1,0]  Â¦  age[4,32,0]  ğ„€
Bob  Â¦  30  ğ„€
Charlie  Â¦  40
/*+ {
"rewrites": {
"hint_cte_test.t1": "SELECT * FROM t1 WHERE age > 25"
}
} */
select * from (
with cte1 as (select * from t1)
select * from cte1
) sub order by id;
â¤ id[4,32,0]  Â¦  name[12,-1,0]  Â¦  age[4,32,0]  ğ„€
2  Â¦  Bob  Â¦  30  ğ„€
3  Â¦  Charlie  Â¦  40
drop table if exists bpc_consolidated_report;
create table bpc_consolidated_report (
b28_s_kgd353d varchar(20),
b28_s_sdata decimal(20,2),
b28_s_kgd4b76 varchar(20),
b28_s_kgd4rtr_kgdxoi5 varchar(20),
b28_s_kgdtvnx varchar(20),
b28_s_kgdp984 varchar(20),
b28_s_kgd4kbn varchar(20),
b28_s_kgdc8w9 varchar(20)
);
insert into bpc_consolidated_report values ('2021.12', -100.0, '4999999021', 'EO_1000', 'ACT_LG', 'F99', 'CNY', 'G123');
insert into bpc_consolidated_report values ('2022.12', -200.0, '4999999021', 'EO_1000', 'ACT_LG', 'F99', 'CNY', 'G123');
/*+ {
"rewrites" : {
"hint_cte_test.bpc_consolidated_report" : "SELECT * FROM bpc_consolidated_report"
}
} */
WITH yearly_revenue AS (
SELECT
CAST(SUBSTRING(b28_s_kgd353d, 1, 4) AS UNSIGNED) AS year_num,
-SUM(b28_s_sdata) AS total_rev
FROM hint_cte_test.bpc_consolidated_report
WHERE b28_s_kgd4b76 = '4999999021'
GROUP BY b28_s_kgd353d
)
SELECT
r1.year_num,
r1.total_rev,
r2.total_rev as prev_rev
FROM yearly_revenue r1
LEFT JOIN yearly_revenue r2 ON r1.year_num = r2.year_num + 1
ORDER BY r1.year_num;
â¤ year_num[-5,64,0]  Â¦  total_rev[3,38,2]  Â¦  prev_rev[3,38,2]  ğ„€
2021  Â¦  100.00  Â¦  null  ğ„€
2022  Â¦  200.00  Â¦  100.00
drop database if exists jst_flat_table1;
create database jst_flat_table1;
use jst_flat_table1;
create table bpc_consolidated_report (
b28_s_kgd353d varchar(20),
b28_s_sdata decimal(20,2),
b28_s_kgd4b76 varchar(20),
b28_s_kgd4rtr_kgdxoi5 varchar(20),
b28_s_kgdtvnx varchar(20),
b28_s_kgdp984 varchar(20),
b28_s_kgd4kbn varchar(20),
b28_s_kgdc8w9 varchar(20)
);
insert into bpc_consolidated_report values
('2021.12', -100.0, '4999999021', 'EO_1000', 'ACT_LG', 'F99', 'CNY', 'G123'),
('2022.12', -200.0, '4999999021', 'EO_1000', 'ACT_LG', 'F99', 'CNY', 'G123'),
('2023.12', -300.0, '4999999021', 'EO_1000', 'ACT_LG', 'F99', 'CNY', 'G123');
/*+ {
"rewrites" : {
"jst_flat_table1.capacity" : "SELECT * FROM jst_flat_table1.capacity",
"jst_flat_table1.open_orders_result" : "SELECT * FROM jst_flat_table1.open_orders_result",
"jst_flat_table1.bpc_consolidated_report" : "SELECT * FROM jst_flat_table1.bpc_consolidated_report"
}
} */
WITH yearly_revenue AS (
SELECT
CAST(SUBSTRING(b28_s_kgd353d, 1, 4) AS UNSIGNED) AS `å¹´ä»½`,
-SUM(b28_s_sdata) AS `è¥ä¸šæ”¶å…¥æ€»é¢`
FROM jst_flat_table1.bpc_consolidated_report
WHERE
b28_s_kgd4b76 IN ('4999999021','6001000000')
AND b28_s_kgd353d IN ('2021.12', '2022.12', '2023.12', '2024.12')
GROUP BY b28_s_kgd353d
)
SELECT
r1.`å¹´ä»½`,
r1.`è¥ä¸šæ”¶å…¥æ€»é¢`,
CASE
WHEN r2.`è¥ä¸šæ”¶å…¥æ€»é¢` IS NOT NULL AND r2.`è¥ä¸šæ”¶å…¥æ€»é¢` != 0
THEN ROUND((r1.`è¥ä¸šæ”¶å…¥æ€»é¢` - r2.`è¥ä¸šæ”¶å…¥æ€»é¢`) / r2.`è¥ä¸šæ”¶å…¥æ€»é¢` * 100, 2)
ELSE NULL
END AS `åŒæ¯”å¢é•¿ç‡(%)`
FROM yearly_revenue r1
LEFT JOIN yearly_revenue r2 ON r1.`å¹´ä»½` = r2.`å¹´ä»½` + 1
ORDER BY r1.`å¹´ä»½`;
â¤ å¹´ä»½[-5,64,0]  Â¦  è¥ä¸šæ”¶å…¥æ€»é¢[3,38,2]  Â¦  åŒæ¯”å¢é•¿ç‡(%)[3,38,2]  ğ„€
2021  Â¦  100.00  Â¦  null  ğ„€
2022  Â¦  200.00  Â¦  100.00  ğ„€
2023  Â¦  300.00  Â¦  50.00
DROP DATABASE IF EXISTS test_cte_rewrite;
CREATE DATABASE test_cte_rewrite;
USE test_cte_rewrite;
CREATE TABLE sales (
id INT,
product VARCHAR(50),
amount DECIMAL(10,2),
sale_date DATE,
region VARCHAR(20)
);
INSERT INTO sales VALUES
(1, 'Product A', 100.00, '2023-01-15', 'North'),
(2, 'Product B', 200.00, '2023-01-20', 'South'),
(3, 'Product A', 150.00, '2023-02-10', 'North'),
(4, 'Product C', 300.00, '2023-02-15', 'East'),
(5, 'Product B', 250.00, '2023-03-05', 'South'),
(6, 'Product A', 180.00, '2023-03-20', 'West'),
(7, 'Product C', 350.00, '2023-04-10', 'East'),
(8, 'Product B', 220.00, '2023-04-25', 'North');
CREATE TABLE employees (
emp_id INT,
emp_name VARCHAR(50),
department VARCHAR(50),
salary DECIMAL(10,2)
);
INSERT INTO employees VALUES
(1, 'Alice', 'Sales', 5000.00),
(2, 'Bob', 'IT', 6000.00),
(3, 'Charlie', 'Sales', 5500.00),
(4, 'David', 'IT', 6500.00),
(5, 'Eve', 'HR', 4500.00);
/*+ {
"rewrites" : {
"test_cte_rewrite.sales" : "SELECT * FROM test_cte_rewrite.sales"
}
} */
WITH sales_summary AS (
SELECT
product,
SUM(amount) AS total_amount
FROM test_cte_rewrite.sales
GROUP BY product
)
SELECT * FROM sales_summary
ORDER BY product;
â¤ product[12,-1,0]  Â¦  total_amount[3,38,2]  ğ„€
Product A  Â¦  430.00  ğ„€
Product B  Â¦  670.00  ğ„€
Product C  Â¦  650.00
/*+ {
"rewrites" : {
"test_cte_rewrite.sales" : "SELECT * FROM test_cte_rewrite.sales"
}
} */
WITH product_count AS (
SELECT
product,
COUNT(*) AS sale_count
FROM test_cte_rewrite.sales
GROUP BY product
)
SELECT * FROM product_count
ORDER BY sale_count DESC;
â¤ product[12,-1,0]  Â¦  sale_count[-5,64,0]  ğ„€
Product A  Â¦  3  ğ„€
Product B  Â¦  3  ğ„€
Product C  Â¦  2
/*+ {
"rewrites" : {
"test_cte_rewrite.sales" : "SELECT * FROM test_cte_rewrite.sales"
}
} */
WITH avg_sales AS (
SELECT
region,
AVG(amount) AS avg_amount
FROM test_cte_rewrite.sales
GROUP BY region
)
SELECT * FROM avg_sales
ORDER BY avg_amount DESC;
â¤ region[12,-1,0]  Â¦  avg_amount[3,38,8]  ğ„€
East  Â¦  325.00000000  ğ„€
South  Â¦  225.00000000  ğ„€
West  Â¦  180.00000000  ğ„€
North  Â¦  156.66666667
/*+ {
"rewrites" : {
"test_cte_rewrite.sales" : "SELECT * FROM test_cte_rewrite.sales"
}
} */
WITH sales_range AS (
SELECT
product,
MAX(amount) AS max_amount,
MIN(amount) AS min_amount
FROM test_cte_rewrite.sales
GROUP BY product
)
SELECT * FROM sales_range
ORDER BY product;
â¤ product[12,-1,0]  Â¦  max_amount[3,10,2]  Â¦  min_amount[3,10,2]  ğ„€
Product A  Â¦  180.00  Â¦  100.00  ğ„€
Product B  Â¦  250.00  Â¦  200.00  ğ„€
Product C  Â¦  350.00  Â¦  300.00
/*+ {
"rewrites" : {
"test_cte_rewrite.sales" : "SELECT * FROM test_cte_rewrite.sales"
}
} */
WITH sales_stats AS (
SELECT
region,
COUNT(*) AS sale_count,
SUM(amount) AS total_amount,
AVG(amount) AS avg_amount,
MAX(amount) AS max_amount,
MIN(amount) AS min_amount
FROM test_cte_rewrite.sales
GROUP BY region
)
SELECT * FROM sales_stats
ORDER BY region;
â¤ region[12,-1,0]  Â¦  sale_count[-5,64,0]  Â¦  total_amount[3,38,2]  Â¦  avg_amount[3,38,8]  Â¦  max_amount[3,10,2]  Â¦  min_amount[3,10,2]  ğ„€
East  Â¦  2  Â¦  650.00  Â¦  325.00000000  Â¦  350.00  Â¦  300.00  ğ„€
North  Â¦  3  Â¦  470.00  Â¦  156.66666667  Â¦  220.00  Â¦  100.00  ğ„€
South  Â¦  2  Â¦  450.00  Â¦  225.00000000  Â¦  250.00  Â¦  200.00  ğ„€
West  Â¦  1  Â¦  180.00  Â¦  180.00000000  Â¦  180.00  Â¦  180.00
/*+ {
"rewrites" : {
"test_cte_rewrite.sales" : "SELECT * FROM test_cte_rewrite.sales"
}
} */
WITH high_sales AS (
SELECT
product,
SUM(amount) AS total_amount
FROM test_cte_rewrite.sales
GROUP BY product
HAVING SUM(amount) > 300
)
SELECT * FROM high_sales
ORDER BY total_amount DESC;
â¤ product[12,-1,0]  Â¦  total_amount[3,38,2]  ğ„€
Product B  Â¦  670.00  ğ„€
Product C  Â¦  650.00  ğ„€
Product A  Â¦  430.00
/*+ {
"rewrites" : {
"test_cte_rewrite.sales" : "SELECT * FROM test_cte_rewrite.sales"
}
} */
WITH monthly_sales AS (
SELECT
DATE_FORMAT(sale_date, '%Y-%m') AS month,
SUM(amount) AS monthly_total
FROM test_cte_rewrite.sales
GROUP BY DATE_FORMAT(sale_date, '%Y-%m')
),
avg_monthly AS (
SELECT
AVG(monthly_total) AS avg_monthly_sales
FROM monthly_sales
)
SELECT * FROM avg_monthly;
â¤ avg_monthly_sales[3,38,8]  ğ„€
437.50000000
/*+ {
"rewrites" : {
"test_cte_rewrite.sales" : "SELECT * FROM test_cte_rewrite.sales"
}
} */
WITH monthly_revenue AS (
SELECT
YEAR(sale_date) AS year,
MONTH(sale_date) AS month,
SUM(amount) AS revenue
FROM test_cte_rewrite.sales
GROUP BY YEAR(sale_date), MONTH(sale_date)
)
SELECT
r1.year,
r1.month,
r1.revenue,
r2.revenue AS prev_month_revenue,
CASE
WHEN r2.revenue IS NOT NULL AND r2.revenue != 0
THEN ROUND((r1.revenue - r2.revenue) / r2.revenue * 100, 2)
ELSE NULL
END AS growth_rate
FROM monthly_revenue r1
LEFT JOIN monthly_revenue r2
ON r1.year = r2.year
AND r1.month = r2.month + 1
ORDER BY r1.year, r1.month;
â¤ year[-5,64,0]  Â¦  month[-6,8,0]  Â¦  revenue[3,38,2]  Â¦  prev_month_revenue[3,38,2]  Â¦  growth_rate[3,38,2]  ğ„€
2023  Â¦  1  Â¦  300.00  Â¦  null  Â¦  null  ğ„€
2023  Â¦  2  Â¦  450.00  Â¦  300.00  Â¦  50.00  ğ„€
2023  Â¦  3  Â¦  430.00  Â¦  450.00  Â¦  -4.44  ğ„€
2023  Â¦  4  Â¦  570.00  Â¦  430.00  Â¦  32.56
/*+ {
"rewrites" : {
"test_cte_rewrite.sales" : "SELECT * FROM test_cte_rewrite.sales"
}
} */
WITH filtered_sales AS (
SELECT
product,
SUM(amount) AS total_amount
FROM test_cte_rewrite.sales
WHERE sale_date >= '2023-02-01'
GROUP BY product
)
SELECT * FROM filtered_sales
WHERE total_amount > 200
ORDER BY total_amount DESC;
â¤ product[12,-1,0]  Â¦  total_amount[3,38,2]  ğ„€
Product C  Â¦  650.00  ğ„€
Product B  Â¦  470.00  ğ„€
Product A  Â¦  330.00
/*+ {
"rewrites" : {
"test_cte_rewrite.sales" : "SELECT * FROM test_cte_rewrite.sales"
}
} */
WITH unique_products AS (
SELECT
region,
COUNT(DISTINCT product) AS product_count
FROM test_cte_rewrite.sales
GROUP BY region
)
SELECT * FROM unique_products
ORDER BY product_count DESC;
â¤ region[12,-1,0]  Â¦  product_count[-5,64,0]  ğ„€
North  Â¦  2  ğ„€
South  Â¦  1  ğ„€
East  Â¦  1  ğ„€
West  Â¦  1
/*+ {
"rewrites" : {
"test_cte_rewrite.sales" : "SELECT * FROM test_cte_rewrite.sales",
"test_cte_rewrite.employees" : "SELECT * FROM test_cte_rewrite.employees"
}
} */
WITH dept_stats AS (
SELECT
department,
COUNT(*) AS emp_count,
AVG(salary) AS avg_salary
FROM test_cte_rewrite.employees
GROUP BY department
)
SELECT * FROM dept_stats
ORDER BY avg_salary DESC;
â¤ department[12,-1,0]  Â¦  emp_count[-5,64,0]  Â¦  avg_salary[3,38,8]  ğ„€
IT  Â¦  2  Â¦  6250.00000000  ğ„€
Sales  Â¦  2  Â¦  5250.00000000  ğ„€
HR  Â¦  1  Â¦  4500.00000000
/*+ {
"rewrites" : {
"test_cte_rewrite.sales" : "SELECT * FROM test_cte_rewrite.sales"
}
} */
WITH product_sales AS (
SELECT
product,
SUM(amount) AS total_amount
FROM test_cte_rewrite.sales
GROUP BY product
)
SELECT
product,
total_amount,
(SELECT AVG(total_amount) FROM product_sales) AS avg_total
FROM product_sales
ORDER BY total_amount DESC;
â¤ product[12,-1,0]  Â¦  total_amount[3,38,2]  Â¦  avg_total[3,38,8]  ğ„€
Product B  Â¦  670.00  Â¦  583.33333333  ğ„€
Product C  Â¦  650.00  Â¦  583.33333333  ğ„€
Product A  Â¦  430.00  Â¦  583.33333333
/*+ {
"rewrites" : {
"test_cte_rewrite.sales" : "SELECT * FROM test_cte_rewrite.sales"
}
} */
WITH region_products AS (
SELECT
region,
GROUP_CONCAT(DISTINCT product ORDER BY product) AS products
FROM test_cte_rewrite.sales
GROUP BY region
)
SELECT * FROM region_products
ORDER BY region;
â¤ region[12,-1,0]  Â¦  products[12,0,0]  ğ„€
East  Â¦  Product C  ğ„€
North  Â¦  Product A,Product B  ğ„€
South  Â¦  Product B  ğ„€
West  Â¦  Product A
/*+ {
"rewrites" : {
"test_cte_rewrite.sales" : "SELECT * FROM test_cte_rewrite.sales"
}
} */
WITH ranked_sales AS (
SELECT
product,
amount,
SUM(amount) OVER (PARTITION BY product) AS product_total,
ROW_NUMBER() OVER (PARTITION BY product ORDER BY amount DESC) AS rank_in_product
FROM test_cte_rewrite.sales
)
SELECT * FROM ranked_sales
WHERE rank_in_product = 1
ORDER BY product;
[unknown result because it is related to issue#23644]
/*+ {
"rewrites" : {
"test_cte_rewrite.sales" : "SELECT * FROM test_cte_rewrite.sales"
}
} */
WITH categorized_sales AS (
SELECT
product,
SUM(CASE WHEN amount > 200 THEN amount ELSE 0 END) AS high_value_sales,
SUM(CASE WHEN amount <= 200 THEN amount ELSE 0 END) AS low_value_sales,
COUNT(CASE WHEN amount > 200 THEN 1 END) AS high_value_count
FROM test_cte_rewrite.sales
GROUP BY product
)
SELECT * FROM categorized_sales
ORDER BY product;
â¤ product[12,-1,0]  Â¦  high_value_sales[3,38,2]  Â¦  low_value_sales[3,38,2]  Â¦  high_value_count[-5,64,0]  ğ„€
Product A  Â¦  0.00  Â¦  430.00  Â¦  0  ğ„€
Product B  Â¦  470.00  Â¦  200.00  Â¦  2  ğ„€
Product C  Â¦  650.00  Â¦  0.00  Â¦  2
/*+ {
"rewrites" : {
"test_cte_rewrite.sales" : "SELECT * FROM test_cte_rewrite.sales"
}
} */
WITH RECURSIVE numbers AS (
SELECT 1 AS n
UNION ALL
SELECT n + 1 FROM numbers WHERE n < 5
),
sales_with_numbers AS (
SELECT
n,
(SELECT COUNT(*) FROM test_cte_rewrite.sales WHERE id <= n) AS cumulative_count
FROM numbers
)
SELECT * FROM sales_with_numbers;
aggregation with non equal predicate in SCALAR subquery  will be supported in future version is not yet implemented
/*+ {
"rewrites" : {
"test_cte_rewrite.sales" : "SELECT * FROM test_cte_rewrite.sales"
}
} */
WITH sales_rollup AS (
SELECT
region,
product,
SUM(amount) AS total_amount
FROM test_cte_rewrite.sales
GROUP BY region, product WITH ROLLUP
)
SELECT * FROM sales_rollup
ORDER BY region, product;
â¤ region[12,-1,0]  Â¦  product[12,-1,0]  Â¦  total_amount[3,38,2]  ğ„€
null  Â¦  null  Â¦  1750.00  ğ„€
null  Â¦  null  Â¦  1750.00  ğ„€
East  Â¦  null  Â¦  650.00  ğ„€
East  Â¦  null  Â¦  650.00  ğ„€
East  Â¦  Product C  Â¦  650.00  ğ„€
North  Â¦  null  Â¦  470.00  ğ„€
North  Â¦  null  Â¦  470.00  ğ„€
North  Â¦  Product A  Â¦  250.00  ğ„€
North  Â¦  Product B  Â¦  220.00  ğ„€
South  Â¦  null  Â¦  450.00  ğ„€
South  Â¦  null  Â¦  450.00  ğ„€
South  Â¦  Product B  Â¦  450.00  ğ„€
West  Â¦  null  Â¦  180.00  ğ„€
West  Â¦  null  Â¦  180.00  ğ„€
West  Â¦  Product A  Â¦  180.00
/*+ {
"rewrites" : {
"test_cte_rewrite.sales" : "SELECT * FROM test_cte_rewrite.sales"
}
} */
WITH north_sales AS (
SELECT
'North' AS region,
SUM(amount) AS total
FROM test_cte_rewrite.sales
WHERE region = 'North'
),
south_sales AS (
SELECT
'South' AS region,
SUM(amount) AS total
FROM test_cte_rewrite.sales
WHERE region = 'South'
)
SELECT * FROM north_sales
UNION ALL
SELECT * FROM south_sales
ORDER BY region;
â¤ region[12,-1,0]  Â¦  total[3,38,2]  ğ„€
North  Â¦  470.00  ğ„€
South  Â¦  450.00
/*+ {
"rewrites" : {
"test_cte_rewrite.sales" : "SELECT * FROM test_cte_rewrite.sales"
}
} */
WITH recent_sales AS (
SELECT
id,
product,
amount,
sale_date
FROM test_cte_rewrite.sales
WHERE sale_date >= '2023-03-01'
)
SELECT * FROM recent_sales
ORDER BY sale_date;
â¤ id[4,32,0]  Â¦  product[12,-1,0]  Â¦  amount[3,10,2]  Â¦  sale_date[91,64,0]  ğ„€
5  Â¦  Product B  Â¦  250.00  Â¦  2023-03-05  ğ„€
6  Â¦  Product A  Â¦  180.00  Â¦  2023-03-20  ğ„€
7  Â¦  Product C  Â¦  350.00  Â¦  2023-04-10  ğ„€
8  Â¦  Product B  Â¦  220.00  Â¦  2023-04-25
WITH sales_summary AS (
SELECT
product,
SUM(amount) AS total_amount
FROM test_cte_rewrite.sales
GROUP BY product
)
SELECT * FROM sales_summary
ORDER BY product;
â¤ product[12,-1,0]  Â¦  total_amount[3,38,2]  ğ„€
Product A  Â¦  430.00  ğ„€
Product B  Â¦  670.00  ğ„€
Product C  Â¦  650.00
DROP DATABASE test_cte_rewrite;
drop database jst_flat_table1;
use hint_cte_test;
drop database hint_cte_test;
set enable_remap_hint = 0;
