drop database if exists test_timestamp_scale_0;
create database test_timestamp_scale_0;
use test_timestamp_scale_0;
drop table if exists t1;
create table t1 (id int not null, dt0 datetime default null, primary key (id));
insert into t1 values (1, current_timestamp(0));
select id, extract(microsecond from dt0) as microseconds, case when extract(microsecond from dt0) = 0 then 'PASS: No fractional seconds' else 'FAIL: Has fractional seconds' end as result from t1;
id    microseconds    result
1    0    PASS: No fractional seconds
drop table t1;

drop table if exists t2;
create table t2 (id int not null, ts0 timestamp(0) default null, primary key (id));
insert into t2 values (1, current_timestamp(0));
select id, extract(microsecond from ts0) as microseconds, case when extract(microsecond from ts0) = 0 then 'PASS: No fractional seconds' else 'FAIL: Has fractional seconds' end as result from t2;
id    microseconds    result
1    0    PASS: No fractional seconds
drop table t2;

drop table if exists t3;
create table t3 (id int not null, dt0 datetime(0), dt6 datetime(6));
insert into t3 values (1, '2024-01-15 10:20:30.999999', '2024-01-15 10:20:30.999999');
select id, dt0, dt6, case when dt0 = '2024-01-15 10:20:31' then 'PASS: Rounded to next second' else 'FAIL: Did not round correctly' end as dt0_result from t3;
id    dt0    dt6    dt0_result
1    2024-01-15 10:20:31    2024-01-15 10:20:30.999999000    PASS: Rounded to next second
drop table t3;

drop database test_timestamp_scale_0;
