drop database if exists insert_auto_pk;
create database insert_auto_pk; use insert_auto_pk;
select `variable_value` from mo_catalog.mo_mysql_compatibility_mode where dat_name ="insert_auto_pk" and `variable_name`="unique_check_on_autoincr";
variable_value
None
drop table if exists t0;
create table t0(a int auto_increment, b int, primary key(a));
insert into t0(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t0(a) values (10);
select * from t0 where a = 3;
a    b
delete from t0 where a=2;
insert into t0(b) values (1), (2);
commit;
insert into t0(b) values (1), (2);
select * from t0 where a = 3;
a    b
select a, count(*) from t0 group by a having count(*) > 1;
a    count(*)
drop table if exists t1;
create table t1(a int unsigned auto_increment , b int, primary key(a));
insert into t1(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t1(a) values (10);
select * from t1 where a = 3;
a    b
delete from t1 where a=2;
insert into t1(b) values (1), (2);
commit;
insert into t1(b) values (1), (2);
select * from t1 where a = 3;
a    b
select a, count(*) from t1 group by a having count(*) > 1;
a    count(*)
drop table if exists t2;
create table t2(a bigint auto_increment, b int, primary key(a));
insert into t2(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t2(a) values (10);
select * from t2 where a = 3;
a    b
delete from t2 where a=2;
insert into t2(b) values (1), (2);
commit;
insert into t2(b) values (1), (2);
select * from t2 where a = 3;
a    b
select a, count(*) from t2 group by a having count(*) > 1;
a    count(*)
drop table if exists t3;
create table t3(a bigint unsigned auto_increment , b int, primary key(a));
insert into t3(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t3(a) values (10);
select * from t3 where a = 3;
a    b
delete from t3 where a=2;
insert into t3(b) values (1), (2);
commit;
insert into t3(b) values (1), (2);
select * from t3 where a = 3;
a    b
select a, count(*) from t3 group by a having count(*) > 1;
a    count(*)
drop table if exists t4;
create table t4(a tinyint auto_increment, b int, primary key(a));
insert into t4(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t4(a) values (10);
select * from t4 where a = 3;
a    b
delete from t4 where a=2;
insert into t4(b) values (1), (2);
commit;
insert into t4(b) values (1), (2);
select * from t4 where a = 3;
a    b
select a, count(*) from t4 group by a having count(*) > 1;
a    count(*)
drop table if exists t5;
create table t5(a tinyint unsigned auto_increment , b int, primary key(a));
insert into t5(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t5(a) values (10);
select * from t5 where a = 3;
a    b
delete from t5 where a=2;
insert into t5(b) values (1), (2);
commit;
insert into t5(b) values (1), (2);
select * from t5 where a = 3;
a    b
select a, count(*) from t5 group by a having count(*) > 1;
a    count(*)
drop table if exists t6;
create table t6(a int auto_increment, b int, primary key(a, b));
insert into t6(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t6(a, b) values (10, 10);
select * from t6 where a = 3;
a    b
delete from t6 where a=2;
insert into t6(b) values (1), (2);
commit;
insert into t6(b) values (1), (2);
select * from t6 where a = 3;
a    b
select a, count(*) from t6 group by a having count(*) > 1;
a    count(*)
drop table if exists t7;
create table t7(a int unsigned auto_increment , b int, primary key(a, b));
insert into t7(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t7(a, b) values (10, 10);
select * from t7 where a = 3;
a    b
delete from t7 where a=2;
insert into t7(b) values (1), (2);
commit;
insert into t7(b) values (1), (2);
select * from t7 where a = 3;
a    b
select a, count(*) from t7 group by a having count(*) > 1;
a    count(*)
drop table if exists t8;
create table t8(a bigint auto_increment, b int, primary key(a, b));
insert into t8(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t8(a, b) values (10, 10);
select * from t8 where a = 3;
a    b
delete from t8 where a=2;
insert into t8(b) values (1), (2);
commit;
insert into t8(b) values (1), (2);
select * from t8 where a = 3;
a    b
select a, count(*) from t8 group by a having count(*) > 1;
a    count(*)
drop table if exists t9;
create table t9(a bigint unsigned auto_increment , b int, primary key(a, b));
insert into t9(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t9(a, b) values (10, 10);
select * from t9 where a = 3;
a    b
delete from t9 where a=2;
insert into t9(b) values (1), (2);
commit;
insert into t9(b) values (1), (2);
select * from t9 where a = 3;
a    b
select a, count(*) from t9 group by a having count(*) > 1;
a    count(*)
drop table if exists t10;
create table t10(a tinyint auto_increment, b int, primary key(a, b));
insert into t10(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t10(a, b) values (10, 10);
select * from t10 where a = 3;
a    b
delete from t10 where a=2;
insert into t10(b) values (1), (2);
commit;
insert into t10(b) values (1), (2);
select * from t10 where a = 3;
a    b
select a, count(*) from t10 group by a having count(*) > 1;
a    count(*)
drop table if exists t11;
create table t11(a tinyint unsigned auto_increment , b int, primary key(a, b));
insert into t11(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t11(a, b) values (10, 10);
select * from t11 where a = 3;
a    b
delete from t11 where a=2;
insert into t11(b) values (1), (2);
commit;
insert into t11(b) values (1), (2);
select * from t11 where a = 3;
a    b
select a, count(*) from t11 group by a having count(*) > 1;
a    count(*)
alter database insert_auto_pk set unique_check_on_autoincr = "Check";
select `variable_value` from mo_catalog.mo_mysql_compatibility_mode where dat_name ="insert_auto_pk" and `variable_name`="unique_check_on_autoincr";
variable_value
Check
drop table if exists t0;
create table t0(a int auto_increment, b int, primary key(a));
insert into t0(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t0(a) values (10);
select * from t0 where a = 3;
a    b
delete from t0 where a=2;
insert into t0(b) values (1), (2);
commit;
insert into t0(b) values (1), (2);
select * from t0 where a = 3;
a    b
select a, count(*) from t0 group by a having count(*) > 1;
a    count(*)
drop table if exists t1;
create table t1(a int unsigned auto_increment , b int, primary key(a));
insert into t1(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t1(a) values (10);
select * from t1 where a = 3;
a    b
delete from t1 where a=2;
insert into t1(b) values (1), (2);
commit;
insert into t1(b) values (1), (2);
select * from t1 where a = 3;
a    b
select a, count(*) from t1 group by a having count(*) > 1;
a    count(*)
drop table if exists t2;
create table t2(a bigint auto_increment, b int, primary key(a));
insert into t2(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t2(a) values (10);
select * from t2 where a = 3;
a    b
delete from t2 where a=2;
insert into t2(b) values (1), (2);
commit;
insert into t2(b) values (1), (2);
select * from t2 where a = 3;
a    b
select a, count(*) from t2 group by a having count(*) > 1;
a    count(*)
drop table if exists t3;
create table t3(a bigint unsigned auto_increment , b int, primary key(a));
insert into t3(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t3(a) values (10);
select * from t3 where a = 3;
a    b
delete from t3 where a=2;
insert into t3(b) values (1), (2);
commit;
insert into t3(b) values (1), (2);
select * from t3 where a = 3;
a    b
select a, count(*) from t3 group by a having count(*) > 1;
a    count(*)
drop table if exists t4;
create table t4(a tinyint auto_increment, b int, primary key(a));
insert into t4(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t4(a) values (10);
select * from t4 where a = 3;
a    b
delete from t4 where a=2;
insert into t4(b) values (1), (2);
commit;
insert into t4(b) values (1), (2);
select * from t4 where a = 3;
a    b
select a, count(*) from t4 group by a having count(*) > 1;
a    count(*)
drop table if exists t5;
create table t5(a tinyint unsigned auto_increment , b int, primary key(a));
insert into t5(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t5(a) values (10);
select * from t5 where a = 3;
a    b
delete from t5 where a=2;
insert into t5(b) values (1), (2);
commit;
insert into t5(b) values (1), (2);
select * from t5 where a = 3;
a    b
select a, count(*) from t5 group by a having count(*) > 1;
a    count(*)
drop table if exists t6;
create table t6(a int auto_increment, b int, primary key(a, b));
insert into t6(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t6(a, b) values (10, 10);
select * from t6 where a = 3;
a    b
delete from t6 where a=2;
insert into t6(b) values (1), (2);
commit;
insert into t6(b) values (1), (2);
select * from t6 where a = 3;
a    b
select a, count(*) from t6 group by a having count(*) > 1;
a    count(*)
drop table if exists t7;
create table t7(a int unsigned auto_increment , b int, primary key(a, b));
insert into t7(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t7(a, b) values (10, 10);
select * from t7 where a = 3;
a    b
delete from t7 where a=2;
insert into t7(b) values (1), (2);
commit;
insert into t7(b) values (1), (2);
select * from t7 where a = 3;
a    b
select a, count(*) from t7 group by a having count(*) > 1;
a    count(*)
drop table if exists t8;
create table t8(a bigint auto_increment, b int, primary key(a, b));
insert into t8(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t8(a, b) values (10, 10);
select * from t8 where a = 3;
a    b
delete from t8 where a=2;
insert into t8(b) values (1), (2);
commit;
insert into t8(b) values (1), (2);
select * from t8 where a = 3;
a    b
select a, count(*) from t8 group by a having count(*) > 1;
a    count(*)
drop table if exists t9;
create table t9(a bigint unsigned auto_increment , b int, primary key(a, b));
insert into t9(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t9(a, b) values (10, 10);
select * from t9 where a = 3;
a    b
delete from t9 where a=2;
insert into t9(b) values (1), (2);
commit;
insert into t9(b) values (1), (2);
select * from t9 where a = 3;
a    b
select a, count(*) from t9 group by a having count(*) > 1;
a    count(*)
drop table if exists t10;
create table t10(a tinyint auto_increment, b int, primary key(a, b));
insert into t10(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t10(a, b) values (10, 10);
select * from t10 where a = 3;
a    b
delete from t10 where a=2;
insert into t10(b) values (1), (2);
commit;
insert into t10(b) values (1), (2);
select * from t10 where a = 3;
a    b
select a, count(*) from t10 group by a having count(*) > 1;
a    count(*)
drop table if exists t11;
create table t11(a tinyint unsigned auto_increment , b int, primary key(a, b));
insert into t11(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t11(a, b) values (10, 10);
select * from t11 where a = 3;
a    b
delete from t11 where a=2;
insert into t11(b) values (1), (2);
commit;
insert into t11(b) values (1), (2);
select * from t11 where a = 3;
a    b
select a, count(*) from t11 group by a having count(*) > 1;
a    count(*)
alter database insert_auto_pk set unique_check_on_autoincr = "Error";
select `variable_value` from mo_catalog.mo_mysql_compatibility_mode where dat_name ="insert_auto_pk" and `variable_name`="unique_check_on_autoincr";
variable_value
Error
drop table if exists t0;
create table t0(a int auto_increment, b int, primary key(a));
insert into t0(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t0(a) values (10);
invalid input: When unique_check_on_autoincr is set to error, insertion of the specified value into auto-incr pk column is not allowed.
select * from t0 where a = 3;
a    b
delete from t0 where a=2;
insert into t0(b) values (1), (2);
commit;
insert into t0(b) values (1), (2);
select * from t0 where a = 3;
a    b
3    1
select a, count(*) from t0 group by a having count(*) > 1;
a    count(*)
drop table if exists t1;
create table t1(a int unsigned auto_increment , b int, primary key(a));
insert into t1(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t1(a) values (10);
invalid input: When unique_check_on_autoincr is set to error, insertion of the specified value into auto-incr pk column is not allowed.
select * from t1 where a = 3;
a    b
delete from t1 where a=2;
insert into t1(b) values (1), (2);
commit;
insert into t1(b) values (1), (2);
select * from t1 where a = 3;
a    b
3    1
select a, count(*) from t1 group by a having count(*) > 1;
a    count(*)
drop table if exists t2;
create table t2(a bigint auto_increment, b int, primary key(a));
insert into t2(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t2(a) values (10);
invalid input: When unique_check_on_autoincr is set to error, insertion of the specified value into auto-incr pk column is not allowed.
select * from t2 where a = 3;
a    b
delete from t2 where a=2;
insert into t2(b) values (1), (2);
commit;
insert into t2(b) values (1), (2);
select * from t2 where a = 3;
a    b
3    1
select a, count(*) from t2 group by a having count(*) > 1;
a    count(*)
drop table if exists t3;
create table t3(a bigint unsigned auto_increment , b int, primary key(a));
insert into t3(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t3(a) values (10);
invalid input: When unique_check_on_autoincr is set to error, insertion of the specified value into auto-incr pk column is not allowed.
select * from t3 where a = 3;
a    b
delete from t3 where a=2;
insert into t3(b) values (1), (2);
commit;
insert into t3(b) values (1), (2);
select * from t3 where a = 3;
a    b
3    1
select a, count(*) from t3 group by a having count(*) > 1;
a    count(*)
drop table if exists t4;
create table t4(a tinyint auto_increment, b int, primary key(a));
insert into t4(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t4(a) values (10);
invalid input: When unique_check_on_autoincr is set to error, insertion of the specified value into auto-incr pk column is not allowed.
select * from t4 where a = 3;
a    b
delete from t4 where a=2;
insert into t4(b) values (1), (2);
commit;
insert into t4(b) values (1), (2);
select * from t4 where a = 3;
a    b
3    1
select a, count(*) from t4 group by a having count(*) > 1;
a    count(*)
drop table if exists t5;
create table t5(a tinyint unsigned auto_increment , b int, primary key(a));
insert into t5(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t5(a) values (10);
invalid input: When unique_check_on_autoincr is set to error, insertion of the specified value into auto-incr pk column is not allowed.
select * from t5 where a = 3;
a    b
delete from t5 where a=2;
insert into t5(b) values (1), (2);
commit;
insert into t5(b) values (1), (2);
select * from t5 where a = 3;
a    b
3    1
select a, count(*) from t5 group by a having count(*) > 1;
a    count(*)
drop table if exists t6;
create table t6(a int auto_increment, b int, primary key(a, b));
insert into t6(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t6(a, b) values (10, 10);
invalid input: When unique_check_on_autoincr is set to error, insertion of the specified value into auto-incr pk column is not allowed.
select * from t6 where a = 3;
a    b
delete from t6 where a=2;
insert into t6(b) values (1), (2);
commit;
insert into t6(b) values (1), (2);
select * from t6 where a = 3;
a    b
3    1
select a, count(*) from t6 group by a having count(*) > 1;
a    count(*)
drop table if exists t7;
create table t7(a int unsigned auto_increment , b int, primary key(a, b));
insert into t7(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t7(a, b) values (10, 10);
invalid input: When unique_check_on_autoincr is set to error, insertion of the specified value into auto-incr pk column is not allowed.
select * from t7 where a = 3;
a    b
delete from t7 where a=2;
insert into t7(b) values (1), (2);
commit;
insert into t7(b) values (1), (2);
select * from t7 where a = 3;
a    b
3    1
select a, count(*) from t7 group by a having count(*) > 1;
a    count(*)
drop table if exists t8;
create table t8(a bigint auto_increment, b int, primary key(a, b));
insert into t8(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t8(a, b) values (10, 10);
invalid input: When unique_check_on_autoincr is set to error, insertion of the specified value into auto-incr pk column is not allowed.
select * from t8 where a = 3;
a    b
delete from t8 where a=2;
insert into t8(b) values (1), (2);
commit;
insert into t8(b) values (1), (2);
select * from t8 where a = 3;
a    b
3    1
select a, count(*) from t8 group by a having count(*) > 1;
a    count(*)
drop table if exists t9;
create table t9(a bigint unsigned auto_increment , b int, primary key(a, b));
insert into t9(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t9(a, b) values (10, 10);
invalid input: When unique_check_on_autoincr is set to error, insertion of the specified value into auto-incr pk column is not allowed.
select * from t9 where a = 3;
a    b
delete from t9 where a=2;
insert into t9(b) values (1), (2);
commit;
insert into t9(b) values (1), (2);
select * from t9 where a = 3;
a    b
3    1
select a, count(*) from t9 group by a having count(*) > 1;
a    count(*)
drop table if exists t10;
create table t10(a tinyint auto_increment, b int, primary key(a, b));
insert into t10(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t10(a, b) values (10, 10);
invalid input: When unique_check_on_autoincr is set to error, insertion of the specified value into auto-incr pk column is not allowed.
select * from t10 where a = 3;
a    b
delete from t10 where a=2;
insert into t10(b) values (1), (2);
commit;
insert into t10(b) values (1), (2);
select * from t10 where a = 3;
a    b
3    1
select a, count(*) from t10 group by a having count(*) > 1;
a    count(*)
drop table if exists t11;
create table t11(a tinyint unsigned auto_increment , b int, primary key(a, b));
insert into t11(b) values (1), (2);
begin;
use insert_auto_pk;
insert into t11(a, b) values (10, 10);
invalid input: When unique_check_on_autoincr is set to error, insertion of the specified value into auto-incr pk column is not allowed.
select * from t11 where a = 3;
a    b
delete from t11 where a=2;
insert into t11(b) values (1), (2);
commit;
insert into t11(b) values (1), (2);
select * from t11 where a = 3;
a    b
3    1
select a, count(*) from t11 group by a having count(*) > 1;
a    count(*)
drop database insert_auto_pk;
