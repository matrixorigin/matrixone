create snapshot snapshot_01 for cluster;
create account default_1 ADMIN_NAME admin IDENTIFIED BY '111111';
create snapshot snapshot_02 for account default_1;
select sleep(1);
sleep(1)
0
create snapshot snapshot_03 for account default_1;
select sleep(1);
sleep(1)
0
create snapshot snapshot_04 for account defalt_1;
internal error: create snapshot for account defalt_1, account defalt_1 does not exist
show snapshots;
SNAPSHOT_NAME    TIMESTAMP    SNAPSHOT_LEVEL    OBJECT_NAME
snapshot_01    2024-03-04 15:27:57    cluster    
snapshot_02    2024-03-04 15:27:57    account    default_1
snapshot_03    2024-03-04 15:27:58    account    default_1
show snapshots where SNAPSHOT_NAME = 'snapshot_01';
snapshot_name    timestamp    snapshot_level    object_name
snapshot_01    2024-03-04 15:27:57    cluster    
show snapshots where SNAPSHOT_LEVEL = 'cluster';
snapshot_name    timestamp    snapshot_level    object_name
snapshot_01    2024-03-04 15:27:57    cluster    
show snapshots where OBJECT_NAME = 'default_1';
snapshot_name    timestamp    snapshot_level    object_name
snapshot_02    2024-03-04 15:27:57    account    default_1
snapshot_03    2024-03-04 15:27:58    account    default_1
DROP SNAPSHOT snapshot_01;
DROP SNAPSHOT snapshot_02;
DROP SNAPSHOT snapshot_03;
DROP SNAPSHOT snapshot_04;
internal error: snapshot snapshot_04 does not exist
create snapshot snapshot_05 for account default_1;
select sleep(1);
sleep(1)
0
create snapshot snapshot_06 for account default_1;
select sleep(1);
sleep(1)
0
create snapshot snapshot_07 for account default_1;
show snapshots;
SNAPSHOT_NAME    TIMESTAMP    SNAPSHOT_LEVEL    OBJECT_NAME
snapshot_05    2024-03-04 15:27:59    account    default_1
snapshot_06    2024-03-04 15:28:00    account    default_1
snapshot_07    2024-03-04 15:28:01    account    default_1
show snapshots where SNAPSHOT_NAME = 'snapshot_07';
snapshot_name    timestamp    snapshot_level    object_name
snapshot_07    2024-03-04 15:28:01    account    default_1
show snapshots where SNAPSHOT_LEVEL = 'account';
snapshot_name    timestamp    snapshot_level    object_name
snapshot_05    2024-03-04 15:27:59    account    default_1
snapshot_06    2024-03-04 15:28:00    account    default_1
snapshot_07    2024-03-04 15:28:01    account    default_1
show snapshots where OBJECT_NAME = 'default_1';
snapshot_name    timestamp    snapshot_level    object_name
snapshot_05    2024-03-04 15:27:59    account    default_1
snapshot_06    2024-03-04 15:28:00    account    default_1
snapshot_07    2024-03-04 15:28:01    account    default_1
drop account default_1;
create snapshot snapshot_08 for account default_1;
internal error: create snapshot for account default_1, account default_1 does not exist
create account default_1 ADMIN_NAME admin IDENTIFIED BY '111111';
create snapshot snapshot_09 for account default_1;
select sleep(1);
sleep(1)
0
create snapshot snapshot_09 for account default_1;
internal error: snapshot snapshot_09 already exists
create account default_2 ADMIN_NAME admin IDENTIFIED BY '111111';
create snapshot snapshot_10 for account default_2;
show snapshots;
SNAPSHOT_NAME    TIMESTAMP    SNAPSHOT_LEVEL    OBJECT_NAME
snapshot_09    2024-03-04 15:28:02    account    default_1
snapshot_10    2024-03-04 15:28:03    account    default_2
create snapshot snapshot_11 for account default_1;
create snapshot snapshot_12 for account default_2;
internal error: only sys tenant can create tenant level snapshot for other tenant
create snapshot snapshot_13 for cluster;
internal error: only sys tenant can create cluster level snapshot
show snapshots;
SNAPSHOT_NAME    TIMESTAMP    SNAPSHOT_LEVEL    OBJECT_NAME
snapshot_11    2024-03-04 15:28:03    account    default_1
create user  efg identified by '111';
create snapshot snapshot_14 for account default_1;
internal error: do not have privilege to execute the statement
create snapshot snapshot_15 for account default_2;
internal error: do not have privilege to execute the statement
drop snapshot if exists snapshot_09;
drop snapshot if exists snapshot_10;
drop account default_1;
drop account default_2;
