set ft_relevancy_algorithm="TF-IDF";
drop database if exists test01;
create database test01;
use test01;
create table src (id bigint primary key, body varchar, title text);
insert into src values (0, 'color is red', 't1'), (1, 'car is yellow', 'crazy car'), (2, 'sky is blue', 'no limit'), (3, 'blue is not red', 'colorful'),
(4, '遠東兒童中文是針對6到9歲的小朋友精心設計的中文學習教材，共三冊，目前已出版一、二冊。', '遠東兒童中文'),
(5, '每冊均採用近百張全幅彩圖及照片，生動活潑、自然真實，加深兒童學習印象，洋溢學習樂趣。', '遠東兒童中文'),
(6, '各個單元主題內容涵蓋中華文化及生活應用的介紹。本套教材含課本、教學指引、生字卡、學生作業本與CD，中英對照，精美大字版。本系列有繁體字及簡體字兩種版本印行。', '中文短篇小說'),
(7, '59個簡單的英文和中文短篇小說', '適合初學者'),
(8, NULL, 'NOT INCLUDED'),
(9, 'NOT INCLUDED BODY', NULL),
(10, NULL, NULL);
create fulltext index ftidx on src (body, title);
drop snapshot if exists snap01;
create snapshot snap01 for account sys;
drop database test01;
restore account sys from snapshot snap01;
drop database test01;
drop snapshot snap01;
drop database if exists test01;
create database test01;
use test01;
create table src (id bigint primary key, body varchar, title text);
insert into src values (0, 'color is red', 't1'), (1, 'car is yellow', 'crazy car'), (2, 'sky is blue', 'no limit'), (3, 'blue is not red', 'colorful'),
(4, '遠東兒童中文是針對6到9歲的小朋友精心設計的中文學習教材，共三冊，目前已出版一、二冊。', '遠東兒童中文'),
(5, '每冊均採用近百張全幅彩圖及照片，生動活潑、自然真實，加深兒童學習印象，洋溢學習樂趣。', '遠東兒童中文'),
(6, '各個單元主題內容涵蓋中華文化及生活應用的介紹。本套教材含課本、教學指引、生字卡、學生作業本與CD，中英對照，精美大字版。本系列有繁體字及簡體字兩種版本印行。', '中文短篇小說'),
(7, '59個簡單的英文和中文短篇小說', '適合初學者'),
(8, NULL, 'NOT INCLUDED'),
(9, 'NOT INCLUDED BODY', NULL),
(10, NULL, NULL);
create fulltext index ftidx on src (body, title);
drop snapshot if exists snap01;
create snapshot snap01 for account sys;
drop database test01;
restore account sys from snapshot snap01;
drop database test01;
drop snapshot snap01;
set experimental_ivf_index=1;
show variables like "experimental_ivf_index";
Variable_name    Value
experimental_ivf_index    on
drop database if exists vecdb2;
create database vecdb2;
use vecdb2;
drop table if exists t1;
create table t1(a int primary key,b vecf32(3), c vecf64(5));
insert into t1 values(1, "[1,2,3]" , "[1,2,3,4,5");
internal error: malformed vector input: [1,2,3,4,5
insert into t1 values(2, "[1,2,4]", "[1,2,4,4,5]");
drop snapshot if exists snap02;
create snapshot snap02 for account sys;
drop database vecdb2;
restore account sys from snapshot snap02;
show variables like "experimental_ivf_index";
Variable_name    Value
experimental_ivf_index    on
set experimental_ivf_index=0;
drop database vecdb2;
drop snapshot snap02;
set global experimental_ivf_index=1;
show variables like "experimental_ivf_index";
Variable_name    Value
experimental_ivf_index    on
drop database if exists vecdb2;
create database vecdb2;
use vecdb2;
drop table if exists t1;
create table t1(a int primary key,b vecf32(3), c vecf64(5));
insert into t1 values(1, "[1,2,3]" , "[1,2,3,4,5");
internal error: malformed vector input: [1,2,3,4,5
insert into t1 values(2, "[1,2,4]", "[1,2,4,4,5]");
drop snapshot if exists snap02;
create snapshot snap02 for account sys;
drop database vecdb2;
restore account sys from snapshot snap02;
show variables like "experimental_ivf_index";
Variable_name    Value
experimental_ivf_index    on
set experimental_ivf_index=0;
drop database vecdb2;
drop snapshot snap02;
set experimental_hnsw_index=1;
show variables like "experimental_hnsw_index";
Variable_name    Value
experimental_hnsw_index    on
drop database if exists test03;
create database test03;
use test03;
drop table if exists vector_empty;
CREATE TABLE vector_empty(a bigint primary key, b vecf32(32), KEY `idxname` USING HNSW(b) M = 48 EF_CONSTRUCTION = 64 EF_SEARCH = 64 OP_TYPE "vector_l2_ops");
DROP TABLE vector_empty;
drop snapshot if exists snap03;
create snapshot snap03 for account sys;
drop database test03;
restore account sys from snapshot snap03;
show variables like "experimental_hnsw_index";
Variable_name    Value
experimental_hnsw_index    on
set experimental_hnsw_index=0;
drop database test03;
drop snapshot snap03;
set global experimental_hnsw_index=1;
show variables like "experimental_hnsw_index";
Variable_name    Value
experimental_hnsw_index    on
drop database if exists test03;
create database test03;
use test03;
drop table if exists vector_empty;
CREATE TABLE vector_empty(a bigint primary key, b vecf32(32), KEY `idxname` USING HNSW(b) M = 48 EF_CONSTRUCTION = 64 EF_SEARCH = 64 OP_TYPE "vector_l2_ops");
DROP TABLE vector_empty;
drop snapshot if exists snap03;
create snapshot snap03 for account sys;
drop database test03;
restore account sys from snapshot snap03;
show variables like "experimental_hnsw_index";
Variable_name    Value
experimental_hnsw_index    on
set experimental_hnsw_index=0;
drop database test03;
drop snapshot snap03;
