DROP DATABASE IF EXISTS charset_test;
SHOW CHARSET;
Charset    Description    Default collation    Maxlen
SHOW CHARACTER SET;
Charset    Description    Default collation    Maxlen
SHOW CHARSET LIKE 'utf8%';
Charset    Description    Default collation    Maxlen
SHOW CHARACTER SET WHERE Charset = 'utf8mb4';
Charset    Description    Default collation    Maxlen
SHOW COLLATION;
Collation    Charset    Id    Default    Compiled    Sortlen    Pad_attribute
binary    binary    63    YES    Yes    1    NO PAD
utf8_bin    utf8    83    YES    Yes    1    NO PAD
utf8_general_ci    utf8    33        Yes    1    PAD SPACE
utf8_unicode_ci    utf8    192        Yes    1    PAD SPACE
utf8mb4_0900_ai_ci    utf8mb4    255        Yes    0    NO PAD
utf8mb4_0900_bin    utf8mb4    309        Yes    1    NO PAD
utf8mb4_bin    utf8mb4    46    YES    Yes    1    NO PAD
utf8mb4_de_pb_0900_ai_ci    utf8mb4    256        Yes    0    NO PAD
utf8mb4_general_ci    utf8mb4    45        Yes    1    PAD SPACE
utf8mb4_is_0900_ai_ci    utf8mb4    257        Yes    0    NO PAD
utf8mb4_lv_0900_ai_ci    utf8mb4    258        Yes    0    NO PAD
utf8mb4_unicode_ci    utf8mb4    224        Yes    1    PAD SPACE
SHOW COLLATION LIKE 'utf8mb4%';
Collation    Charset    Id    Default    Compiled    Sortlen    Pad_attribute
utf8mb4_0900_ai_ci    utf8mb4    255        Yes    0    NO PAD
utf8mb4_0900_bin    utf8mb4    309        Yes    1    NO PAD
utf8mb4_bin    utf8mb4    46    YES    Yes    1    NO PAD
utf8mb4_de_pb_0900_ai_ci    utf8mb4    256        Yes    0    NO PAD
utf8mb4_general_ci    utf8mb4    45        Yes    1    PAD SPACE
utf8mb4_is_0900_ai_ci    utf8mb4    257        Yes    0    NO PAD
utf8mb4_lv_0900_ai_ci    utf8mb4    258        Yes    0    NO PAD
utf8mb4_unicode_ci    utf8mb4    224        Yes    1    PAD SPACE
SHOW COLLATION WHERE Charset = 'utf8mb4';
Collation    Charset    Id    Default    Compiled    Sortlen    Pad_attribute
utf8mb4_0900_ai_ci    utf8mb4    255        Yes    0    NO PAD
utf8mb4_0900_bin    utf8mb4    309        Yes    1    NO PAD
utf8mb4_bin    utf8mb4    46    YES    Yes    1    NO PAD
utf8mb4_de_pb_0900_ai_ci    utf8mb4    256        Yes    0    NO PAD
utf8mb4_general_ci    utf8mb4    45        Yes    1    PAD SPACE
utf8mb4_is_0900_ai_ci    utf8mb4    257        Yes    0    NO PAD
utf8mb4_lv_0900_ai_ci    utf8mb4    258        Yes    0    NO PAD
utf8mb4_unicode_ci    utf8mb4    224        Yes    1    PAD SPACE
SHOW COLLATION WHERE Collation = 'utf8mb4_bin';
Collation    Charset    Id    Default    Compiled    Sortlen    Pad_attribute
utf8mb4_bin    utf8mb4    46    YES    Yes    1    NO PAD
SHOW COLLATION WHERE Charset = 'utf8mb4' AND Collation LIKE '%bin%';
Collation    Charset    Id    Default    Compiled    Sortlen    Pad_attribute
utf8mb4_0900_bin    utf8mb4    309        Yes    1    NO PAD
utf8mb4_bin    utf8mb4    46    YES    Yes    1    NO PAD
CREATE DATABASE charset_test;
USE charset_test;
DROP DATABASE IF EXISTS charset_test_utf8;
CREATE DATABASE charset_test_utf8 CHARACTER SET utf8;
SHOW CREATE DATABASE charset_test_utf8;
Database    Create Database
charset_test_utf8    CREATE DATABASE `charset_test_utf8`
DROP DATABASE IF EXISTS charset_test_utf8mb4;
CREATE DATABASE charset_test_utf8mb4 CHARACTER SET utf8mb4;
SHOW CREATE DATABASE charset_test_utf8mb4;
Database    Create Database
charset_test_utf8mb4    CREATE DATABASE `charset_test_utf8mb4`
DROP DATABASE IF EXISTS charset_test_utf8mb4_bin;
CREATE DATABASE charset_test_utf8mb4_bin CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;
SHOW CREATE DATABASE charset_test_utf8mb4_bin;
Database    Create Database
charset_test_utf8mb4_bin    CREATE DATABASE `charset_test_utf8mb4_bin`
DROP DATABASE IF EXISTS charset_test_utf8mb4_general;
CREATE DATABASE charset_test_utf8mb4_general CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
SHOW CREATE DATABASE charset_test_utf8mb4_general;
Database    Create Database
charset_test_utf8mb4_general    CREATE DATABASE `charset_test_utf8mb4_general`
USE charset_test;
CREATE TABLE t_default (
id INT PRIMARY KEY,
name VARCHAR(100)
);
SHOW CREATE TABLE t_default;
Table    Create Table
t_default    CREATE TABLE `t_default` (\n  `id` int NOT NULL,\n  `name` varchar(100) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n)
CREATE TABLE t_utf8 (
id INT PRIMARY KEY,
name VARCHAR(100)
) CHARACTER SET utf8;
SHOW CREATE TABLE t_utf8;
Table    Create Table
t_utf8    CREATE TABLE `t_utf8` (\n  `id` int NOT NULL,\n  `name` varchar(100) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n)
CREATE TABLE t_utf8mb4_bin (
id INT PRIMARY KEY,
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;
SHOW CREATE TABLE t_utf8mb4_bin;
Table    Create Table
t_utf8mb4_bin    CREATE TABLE `t_utf8mb4_bin` (\n  `id` int NOT NULL,\n  `name` varchar(100) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n)
CREATE TABLE t_utf8mb4_general_ci (
id INT PRIMARY KEY,
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
SHOW CREATE TABLE t_utf8mb4_general_ci;
Table    Create Table
t_utf8mb4_general_ci    CREATE TABLE `t_utf8mb4_general_ci` (\n  `id` int NOT NULL,\n  `name` varchar(100) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n)
CREATE TABLE t_utf8mb4_unicode_ci (
id INT PRIMARY KEY,
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
SHOW CREATE TABLE t_utf8mb4_unicode_ci;
Table    Create Table
t_utf8mb4_unicode_ci    CREATE TABLE `t_utf8mb4_unicode_ci` (\n  `id` int NOT NULL,\n  `name` varchar(100) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n)
CREATE TABLE t_column_charset (
id INT PRIMARY KEY,
name_default VARCHAR(100),
name_utf8 VARCHAR(100) CHARACTER SET utf8,
name_utf8mb4 VARCHAR(100) CHARACTER SET utf8mb4,
name_utf8mb4_bin VARCHAR(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin,
name_utf8mb4_general VARCHAR(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci
);
SHOW CREATE TABLE t_column_charset;
Table    Create Table
t_column_charset    CREATE TABLE `t_column_charset` (\n  `id` int NOT NULL,\n  `name_default` varchar(100) DEFAULT NULL,\n  `name_utf8` varchar(100) DEFAULT NULL,\n  `name_utf8mb4` varchar(100) DEFAULT NULL,\n  `name_utf8mb4_bin` varchar(100) DEFAULT NULL,\n  `name_utf8mb4_general` varchar(100) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n)
DESC t_column_charset;
Field    Type    Null    Key    Default    Extra    Comment
id    INT(32)    NO    PRI    null        
name_default    VARCHAR(100)    YES        null        
name_utf8    VARCHAR(100)    YES        null        
name_utf8mb4    VARCHAR(100)    YES        null        
name_utf8mb4_bin    VARCHAR(100)    YES        null        
name_utf8mb4_general    VARCHAR(100)    YES        null        
CREATE TABLE t_insert_test (
id INT PRIMARY KEY,
data VARCHAR(200)
) CHARACTER SET utf8mb4;
INSERT INTO t_insert_test VALUES (1, 'Hello World');
INSERT INTO t_insert_test VALUES (2, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ');
INSERT INTO t_insert_test VALUES (3, 'abcdefghijklmnopqrstuvwxyz');
INSERT INTO t_insert_test VALUES (4, '0123456789');
INSERT INTO t_insert_test VALUES (5, '!@#$%^&*()_+-=[]{}|;:,.<>?');
INSERT INTO t_insert_test VALUES (6, '`~"\''\\');
SQL parser error: You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use. syntax error at line 1 column 45 near "\\');";
INSERT INTO t_insert_test VALUES (10, '你好世界');
INSERT INTO t_insert_test VALUES (11, '中文测试');
INSERT INTO t_insert_test VALUES (12, '汉字');
INSERT INTO t_insert_test VALUES (20, 'こんにちは');
INSERT INTO t_insert_test VALUES (21, 'ひらがな');
INSERT INTO t_insert_test VALUES (22, 'カタカナ');
INSERT INTO t_insert_test VALUES (30, '안녕하세요');
INSERT INTO t_insert_test VALUES (31, '한글');
INSERT INTO t_insert_test VALUES (40, '😀😃😄😁');
INSERT INTO t_insert_test VALUES (41, '🎉🎊🎈');
INSERT INTO t_insert_test VALUES (42, '❤️💕💖');
INSERT INTO t_insert_test VALUES (50, 'Привет');  -- Russian
INSERT INTO t_insert_test VALUES (51, 'مرحبا');   -- Arabic
INSERT INTO t_insert_test VALUES (52, 'שלום');    -- Hebrew
INSERT INTO t_insert_test VALUES (53, 'Γειά σου'); -- Greek
INSERT INTO t_insert_test VALUES (54, 'สวัสดี');  -- Thai
INSERT INTO t_insert_test VALUES (60, 'Hello 你好 こんにちは 안녕');
INSERT INTO t_insert_test VALUES (61, 'Test测试テスト테스트');
SELECT * FROM t_insert_test ORDER BY id;
id    data
1    Hello World
2    ABCDEFGHIJKLMNOPQRSTUVWXYZ
3    abcdefghijklmnopqrstuvwxyz
4    0123456789
5    !@#$%^&*()_+-=[]{}|;:,.<>?
10    你好世界
11    中文测试
12    汉字
20    こんにちは
21    ひらがな
22    カタカナ
30    안녕하세요
31    한글
40    😀😃😄😁
41    🎉🎊🎈
42    ❤️💕💖
50    Привет
51    مرحبا
52    שלום
53    Γειά σου
54    สวัสดี
60    Hello 你好 こんにちは 안녕
61    Test测试テスト테스트
CREATE TABLE t_compare_ci (
id INT PRIMARY KEY,
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
INSERT INTO t_compare_ci VALUES (1, 'Apple');
INSERT INTO t_compare_ci VALUES (2, 'apple');
INSERT INTO t_compare_ci VALUES (3, 'APPLE');
INSERT INTO t_compare_ci VALUES (4, 'aPpLe');
SELECT * FROM t_compare_ci WHERE name = 'apple';
id    name
2    apple
SELECT * FROM t_compare_ci WHERE name = 'APPLE';
id    name
3    APPLE
SELECT * FROM t_compare_ci WHERE name = 'Apple';
id    name
1    Apple
SELECT COUNT(*) FROM t_compare_ci WHERE name = 'apple';
COUNT(*)
1
CREATE TABLE t_compare_bin (
id INT PRIMARY KEY,
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;
INSERT INTO t_compare_bin VALUES (1, 'Apple');
INSERT INTO t_compare_bin VALUES (2, 'apple');
INSERT INTO t_compare_bin VALUES (3, 'APPLE');
INSERT INTO t_compare_bin VALUES (4, 'aPpLe');
SELECT * FROM t_compare_bin WHERE name = 'apple';
id    name
2    apple
SELECT * FROM t_compare_bin WHERE name = 'APPLE';
id    name
3    APPLE
SELECT * FROM t_compare_bin WHERE name = 'Apple';
id    name
1    Apple
SELECT COUNT(*) FROM t_compare_bin WHERE name = 'apple';
COUNT(*)
1
SELECT COUNT(*) FROM t_compare_bin WHERE name = 'APPLE';
COUNT(*)
1
CREATE TABLE t_sort_ci (
id INT PRIMARY KEY,
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
INSERT INTO t_sort_ci VALUES (1, 'zebra');
INSERT INTO t_sort_ci VALUES (2, 'Zebra');
INSERT INTO t_sort_ci VALUES (3, 'ZEBRA');
INSERT INTO t_sort_ci VALUES (4, 'apple');
INSERT INTO t_sort_ci VALUES (5, 'Apple');
INSERT INTO t_sort_ci VALUES (6, 'APPLE');
INSERT INTO t_sort_ci VALUES (7, 'banana');
INSERT INTO t_sort_ci VALUES (8, 'Banana');
INSERT INTO t_sort_ci VALUES (9, 'BANANA');
SELECT * FROM t_sort_ci ORDER BY name;
id    name
6    APPLE
5    Apple
9    BANANA
8    Banana
3    ZEBRA
2    Zebra
4    apple
7    banana
1    zebra
SELECT * FROM t_sort_ci ORDER BY name DESC;
id    name
1    zebra
7    banana
4    apple
2    Zebra
3    ZEBRA
8    Banana
9    BANANA
5    Apple
6    APPLE
CREATE TABLE t_sort_bin (
id INT PRIMARY KEY,
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;
INSERT INTO t_sort_bin VALUES (1, 'zebra');
INSERT INTO t_sort_bin VALUES (2, 'Zebra');
INSERT INTO t_sort_bin VALUES (3, 'ZEBRA');
INSERT INTO t_sort_bin VALUES (4, 'apple');
INSERT INTO t_sort_bin VALUES (5, 'Apple');
INSERT INTO t_sort_bin VALUES (6, 'APPLE');
INSERT INTO t_sort_bin VALUES (7, 'banana');
INSERT INTO t_sort_bin VALUES (8, 'Banana');
INSERT INTO t_sort_bin VALUES (9, 'BANANA');
SELECT * FROM t_sort_bin ORDER BY name;
id    name
6    APPLE
5    Apple
9    BANANA
8    Banana
3    ZEBRA
2    Zebra
4    apple
7    banana
1    zebra
SELECT * FROM t_sort_bin ORDER BY name DESC;
id    name
1    zebra
7    banana
4    apple
2    Zebra
3    ZEBRA
8    Banana
9    BANANA
5    Apple
6    APPLE
CREATE TABLE t_distinct_ci (
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
INSERT INTO t_distinct_ci VALUES ('Apple'), ('apple'), ('APPLE');
INSERT INTO t_distinct_ci VALUES ('Banana'), ('banana'), ('BANANA');
SELECT DISTINCT name FROM t_distinct_ci ORDER BY name;
name
APPLE
Apple
BANANA
Banana
apple
banana
SELECT COUNT(DISTINCT name) FROM t_distinct_ci;
COUNT(distinct name)
6
CREATE TABLE t_distinct_bin (
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;
INSERT INTO t_distinct_bin VALUES ('Apple'), ('apple'), ('APPLE');
INSERT INTO t_distinct_bin VALUES ('Banana'), ('banana'), ('BANANA');
SELECT DISTINCT name FROM t_distinct_bin ORDER BY name;
name
APPLE
Apple
BANANA
Banana
apple
banana
SELECT COUNT(DISTINCT name) FROM t_distinct_bin;
COUNT(distinct name)
6
CREATE TABLE t_group_ci (
id INT,
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
INSERT INTO t_group_ci VALUES (1, 'Apple'), (2, 'apple'), (3, 'APPLE');
INSERT INTO t_group_ci VALUES (4, 'Banana'), (5, 'banana'), (6, 'BANANA');
SELECT name, COUNT(*) as cnt FROM t_group_ci GROUP BY name ORDER BY name;
name    cnt
APPLE    1
Apple    1
BANANA    1
Banana    1
apple    1
banana    1
CREATE TABLE t_group_bin (
id INT,
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;
INSERT INTO t_group_bin VALUES (1, 'Apple'), (2, 'apple'), (3, 'APPLE');
INSERT INTO t_group_bin VALUES (4, 'Banana'), (5, 'banana'), (6, 'BANANA');
SELECT name, COUNT(*) as cnt FROM t_group_bin GROUP BY name ORDER BY name;
name    cnt
APPLE    1
Apple    1
BANANA    1
Banana    1
apple    1
banana    1
CREATE TABLE t_like_ci (
id INT PRIMARY KEY,
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
INSERT INTO t_like_ci VALUES (1, 'Apple');
INSERT INTO t_like_ci VALUES (2, 'apple');
INSERT INTO t_like_ci VALUES (3, 'Application');
INSERT INTO t_like_ci VALUES (4, 'Banana');
SELECT * FROM t_like_ci WHERE name LIKE 'app%' ORDER BY id;
id    name
2    apple
SELECT * FROM t_like_ci WHERE name LIKE 'APP%' ORDER BY id;
id    name
SELECT * FROM t_like_ci WHERE name LIKE '%le' ORDER BY id;
id    name
1    Apple
2    apple
CREATE TABLE t_like_bin (
id INT PRIMARY KEY,
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;
INSERT INTO t_like_bin VALUES (1, 'Apple');
INSERT INTO t_like_bin VALUES (2, 'apple');
INSERT INTO t_like_bin VALUES (3, 'Application');
INSERT INTO t_like_bin VALUES (4, 'Banana');
SELECT * FROM t_like_bin WHERE name LIKE 'app%' ORDER BY id;
id    name
2    apple
SELECT * FROM t_like_bin WHERE name LIKE 'APP%' ORDER BY id;
id    name
SELECT * FROM t_like_bin WHERE name LIKE '%le' ORDER BY id;
id    name
1    Apple
2    apple
CREATE TABLE t_join1_ci (
id INT PRIMARY KEY,
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
CREATE TABLE t_join2_ci (
id INT PRIMARY KEY,
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
INSERT INTO t_join1_ci VALUES (1, 'Apple'), (2, 'Banana'), (3, 'Cherry');
INSERT INTO t_join2_ci VALUES (1, 'apple'), (2, 'BANANA'), (3, 'cherry');
SELECT t1.id, t1.name, t2.name
FROM t_join1_ci t1
JOIN t_join2_ci t2 ON t1.name = t2.name
ORDER BY t1.id;
id    name    name
CREATE TABLE t_join1_bin (
id INT PRIMARY KEY,
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;
CREATE TABLE t_join2_bin (
id INT PRIMARY KEY,
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;
INSERT INTO t_join1_bin VALUES (1, 'Apple'), (2, 'Banana'), (3, 'Cherry');
INSERT INTO t_join2_bin VALUES (1, 'apple'), (2, 'BANANA'), (3, 'cherry');
SELECT t1.id, t1.name, t2.name
FROM t_join1_bin t1
JOIN t_join2_bin t2 ON t1.name = t2.name
ORDER BY t1.id;
id    name    name
CREATE TABLE t_union1_ci (
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
CREATE TABLE t_union2_ci (
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
INSERT INTO t_union1_ci VALUES ('Apple'), ('Banana');
INSERT INTO t_union2_ci VALUES ('apple'), ('Cherry');
SELECT name FROM t_union1_ci
UNION
SELECT name FROM t_union2_ci
ORDER BY name;
name
Apple
Banana
Cherry
apple
SELECT name FROM t_union1_ci
UNION ALL
SELECT name FROM t_union2_ci
ORDER BY name;
name
Apple
Banana
Cherry
apple
CREATE TABLE t_functions (
id INT PRIMARY KEY,
data VARCHAR(200)
) CHARACTER SET utf8mb4;
INSERT INTO t_functions VALUES (1, 'Hello World');
INSERT INTO t_functions VALUES (2, '你好世界');
INSERT INTO t_functions VALUES (3, 'こんにちは');
INSERT INTO t_functions VALUES (4, '안녕하세요');
SELECT id, data, LENGTH(data) as byte_len, CHAR_LENGTH(data) as char_len
FROM t_functions ORDER BY id;
id    data    byte_len    char_len
1    Hello World    11    11
2    你好世界    12    4
3    こんにちは    15    5
4    안녕하세요    15    5
SELECT id, data, UPPER(data) as upper_data, LOWER(data) as lower_data
FROM t_functions WHERE id = 1;
id    data    upper_data    lower_data
1    Hello World    HELLO WORLD    hello world
SELECT id, SUBSTRING(data, 1, 5) as substr FROM t_functions ORDER BY id;
id    substr
1    Hello
2    你好世界
3    こんにちは
4    안녕하세요
SELECT CONCAT('prefix_', data, '_suffix') as result FROM t_functions WHERE id = 1;
result
prefix_Hello World_suffix
SELECT CONCAT('前缀_', data, '_后缀') as result FROM t_functions WHERE id = 2;
result
前缀_你好世界_后缀
CREATE TABLE t_alter (
id INT PRIMARY KEY,
name VARCHAR(100)
);
ALTER TABLE t_alter CHARACTER SET utf8mb4;
SHOW CREATE TABLE t_alter;
Table    Create Table
t_alter    CREATE TABLE `t_alter` (\n  `id` int NOT NULL,\n  `name` varchar(100) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n)
ALTER TABLE t_alter COLLATE utf8mb4_bin;
invalid input: unsupported alter option in inplace mode: Collate = utf8mb4_bin
SHOW CREATE TABLE t_alter;
Table    Create Table
t_alter    CREATE TABLE `t_alter` (\n  `id` int NOT NULL,\n  `name` varchar(100) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n)
ALTER TABLE t_alter MODIFY COLUMN name VARCHAR(100) CHARACTER SET utf8mb4;
not supported: unsupport column definition <nil>
SHOW CREATE TABLE t_alter;
Table    Create Table
t_alter    CREATE TABLE `t_alter` (\n  `id` int NOT NULL,\n  `name` varchar(100) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n)
ALTER TABLE t_alter MODIFY COLUMN name VARCHAR(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;
not supported: unsupport column definition <nil>
SHOW CREATE TABLE t_alter;
Table    Create Table
t_alter    CREATE TABLE `t_alter` (\n  `id` int NOT NULL,\n  `name` varchar(100) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n)
CREATE TABLE t_index_ci (
id INT PRIMARY KEY,
name VARCHAR(100),
KEY idx_name (name)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
INSERT INTO t_index_ci VALUES (1, 'Apple'), (2, 'apple'), (3, 'APPLE');
INSERT INTO t_index_ci VALUES (4, 'Banana'), (5, 'banana');
SELECT * FROM t_index_ci WHERE name = 'apple' ORDER BY id;
id    name
2    apple
CREATE TABLE t_index_bin (
id INT PRIMARY KEY,
name VARCHAR(100),
KEY idx_name (name)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;
INSERT INTO t_index_bin VALUES (1, 'Apple'), (2, 'apple'), (3, 'APPLE');
INSERT INTO t_index_bin VALUES (4, 'Banana'), (5, 'banana');
SELECT * FROM t_index_bin WHERE name = 'apple' ORDER BY id;
id    name
2    apple
CREATE TABLE t_unique_ci (
id INT PRIMARY KEY,
name VARCHAR(100) UNIQUE
) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
INSERT INTO t_unique_ci VALUES (1, 'Apple');
SELECT * FROM t_unique_ci;
id    name
1    Apple
CREATE TABLE t_unique_bin (
id INT PRIMARY KEY,
name VARCHAR(100) UNIQUE
) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;
INSERT INTO t_unique_bin VALUES (1, 'Apple');
INSERT INTO t_unique_bin VALUES (2, 'apple');
INSERT INTO t_unique_bin VALUES (3, 'APPLE');
SELECT * FROM t_unique_bin ORDER BY id;
id    name
1    Apple
2    apple
3    APPLE
CREATE TABLE t_special_chars (
id INT PRIMARY KEY,
data VARCHAR(200)
) CHARACTER SET utf8mb4;
INSERT INTO t_special_chars VALUES (1, 'Tab:\ttest');
INSERT INTO t_special_chars VALUES (2, 'Newline:\ntest');
INSERT INTO t_special_chars VALUES (3, 'Quote:\'test\'');
INSERT INTO t_special_chars VALUES (4, 'Double quote:\"test\"');
INSERT INTO t_special_chars VALUES (5, 'Backslash:\\test');
INSERT INTO t_special_chars VALUES (6, 'NULL:\0test');
SELECT id, LENGTH(data), CHAR_LENGTH(data) FROM t_special_chars ORDER BY id;
id    LENGTH(data)    CHAR_LENGTH(data)
1    9    9
2    13    13
3    12    12
4    19    19
5    15    15
6    10    10
SELECT id, HEX(data) FROM t_special_chars WHERE id IN (1, 6) ORDER BY id;
id    HEX(data)
1    5461623A0974657374
6    4E554C4C3A0074657374
CREATE TABLE t_long_strings (
id INT PRIMARY KEY,
data TEXT
) CHARACTER SET utf8mb4;
INSERT INTO t_long_strings VALUES (1, REPEAT('A', 1000));
INSERT INTO t_long_strings VALUES (2, REPEAT('你', 500));
INSERT INTO t_long_strings VALUES (3, REPEAT('😀', 250));
SELECT id, LENGTH(data) as byte_len, CHAR_LENGTH(data) as char_len
FROM t_long_strings ORDER BY id;
id    byte_len    char_len
1    1000    1000
2    1500    500
3    1000    250
SELECT CHARSET('test');
CHARSET(test)
utf8mb4
SELECT CHARSET('你好');
CHARSET(你好)
utf8mb4
SELECT COLLATION('test');
COLLATION(test)
utf8mb4_general_ci
SELECT COLLATION('你好');
COLLATION(你好)
utf8mb4_general_ci
CREATE TABLE t_comparison (
id INT PRIMARY KEY,
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
INSERT INTO t_comparison VALUES (1, 'Apple');
INSERT INTO t_comparison VALUES (2, 'Banana');
INSERT INTO t_comparison VALUES (3, 'Cherry');
SELECT * FROM t_comparison WHERE name > 'apple' ORDER BY id;
id    name
SELECT * FROM t_comparison WHERE name >= 'apple' ORDER BY id;
id    name
SELECT * FROM t_comparison WHERE name < 'cherry' ORDER BY id;
id    name
1    Apple
2    Banana
3    Cherry
SELECT * FROM t_comparison WHERE name <= 'cherry' ORDER BY id;
id    name
1    Apple
2    Banana
3    Cherry
SELECT * FROM t_comparison WHERE name BETWEEN 'Apple' AND 'Cherry' ORDER BY id;
id    name
1    Apple
2    Banana
3    Cherry
SELECT * FROM t_comparison WHERE name IN ('apple', 'BANANA', 'cherry') ORDER BY id;
id    name
SELECT MIN(name) as min_name, MAX(name) as max_name FROM t_comparison;
min_name    max_name
Apple    Cherry
CREATE TABLE t_minmax_bin (
id INT,
name VARCHAR(100)
) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin;
INSERT INTO t_minmax_bin VALUES (1, 'Apple'), (2, 'apple'), (3, 'APPLE');
SELECT MIN(name) as min_name, MAX(name) as max_name FROM t_minmax_bin;
min_name    max_name
APPLE    apple
SELECT CAST('test' AS CHAR CHARACTER SET utf8mb4);
SQL parser error: You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use. syntax error at line 1 column 36 near " CHARACTER SET utf8mb4);";
SELECT CAST('你好' AS CHAR(10) CHARACTER SET utf8mb4);
SQL parser error: You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use. syntax error at line 1 column 42 near " CHARACTER SET utf8mb4);";
CREATE TABLE t_edge_cases (
id INT PRIMARY KEY,
data VARCHAR(200)
) CHARACTER SET utf8mb4;
INSERT INTO t_edge_cases VALUES (1, '');
INSERT INTO t_edge_cases VALUES (2, 'A');
INSERT INTO t_edge_cases VALUES (3, '中');
INSERT INTO t_edge_cases VALUES (4, '😀');
INSERT INTO t_edge_cases VALUES (5, ' ');
INSERT INTO t_edge_cases VALUES (6, '  ');
INSERT INTO t_edge_cases VALUES (7, '   ');
INSERT INTO t_edge_cases VALUES (8, ' test ');
INSERT INTO t_edge_cases VALUES (9, '  test  ');
SELECT * FROM t_edge_cases ORDER BY id;
id    data
1    
2    A
3    中
4    😀
5     
6      
7       
8     test 
9      test  
SELECT id, LENGTH(data), CHAR_LENGTH(data) FROM t_edge_cases ORDER BY id;
id    LENGTH(data)    CHAR_LENGTH(data)
1    0    0
2    1    1
3    3    1
4    4    1
5    1    1
6    2    2
7    3    3
8    6    6
9    8    8
DROP DATABASE IF EXISTS charset_test;
DROP DATABASE IF EXISTS charset_test_utf8;
DROP DATABASE IF EXISTS charset_test_utf8mb4;
DROP DATABASE IF EXISTS charset_test_utf8mb4_bin;
DROP DATABASE IF EXISTS charset_test_utf8mb4_general;
