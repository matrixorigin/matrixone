SET GLOBAL password_history = 5;
SET GLOBAL password_reuse_interval = 180;
CREATE USER 'test_user'@'localhost' IDENTIFIED BY 'password1';
select password_history from mo_catalog.mo_user where user_name  = 'test_user';
password_history
[{"password": "*668425423DB5193AF921380129F465A6425216D0", "password_timestamp": "2024-10-30 06:45:09"}]
ALTER USER 'test_user'@'localhost' IDENTIFIED BY 'password2';
select password_history from mo_catalog.mo_user where user_name  = 'test_user';
password_history
[{"password": "*668425423DB5193AF921380129F465A6425216D0", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*DC52755F3C09F5923046BD42AFA76BD1D80DF2E9", "password_timestamp": "2024-10-30 06:45:09"}]
ALTER USER 'test_user'@'localhost' IDENTIFIED BY 'password3';
select password_history from mo_catalog.mo_user where user_name  = 'test_user';
password_history
[{"password": "*668425423DB5193AF921380129F465A6425216D0", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*DC52755F3C09F5923046BD42AFA76BD1D80DF2E9", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*40C3E7D386A2FADBDF69ACEBE7AA4DC3C723D798", "password_timestamp": "2024-10-30 06:45:09"}]
ALTER USER 'test_user'@'localhost' IDENTIFIED BY 'password4';
select password_history from mo_catalog.mo_user where user_name  = 'test_user';
password_history
[{"password": "*668425423DB5193AF921380129F465A6425216D0", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*DC52755F3C09F5923046BD42AFA76BD1D80DF2E9", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*40C3E7D386A2FADBDF69ACEBE7AA4DC3C723D798", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*F97AEB38B3275C06D822FC9341A2151642C81988", "password_timestamp": "2024-10-30 06:45:09"}]
ALTER USER 'test_user'@'localhost' IDENTIFIED BY 'password5';
select password_history from mo_catalog.mo_user where user_name  = 'test_user';
password_history
[{"password": "*668425423DB5193AF921380129F465A6425216D0", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*DC52755F3C09F5923046BD42AFA76BD1D80DF2E9", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*40C3E7D386A2FADBDF69ACEBE7AA4DC3C723D798", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*F97AEB38B3275C06D822FC9341A2151642C81988", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*5A6AB0B9E84ED1EEC9E8AE9C926922C5D1EDF908", "password_timestamp": "2024-10-30 06:45:09"}]
ALTER USER 'test_user'@'localhost' IDENTIFIED BY 'password1';
invalid input: The password has been used before, please change another one.
select password_history from mo_catalog.mo_user where user_name  = 'test_user';
password_history
[{"password": "*668425423DB5193AF921380129F465A6425216D0", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*DC52755F3C09F5923046BD42AFA76BD1D80DF2E9", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*40C3E7D386A2FADBDF69ACEBE7AA4DC3C723D798", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*F97AEB38B3275C06D822FC9341A2151642C81988", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*5A6AB0B9E84ED1EEC9E8AE9C926922C5D1EDF908", "password_timestamp": "2024-10-30 06:45:09"}]
ALTER USER 'test_user'@'localhost' IDENTIFIED BY 'password2';
invalid input: The password has been used before, please change another one.
select password_history from mo_catalog.mo_user where user_name  = 'test_user';
password_history
[{"password": "*668425423DB5193AF921380129F465A6425216D0", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*DC52755F3C09F5923046BD42AFA76BD1D80DF2E9", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*40C3E7D386A2FADBDF69ACEBE7AA4DC3C723D798", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*F97AEB38B3275C06D822FC9341A2151642C81988", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*5A6AB0B9E84ED1EEC9E8AE9C926922C5D1EDF908", "password_timestamp": "2024-10-30 06:45:09"}]
ALTER USER 'test_user'@'localhost' IDENTIFIED BY 'password3';
invalid input: The password has been used before, please change another one.
select password_history from mo_catalog.mo_user where user_name  = 'test_user';
password_history
[{"password": "*668425423DB5193AF921380129F465A6425216D0", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*DC52755F3C09F5923046BD42AFA76BD1D80DF2E9", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*40C3E7D386A2FADBDF69ACEBE7AA4DC3C723D798", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*F97AEB38B3275C06D822FC9341A2151642C81988", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*5A6AB0B9E84ED1EEC9E8AE9C926922C5D1EDF908", "password_timestamp": "2024-10-30 06:45:09"}]
ALTER USER 'test_user'@'localhost' IDENTIFIED BY 'password4';
invalid input: The password has been used before, please change another one.
select password_history from mo_catalog.mo_user where user_name  = 'test_user';
password_history
[{"password": "*668425423DB5193AF921380129F465A6425216D0", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*DC52755F3C09F5923046BD42AFA76BD1D80DF2E9", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*40C3E7D386A2FADBDF69ACEBE7AA4DC3C723D798", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*F97AEB38B3275C06D822FC9341A2151642C81988", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*5A6AB0B9E84ED1EEC9E8AE9C926922C5D1EDF908", "password_timestamp": "2024-10-30 06:45:09"}]
ALTER USER 'test_user'@'localhost' IDENTIFIED BY 'password5';
invalid input: The password has been used before, please change another one.
select password_history from mo_catalog.mo_user where user_name  = 'test_user';
password_history
[{"password": "*668425423DB5193AF921380129F465A6425216D0", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*DC52755F3C09F5923046BD42AFA76BD1D80DF2E9", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*40C3E7D386A2FADBDF69ACEBE7AA4DC3C723D798", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*F97AEB38B3275C06D822FC9341A2151642C81988", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*5A6AB0B9E84ED1EEC9E8AE9C926922C5D1EDF908", "password_timestamp": "2024-10-30 06:45:09"}]
ALTER USER 'test_user'@'localhost' IDENTIFIED BY 'password6';
select password_history from mo_catalog.mo_user where user_name  = 'test_user';
password_history
[{"password": "*668425423DB5193AF921380129F465A6425216D0", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*DC52755F3C09F5923046BD42AFA76BD1D80DF2E9", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*40C3E7D386A2FADBDF69ACEBE7AA4DC3C723D798", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*F97AEB38B3275C06D822FC9341A2151642C81988", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*5A6AB0B9E84ED1EEC9E8AE9C926922C5D1EDF908", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*2C8BCF8625930454A2B4A1D946A910DF85B0012C", "password_timestamp": "2024-10-30 06:45:09"}]
ALTER USER 'test_user'@'localhost' IDENTIFIED BY 'password7';
select password_history from mo_catalog.mo_user where user_name  = 'test_user';
password_history
[{"password": "*668425423DB5193AF921380129F465A6425216D0", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*DC52755F3C09F5923046BD42AFA76BD1D80DF2E9", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*40C3E7D386A2FADBDF69ACEBE7AA4DC3C723D798", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*F97AEB38B3275C06D822FC9341A2151642C81988", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*5A6AB0B9E84ED1EEC9E8AE9C926922C5D1EDF908", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*2C8BCF8625930454A2B4A1D946A910DF85B0012C", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*AEE0104711CE8D00C4FE9F2690B16A825E433750", "password_timestamp": "2024-10-30 06:45:09"}]
ALTER USER 'test_user'@'localhost' IDENTIFIED BY 'password1';
invalid input: The password has been used before, please change another one
select password_history from mo_catalog.mo_user where user_name  = 'test_user';
password_history
[{"password": "*668425423DB5193AF921380129F465A6425216D0", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*DC52755F3C09F5923046BD42AFA76BD1D80DF2E9", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*40C3E7D386A2FADBDF69ACEBE7AA4DC3C723D798", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*F97AEB38B3275C06D822FC9341A2151642C81988", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*5A6AB0B9E84ED1EEC9E8AE9C926922C5D1EDF908", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*2C8BCF8625930454A2B4A1D946A910DF85B0012C", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*AEE0104711CE8D00C4FE9F2690B16A825E433750", "password_timestamp": "2024-10-30 06:45:09"}]
ALTER USER 'test_user'@'localhost' IDENTIFIED BY 'password2';
invalid input: The password has been used before, please change another one
select password_history from mo_catalog.mo_user where user_name  = 'test_user';
password_history
[{"password": "*668425423DB5193AF921380129F465A6425216D0", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*DC52755F3C09F5923046BD42AFA76BD1D80DF2E9", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*40C3E7D386A2FADBDF69ACEBE7AA4DC3C723D798", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*F97AEB38B3275C06D822FC9341A2151642C81988", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*5A6AB0B9E84ED1EEC9E8AE9C926922C5D1EDF908", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*2C8BCF8625930454A2B4A1D946A910DF85B0012C", "password_timestamp": "2024-10-30 06:45:09"}, {"password": "*AEE0104711CE8D00C4FE9F2690B16A825E433750", "password_timestamp": "2024-10-30 06:45:09"}]
DROP USER 'test_user'@'localhost';
SET GLOBAL password_history = default;
SET GLOBAL password_reuse_interval = default;
