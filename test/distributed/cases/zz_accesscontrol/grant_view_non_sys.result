set global enable_privilege_cache = off;
drop account if exists acc_view_test;
create account acc_view_test admin_name = 'admin' identified by '111';
create role role_v1;
create user user_v1 identified by '111' default role role_v1;
grant role_v1 to user_v1;
create database db_v1;
use db_v1;
create table t1 (a int);
insert into t1 values (1);
create view v1 as select * from t1;
grant all on database db_v1 to role_v1;
grant select on view db_v1.v1 to role_v1;
set role role_v1;
use db_v1;
internal error: do not have privilege to execute the statement
select * from v1;
No database selected
drop database db_v1;
drop account acc_view_test;
set global enable_privilege_cache = on;
