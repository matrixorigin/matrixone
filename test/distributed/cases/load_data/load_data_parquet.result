drop database if exists parq;
create database parq;
use parq;
create table t1(id bigint,name varchar);
load data infile {'filepath'='$resources/load_data/simple.parq', 'format'='parquet'} into table t1;
select * from t1;
â¤ id[-5,64,0]  Â¦  name[12,-1,0]  ğ„€
1  Â¦  user1  ğ„€
2  Â¦  user2  ğ„€
7  Â¦  user7  ğ„€
8  Â¦  user8  ğ„€
10  Â¦  user10  ğ„€
12  Â¦  user12  ğ„€
15  Â¦  user15  ğ„€
16  Â¦  user16
create table t2(id bigint not null, name varchar not null, sex bool, f32 float(5,2));
load data infile {'filepath'='$resources/load_data/simple2.parq', 'format'='parquet'} into table t2;
select * from t2;
â¤ id[-5,64,0]  Â¦  name[12,-1,0]  Â¦  sex[-7,1,0]  Â¦  f32[7,5,2]  ğ„€
1  Â¦  user1  Â¦  0  Â¦  1.0  ğ„€
2  Â¦  user2  Â¦  0  Â¦  null  ğ„€
7  Â¦  user7  Â¦  0  Â¦  7.0  ğ„€
8  Â¦  user8  Â¦  1  Â¦  null  ğ„€
10  Â¦  user10  Â¦  0  Â¦  10.0  ğ„€
12  Â¦  user12  Â¦  0  Â¦  null  ğ„€
15  Â¦  user15  Â¦  0  Â¦  null  ğ„€
16  Â¦  user16  Â¦  1  Â¦  null
create table t3(c varchar);
load data infile {'filepath'='$resources/load_data/indexed_str.parq', 'format'='parquet'} into table t3;
select * from t3;
â¤ c[12,-1,0]  ğ„€
null  ğ„€
aa  ğ„€
null  ğ„€
bb  ğ„€
aa  ğ„€
789$&@789$&@789$&@789$&@789$&@789$&@789$&@789$&@789$&@789$&@  ğ„€
789$&@789$&@789$&@789$&@789$&@789$&@789$&@789$&@789$&@789$&@  ğ„€
aa  ğ„€
bb  ğ„€
xyzABCxyzABCxyzABCxyzABCxyzABCxyzABCxyzABCxyzABCxyzABCxyzABC  ğ„€
null  ğ„€
null  ğ„€
xyzABCxyzABCxyzABCxyzABCxyzABCxyzABCxyzABCxyzABCxyzABCxyzABC
create table t4(id bigint not null, name varchar not null, sex bool, f32 float(5,2));
create stage parqstage URL='file:///$resources/load_data/';
load data infile {'filepath'='stage://parqstage/simple2.parq', 'format'='parquet'} into table t4;
select * from t4;
â¤ id[-5,64,0]  Â¦  name[12,-1,0]  Â¦  sex[-7,1,0]  Â¦  f32[7,5,2]  ğ„€
1  Â¦  user1  Â¦  0  Â¦  1.0  ğ„€
2  Â¦  user2  Â¦  0  Â¦  null  ğ„€
7  Â¦  user7  Â¦  0  Â¦  7.0  ğ„€
8  Â¦  user8  Â¦  1  Â¦  null  ğ„€
10  Â¦  user10  Â¦  0  Â¦  10.0  ğ„€
12  Â¦  user12  Â¦  0  Â¦  null  ğ„€
15  Â¦  user15  Â¦  0  Â¦  null  ğ„€
16  Â¦  user16  Â¦  1  Â¦  null
drop stage parqstage;
create table t5(id bigint, name varchar, int8column tinyint, int16column smallint, binarycolumn binary, varbinarycolumn varbinary(32), blobcolumn blob);
load data infile {'filepath'='$resources/load_data/int8_int16_binary_varbinary_blob.parq', 'format'='parquet'} into table t5;
select * from t5;
â¤ id[-5,64,0]  Â¦  name[12,-1,0]  Â¦  int8column[-6,8,0]  Â¦  int16column[5,16,0]  Â¦  binarycolumn[12,3,0]  Â¦  varbinarycolumn[12,96,0]  Â¦  blobcolumn[12,0,0]  ğ„€
1  Â¦  Alice  Â¦  1  Â¦  100  Â¦  binary1  Â¦  varbinary1  Â¦  blob1  ğ„€
2  Â¦  Bob  Â¦  2  Â¦  200  Â¦  binary2  Â¦  varbinary2  Â¦  blob2  ğ„€
3  Â¦  Charlie  Â¦  3  Â¦  300  Â¦  binary3  Â¦  varbinary3  Â¦  blob3  ğ„€
4  Â¦  Diana  Â¦  4  Â¦  400  Â¦  binary4  Â¦  varbinary4  Â¦  blob4  ğ„€
5  Â¦  Eve  Â¦  5  Â¦  500  Â¦  binary5  Â¦  varbinary5  Â¦  blob5
create table t6(id int, name varchar(100), scores text, address text, metadata text);
load data infile {'filepath'='$resources/load_data/nested_types.parq', 'format'='parquet'} into table t6;
select * from t6;
â¤ id[4,32,0]  Â¦  name[12,-1,0]  Â¦  scores[12,0,0]  Â¦  address[12,0,0]  Â¦  metadata[12,0,0]  ğ„€
1  Â¦  Alice  Â¦  [85, 90, 78]  Â¦  {"city": "Beijing", "zip": "100000"}  Â¦  {"key1": "value1", "key2": "value2"}  ğ„€
2  Â¦  Bob  Â¦  [92, 88]  Â¦  {"city": "Shanghai", "zip": "200000"}  Â¦  {"a": "b"}  ğ„€
3  Â¦  Charlie  Â¦  [76, 85, 90, 95]  Â¦  {"city": "Guangzhou", "zip": "510000"}  Â¦  {"m": "n", "x": "y", "z": "w"}
create table t7(id int, name varchar(100), scores json, address json, metadata json);
load data infile {'filepath'='$resources/load_data/nested_types.parq', 'format'='parquet'} into table t7;
select * from t7;
â¤ id[4,32,0]  Â¦  name[12,-1,0]  Â¦  scores[-1,2147483647,0]  Â¦  address[-1,2147483647,0]  Â¦  metadata[-1,2147483647,0]  ğ„€
1  Â¦  Alice  Â¦  [85, 90, 78]  Â¦  {"city": "Beijing", "zip": "100000"}  Â¦  {"key1": "value1", "key2": "value2"}  ğ„€
2  Â¦  Bob  Â¦  [92, 88]  Â¦  {"city": "Shanghai", "zip": "200000"}  Â¦  {"a": "b"}  ğ„€
3  Â¦  Charlie  Â¦  [76, 85, 90, 95]  Â¦  {"city": "Guangzhou", "zip": "510000"}  Â¦  {"m": "n", "x": "y", "z": "w"}
create table t8(id int, nested_list json, list_struct json, nested_struct json, map_list json);
load data infile {'filepath'='$resources/load_data/nested_types_deep.parq', 'format'='parquet'} into table t8;
select * from t8;
â¤ id[4,32,0]  Â¦  nested_list[-1,2147483647,0]  Â¦  list_struct[-1,2147483647,0]  Â¦  nested_struct[-1,2147483647,0]  Â¦  map_list[-1,2147483647,0]  ğ„€
1  Â¦  [[1, 2], [3]]  Â¦  [{"x": 10, "y": "a"}, {"x": 20, "y": "b"}]  Â¦  {"inner": {"value": 100}, "outer": "A"}  Â¦  {"nums": [1, 2, 3]}  ğ„€
2  Â¦  [[4, 5, 6]]  Â¦  [{"x": 30, "y": "c"}]  Â¦  {"inner": {"value": 200}, "outer": "B"}  Â¦  {"arr1": [4], "arr2": [5, 6]}
drop table if exists pq_nullable_test;
CREATE TABLE pq_nullable_test (
id BIGINT NOT NULL,
col_nullable_with_null DOUBLE,
col_nullable_no_null VARCHAR(10),
col_not_nullable BIGINT NOT NULL,
col_all_null DOUBLE,
PRIMARY KEY (id)
);
load data infile {'filepath'='$resources/parquet/nullable_test.parquet', 'format'='parquet'} into table pq_nullable_test;
SELECT
COUNT(*) as total_rows,
SUM(CASE WHEN col_nullable_with_null IS NULL THEN 1 ELSE 0 END) as null_count_col1,
SUM(CASE WHEN col_all_null IS NULL THEN 1 ELSE 0 END) as null_count_all_null
FROM pq_nullable_test;
â¤ total_rows[-5,64,0]  Â¦  null_count_col1[-5,64,0]  Â¦  null_count_all_null[-5,64,0]  ğ„€
5  Â¦  2  Â¦  5
SELECT COUNT(*) FROM pq_nullable_test WHERE col_not_nullable IS NULL;
â¤ COUNT(*)[-5,64,0]  ğ„€
0
SELECT * FROM pq_nullable_test ORDER BY id;
â¤ id[-5,64,0]  Â¦  col_nullable_with_null[8,54,0]  Â¦  col_nullable_no_null[12,-1,0]  Â¦  col_not_nullable[-5,64,0]  Â¦  col_all_null[8,54,0]  ğ„€
1  Â¦  10.5  Â¦  A  Â¦  100  Â¦  null  ğ„€
2  Â¦  null  Â¦  B  Â¦  200  Â¦  null  ğ„€
3  Â¦  30.2  Â¦  C  Â¦  300  Â¦  null  ğ„€
4  Â¦  null  Â¦  D  Â¦  400  Â¦  null  ğ„€
5  Â¦  50.1  Â¦  E  Â¦  500  Â¦  null
drop table pq_nullable_test;
drop table if exists parquet_complex_types;
CREATE TABLE `parquet_complex_types` (
`test_id` bigint NOT NULL,
`decimal_small` decimal(10,2) NOT NULL DEFAULT 0.0,
`decimal_medium` decimal(18,4) NOT NULL DEFAULT 0.0,
`decimal_large` decimal(38,6) NOT NULL DEFAULT 0.0,
`timestamp_utc` timestamp NOT NULL DEFAULT '1970-01-01 00:00:00',
`timestamp_micros` timestamp(6) NOT NULL DEFAULT '1970-01-01 00:00:00',
`timestamp_millis` timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00',
`map_string_int` json DEFAULT NULL,
`map_string_string` json DEFAULT NULL,
`struct_simple` json DEFAULT NULL,
`struct_nested` json DEFAULT NULL,
`list_int` json DEFAULT NULL,
`list_string` json DEFAULT NULL,
`list_struct` json DEFAULT NULL
);
load data infile {'filepath'='$resources/parquet/complex.parquet', 'format'='parquet'} into table parquet_complex_types;
select * from parquet_complex_types order by test_id limit 3;
â¤ test_id[-5,64,0]  Â¦  decimal_small[3,10,2]  Â¦  decimal_medium[3,18,4]  Â¦  decimal_large[3,38,6]  Â¦  timestamp_utc[93,64,0]  Â¦  timestamp_micros[93,64,0]  Â¦  timestamp_millis[93,64,0]  Â¦  map_string_int[-1,2147483647,0]  Â¦  map_string_string[-1,2147483647,0]  Â¦  struct_simple[-1,2147483647,0]  Â¦  struct_nested[-1,2147483647,0]  Â¦  list_int[-1,2147483647,0]  Â¦  list_string[-1,2147483647,0]  Â¦  list_struct[-1,2147483647,0]  ğ„€
0  Â¦  -84956395.77  Â¦  48549239237439.8438  Â¦  -3657605477313590430068499283968.000000  Â¦  2022-07-24 22:35:36  Â¦  2023-12-14 02:32:17.360544000  Â¦  2023-09-11 10:26:10.731000000  Â¦  {"key_0": 469}  Â¦  {"key_0": "value_844", "key_1": "value_15"}  Â¦  {"age": 74, "name": "user_1305"}  Â¦  {"user": {"name": "user_4084", "profile": {"city": "Guangzhou", "country": "China"}}}  Â¦  [114, 625, 391, 582, 144, 912, 593]  Â¦  ["item_858", "item_97", "item_4", "item_211", "item_726", "item_406"]  Â¦  [{"id": 0, "name": "item_0"}, {"id": 1, "name": "item_1"}, {"id": 2, "name": "item_2"}, {"id": 3, "name": "item_3"}, {"id": 4, "name": "item_4"}]  ğ„€
1  Â¦  5912648.53  Â¦  -94462690481611.3281  Â¦  2937746366852315562009560088576.000000  Â¦  2023-12-02 10:34:01  Â¦  2022-03-13 09:41:19.637821000  Â¦  2023-12-23 02:27:03.641000000  Â¦  {"key_0": 889, "key_1": 817, "key_2": 386}  Â¦  {"key_0": "value_100", "key_1": "value_307", "key_2": "value_134", "key_3": "value_133"}  Â¦  {"age": 34, "name": "user_9994"}  Â¦  {"user": {"name": "user_5901", "profile": {"city": "Guangzhou", "country": "China"}}}  Â¦  [437]  Â¦  ["item_642", "item_911", "item_778"]  Â¦  [{"id": 0, "name": "item_0"}, {"id": 1, "name": "item_1"}, {"id": 2, "name": "item_2"}, {"id": 3, "name": "item_3"}, {"id": 4, "name": "item_4"}]  ğ„€
2  Â¦  -1488207.76  Â¦  54995689092595.9688  Â¦  5839644290979080503870820974592.000000  Â¦  2022-04-29 11:19:37  Â¦  2020-09-23 11:59:34.427134000  Â¦  2022-08-10 19:33:01.333000000  Â¦  {"key_0": 262}  Â¦  {"key_0": "value_363", "key_1": "value_769", "key_2": "value_931", "key_3": "value_216", "key_4": "value_514"}  Â¦  {"age": 69, "name": "user_2212"}  Â¦  {"user": {"name": "user_6646", "profile": {"city": "Guangzhou", "country": "China"}}}  Â¦  [271, 499, 705, 309, 964, 921, 734]  Â¦  ["item_145", "item_396", "item_985"]  Â¦  [{"id": 0, "name": "item_0"}, {"id": 1, "name": "item_1"}, {"id": 2, "name": "item_2"}, {"id": 3, "name": "item_3"}, {"id": 4, "name": "item_4"}]
SELECT COUNT(*) FROM parquet_complex_types;
â¤ COUNT(*)[-5,64,0]  ğ„€
1000
drop table parquet_complex_types;
drop table if exists ts_test;
CREATE TABLE ts_test (
id BIGINT,
ts_no_tz_micros DATETIME,
ts_no_tz_millis DATETIME
);
load data infile {'filepath'='$resources/parquet/ts_no_tz_test.parquet', 'format'='parquet'} into table ts_test;
select * from ts_test;
â¤ id[-5,64,0]  Â¦  ts_no_tz_micros[93,64,0]  Â¦  ts_no_tz_millis[93,64,0]  ğ„€
1  Â¦  2023-10-27 10:00:00  Â¦  2025-12-25 08:30:00  ğ„€
2  Â¦  1960-01-01 12:00:00  Â¦  2000-01-01 00:00:00  ğ„€
3  Â¦  null  Â¦  2023-12-31 23:59:59
drop table ts_test;
drop table if exists none_compression;
CREATE TABLE none_compression (
id BIGINT,
name VARCHAR(100),
value DOUBLE,
status BOOL
);
load data infile {'filepath'='$resources/parquet/test_none.parquet', 'format'='parquet'} into table none_compression;
SELECT 'NONE' as codec, COUNT(*), SUM(value) FROM none_compression;
â¤ codec[12,-1,0]  Â¦  COUNT(*)[-5,64,0]  Â¦  SUM(value)[8,54,0]  ğ„€
NONE  Â¦  9  Â¦  55.35
drop table if exists snappy_compression;
CREATE TABLE snappy_compression (
id BIGINT,
name VARCHAR(100),
value DOUBLE,
status BOOL
);
load data infile {'filepath'='$resources/parquet/test_snappy.parquet', 'format'='parquet'} into table snappy_compression;
SELECT 'NONE' as codec, COUNT(*), SUM(value) FROM snappy_compression;
â¤ codec[12,-1,0]  Â¦  COUNT(*)[-5,64,0]  Â¦  SUM(value)[8,54,0]  ğ„€
NONE  Â¦  9  Â¦  55.35
drop table if exists gzip_compression;
CREATE TABLE gzip_compression (
id BIGINT,
name VARCHAR(100),
value DOUBLE,
status BOOL
);
load data infile {'filepath'='$resources/parquet/test_gzip.parquet', 'format'='parquet'} into table gzip_compression;
SELECT 'NONE' as codec, COUNT(*), SUM(value) FROM gzip_compression;
â¤ codec[12,-1,0]  Â¦  COUNT(*)[-5,64,0]  Â¦  SUM(value)[8,54,0]  ğ„€
NONE  Â¦  9  Â¦  55.35
drop table if exists lz4_compression;
CREATE TABLE lz4_compression (
id BIGINT,
name VARCHAR(100),
value DOUBLE,
status BOOL
);
load data infile {'filepath'='$resources/parquet/test_lz4.parquet', 'format'='parquet'} into table lz4_compression;
SELECT 'NONE' as codec, COUNT(*), SUM(value) FROM lz4_compression;
â¤ codec[12,-1,0]  Â¦  COUNT(*)[-5,64,0]  Â¦  SUM(value)[8,54,0]  ğ„€
NONE  Â¦  9  Â¦  55.35
drop table if exists zstd_compression;
CREATE TABLE zstd_compression (
id BIGINT,
name VARCHAR(100),
value DOUBLE,
status BOOL
);
load data infile {'filepath'='$resources/parquet/test_zstd.parquet', 'format'='parquet'} into table zstd_compression;
SELECT 'NONE' as codec, COUNT(*), SUM(value) FROM zstd_compression;
â¤ codec[12,-1,0]  Â¦  COUNT(*)[-5,64,0]  Â¦  SUM(value)[8,54,0]  ğ„€
NONE  Â¦  9  Â¦  55.35
drop table if exists brotli_compression;
CREATE TABLE brotli_compression (
id BIGINT,
name VARCHAR(100),
value DOUBLE,
status BOOL
);
load data infile {'filepath'='$resources/parquet/test_brotli.parquet', 'format'='parquet'} into table brotli_compression;
select 'NONE' as codec, count(*), sum(value) from brotli_compression;
â¤ codec[12,-1,0]  Â¦  count(*)[-5,64,0]  Â¦  sum(value)[8,54,0]  ğ„€
NONE  Â¦  9  Â¦  55.35
drop table if exists pq_version_compare;
CREATE TABLE `pq_version_compare` (
`id` bigint DEFAULT NULL,
`user_name` varchar(50) DEFAULT NULL,
`login_time` timestamp NULL DEFAULT NULL
);
load data infile {'filepath'='$resources/parquet/test_v1_legacy.parquet', 'format'='parquet'} into table pq_version_compare;
select * from pq_version_compare;
â¤ id[-5,64,0]  Â¦  user_name[12,-1,0]  Â¦  login_time[93,64,0]  ğ„€
1  Â¦  Alpha  Â¦  2023-01-01 10:00:00  ğ„€
2  Â¦  Beta  Â¦  2023-05-20 15:30:00  ğ„€
3  Â¦  Gamma  Â¦  2024-01-01 00:00:00
truncate table pq_version_compare;
load data infile {'filepath'='$resources/parquet/test_v2_modern.parquet', 'format'='parquet'} into table pq_version_compare;
select * from pq_version_compare;
â¤ id[-5,64,0]  Â¦  user_name[12,-1,0]  Â¦  login_time[93,64,0]  ğ„€
1  Â¦  Alpha  Â¦  2023-01-01 10:00:00  ğ„€
2  Â¦  Beta  Â¦  2023-05-20 15:30:00  ğ„€
3  Â¦  Gamma  Â¦  2024-01-01 00:00:00
drop table if exists pq_stats_check;
CREATE TABLE pq_stats_check (
id BIGINT,
score DOUBLE
);
load data infile {'filepath'='$resources/parquet/no_stats.parquet', 'format'='parquet'} into table pq_stats_check;
select * from pq_stats_check;
â¤ id[-5,64,0]  Â¦  score[8,54,0]  ğ„€
10  Â¦  85.5  ğ„€
20  Â¦  92.0  ğ„€
30  Â¦  78.5  ğ„€
40  Â¦  88.0  ğ„€
50  Â¦  95.5
select 'no_stats' as source, count(*), MIN(id), MAX(score) from pq_stats_check;
â¤ source[12,-1,0]  Â¦  count(*)[-5,64,0]  Â¦  MIN(id)[-5,64,0]  Â¦  MAX(score)[8,54,0]  ğ„€
no_stats  Â¦  5  Â¦  10  Â¦  95.5
truncate pq_stats_check;
load data infile {'filepath'='$resources/parquet/with_stats.parquet', 'format'='parquet'} into table pq_stats_check;
select * from pq_stats_check;
â¤ id[-5,64,0]  Â¦  score[8,54,0]  ğ„€
10  Â¦  85.5  ğ„€
20  Â¦  92.0  ğ„€
30  Â¦  78.5  ğ„€
40  Â¦  88.0  ğ„€
50  Â¦  95.5
select 'no_stats' as source, count(*), MIN(id), MAX(score) from pq_stats_check;
â¤ source[12,-1,0]  Â¦  count(*)[-5,64,0]  Â¦  MIN(id)[-5,64,0]  Â¦  MAX(score)[8,54,0]  ğ„€
no_stats  Â¦  5  Â¦  10  Â¦  95.5
drop table if exists empty_table;
create table empty_table(col1 bigint, col2 varchar);
load data infile {'filepath'='$resources/parquet/empty_test.parquet', 'format'='parquet'} into table empty_table;
select * from empty_table;
â¤ col1[-5,64,0]  Â¦  col2[12,-1,0]
drop table if exists empty_table01;
create table empty_table01(id bigint, name varchar);
load data infile {'filepath'='$resources/parquet/empty_test.parquet', 'format'='parquet'} into table empty_table01;
select * from empty_table;
â¤ col1[-5,64,0]  Â¦  col2[12,-1,0]
drop table if exists empty_table02;
create table empty_table02(col1 int);
load data infile {'filepath'='$resources/parquet/empty_test.parquet', 'format'='parquet'} into table empty_table02;
invalid input: column count mismatch: parquet file has 2 columns, but table has 1 columns
select * from empty_table02;
â¤ col1[4,32,0]
drop table if exists wide_100_columns;
CREATE TABLE wide_100_columns (
col_0 BIGINT, col_1 DOUBLE, col_2 BIGINT, col_3 DOUBLE, col_4 BIGINT,
col_5 DOUBLE, col_6 BIGINT, col_7 DOUBLE, col_8 BIGINT, col_9 DOUBLE,
col_10 BIGINT, col_11 DOUBLE, col_12 BIGINT, col_13 DOUBLE, col_14 BIGINT,
col_15 DOUBLE, col_16 BIGINT, col_17 DOUBLE, col_18 BIGINT, col_19 DOUBLE,
col_20 BIGINT, col_21 DOUBLE, col_22 BIGINT, col_23 DOUBLE, col_24 BIGINT,
col_25 DOUBLE, col_26 BIGINT, col_27 DOUBLE, col_28 BIGINT, col_29 DOUBLE,
col_30 BIGINT, col_31 DOUBLE, col_32 BIGINT, col_33 DOUBLE, col_34 BIGINT,
col_35 DOUBLE, col_36 BIGINT, col_37 DOUBLE, col_38 BIGINT, col_39 DOUBLE,
col_40 BIGINT, col_41 DOUBLE, col_42 BIGINT, col_43 DOUBLE, col_44 BIGINT,
col_45 DOUBLE, col_46 BIGINT, col_47 DOUBLE, col_48 BIGINT, col_49 DOUBLE,
col_50 BIGINT, col_51 DOUBLE, col_52 BIGINT, col_53 DOUBLE, col_54 BIGINT,
col_55 DOUBLE, col_56 BIGINT, col_57 DOUBLE, col_58 BIGINT, col_59 DOUBLE,
col_60 BIGINT, col_61 DOUBLE, col_62 BIGINT, col_63 DOUBLE, col_64 BIGINT,
col_65 DOUBLE, col_66 BIGINT, col_67 DOUBLE, col_68 BIGINT, col_69 DOUBLE,
col_70 BIGINT, col_71 DOUBLE, col_72 BIGINT, col_73 DOUBLE, col_74 BIGINT,
col_75 DOUBLE, col_76 BIGINT, col_77 DOUBLE, col_78 BIGINT, col_79 DOUBLE,
col_80 BIGINT, col_81 DOUBLE, col_82 BIGINT, col_83 DOUBLE, col_84 BIGINT,
col_85 DOUBLE, col_86 BIGINT, col_87 DOUBLE, col_88 BIGINT, col_89 DOUBLE,
col_90 BIGINT, col_91 DOUBLE, col_92 BIGINT, col_93 DOUBLE, col_94 BIGINT,
col_95 DOUBLE, col_96 BIGINT, col_97 DOUBLE, col_98 BIGINT, col_99 DOUBLE
);
load data infile {'filepath'='$resources/parquet/wide_table_100.parquet', 'format'='parquet'} into table wide_100_columns;
select count(*) from wide_100_columns;
â¤ count(*)[-5,64,0]  ğ„€
10
select max(col_99) from wide_100_columns;
â¤ max(col_99)[8,54,0]  ğ„€
65.09616047354105
select col_0, col_50, col_99 from wide_100_columns LIMIT 5;
â¤ col_0[-5,64,0]  Â¦  col_50[-5,64,0]  Â¦  col_99[8,54,0]  ğ„€
8532  Â¦  6030  Â¦  1.9133920123024617  ğ„€
6843  Â¦  5056  Â¦  41.18178009514648  ğ„€
6330  Â¦  5820  Â¦  24.09602999503998  ğ„€
8321  Â¦  8116  Â¦  57.81033963088119  ğ„€
9724  Â¦  9055  Â¦  42.0138364779882
drop table if exists pq_supported_types;
CREATE TABLE pq_supported_types (
int32_col INT,
int64_col BIGINT,
uint32_col INT UNSIGNED,
float32_col FLOAT,
float64_col DOUBLE,
string_col VARCHAR(255),
bool_col BOOL,
date_col DATE,
time_col TIME,
ts_col TIMESTAMP
);
load data infile {'filepath'='$resources/parquet/supported_types.parquet', 'format'='parquet'} into table pq_supported_types;
select int32_col,int64_col,uint32_col,float32_col,float64_col,string_col,bool_col,date_col,time_col from pq_supported_types;
â¤ int32_col[4,32,0]  Â¦  int64_col[-5,64,0]  Â¦  uint32_col[4,32,0]  Â¦  float32_col[7,24,0]  Â¦  float64_col[8,54,0]  Â¦  string_col[12,-1,0]  Â¦  bool_col[-7,1,0]  Â¦  date_col[91,64,0]  Â¦  time_col[92,64,0]  ğ„€
1  Â¦  10000000000  Â¦  4000000000  Â¦  1.1  Â¦  1.111111111  Â¦  Matrix  Â¦  1  Â¦  2023-01-01  Â¦  10:00:00  ğ„€
2  Â¦  20000000000  Â¦  4100000000  Â¦  2.2  Â¦  2.222222222  Â¦  Origin  Â¦  0  Â¦  2024-05-20  Â¦  15:30:45  ğ„€
3  Â¦  30000000000  Â¦  4200000000  Â¦  3.3  Â¦  3.333333333  Â¦  One  Â¦  1  Â¦  2025-12-31  Â¦  23:59:59
select count(*) from pq_supported_types;
â¤ count(*)[-5,64,0]  ğ„€
3
drop table if exists pq_new_types;
create table pq_new_types (
col_int8 TINYINT,
col_int16 SMALLINT,
col_large_string TEXT,
col_ts_no_tz DATETIME,
col_binary BLOB,
col_decimal DECIMAL(18, 3)
);
load data infile {'filepath'='$resources/parquet/new_supported_types.parquet', 'format'='parquet'} into table pq_new_types;
select count(*) from pq_new_types;
â¤ count(*)[-5,64,0]  ğ„€
3
select * from pq_new_types;
â¤ col_int8[-6,8,0]  Â¦  col_int16[5,16,0]  Â¦  col_large_string[12,0,0]  Â¦  col_ts_no_tz[93,64,0]  Â¦  col_binary[12,0,0]  Â¦  col_decimal[3,18,3]  ğ„€
127  Â¦  32767  Â¦  Short string  Â¦  2023-01-01 12:00:00  Â¦    Â¦  123.456  ğ„€
-128  Â¦  -32768  Â¦  AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA  Â¦  2024-05-20 15:30:45  Â¦  hello  Â¦  -0.001  ğ„€
0  Â¦  100  Â¦  MatrixOrigin  Â¦  2025-12-31 23:59:59  Â¦  Ã¿Ã¾Ã½  Â¦  999999.999
select length(col_binary) from pq_new_types;
â¤ length(col_binary)[-5,64,0]  ğ„€
3  ğ„€
5  ğ„€
3
select col_ts_no_tz from pq_new_types;
â¤ col_ts_no_tz[93,64,0]  ğ„€
2023-01-01 12:00:00  ğ„€
2024-05-20 15:30:45  ğ„€
2025-12-31 23:59:59
drop table if exists subtask_test;
create table subtask_test (
c_int8 TINYINT,
c_int16 SMALLINT,
c_binary BLOB,
c_decimal DECIMAL(12, 4),
c_large_str TEXT
);
load data infile {'filepath'='$resources/parquet/subtask_22691_test.parquet', 'format'='parquet'} into table subtask_test;
select * from subtask_test;
â¤ c_int8[-6,8,0]  Â¦  c_int16[5,16,0]  Â¦  c_binary[12,0,0]  Â¦  c_decimal[3,12,4]  Â¦  c_large_str[12,0,0]  ğ„€
1  Â¦  1000  Â¦   Ã¿   Â¦  123.4567  Â¦  hello  ğ„€
-128  Â¦  -32768  Â¦  matrixone  Â¦  -1.0000  Â¦  worldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworldworld  ğ„€
127  Â¦  32767  Â¦  parquet  Â¦  999999.9999  Â¦  large_string_test
drop table if exists pq_decimal_boundary;
create table pq_decimal_boundary (
dec_p9_s2 DECIMAL(9, 2),
dec_p18_s9 DECIMAL(18, 9),
dec_p38_s0 DECIMAL(38, 0),
dec_p38_s38 DECIMAL(38, 38)
);
load data infile {'filepath'='$resources/parquet/decimal_boundary_test.parquet', 'format'='parquet'} into table pq_decimal_boundary;
select * from pq_decimal_boundary;
â¤ dec_p9_s2[3,9,2]  Â¦  dec_p18_s9[3,18,9]  Â¦  dec_p38_s0[3,39,0]  Â¦  dec_p38_s38[3,38,38]  ğ„€
9999999.99  Â¦  999999999.999999999  Â¦  99999999999999999999999999999999999999  Â¦  1E-38  ğ„€
-9999999.99  Â¦  -999999999.999999999  Â¦  -99999999999999999999999999999999999999  Â¦  -1E-38  ğ„€
0.00  Â¦  1.234567890  Â¦  0  Â¦  null
select dec_p38_s0 from pq_decimal_boundary WHERE dec_p38_s0 > 0;
â¤ dec_p38_s0[3,39,0]  ğ„€
99999999999999999999999999999999999999
select dec_p38_s38 from pq_decimal_boundary WHERE dec_p38_s38 > 0;
â¤ dec_p38_s38[3,38,38]  ğ„€
1E-38
select dec_p9_s2 * 1.1 from pq_decimal_boundary LIMIT 1;
â¤ dec_p9_s2 * 1.1[3,38,3]  ğ„€
10999999.989
drop table if exists pq_binary_test;
create table pq_binary_test (
bin_fixed BINARY(10),
bin_var VARBINARY(255),
bin_blob BLOB,
bin_empty VARBINARY(10)
);
load data infile {'filepath'='$resources/parquet/binary_mapping_test.parquet', 'format'='parquet'} into table pq_binary_test;
select
hex(bin_fixed) as fixed_hex,
hex(bin_var) as var_hex,
hex(bin_blob) as blob_hex
from pq_binary_test;
â¤ fixed_hex[12,-1,0]  Â¦  var_hex[12,-1,0]  Â¦  blob_hex[12,-1,0]  ğ„€
3132333435  Â¦  68656C6C6F20776F726C64  Â¦  FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011FF0011  ğ„€
4142434445  Â¦  6D61747269786F6E65  Â¦  62696E6172795F64617461  ğ„€
464748494A  Â¦  70617271756574  Â¦  null
select length(bin_fixed) from pq_binary_test;
â¤ length(bin_fixed)[-5,64,0]  ğ„€
5  ğ„€
5  ğ„€
5
select count(*) from pq_binary_test where bin_blob is null;
â¤ count(*)[-5,64,0]  ğ„€
1
select length(bin_empty) from pq_binary_test limit 1;
â¤ length(bin_empty)[-5,64,0]  ğ„€
0
drop table if exists parquet_01;
CREATE TABLE `parquet_01` (
`sepal.length` double DEFAULT NULL,
`sepal.width` double DEFAULT NULL,
`petal.length` double DEFAULT NULL,
`petal.width` double DEFAULT NULL,
`variety` varchar(20) DEFAULT NULL
);
load data infile {'filepath'='$resources/parquet/Iris.parquet', 'format'='parquet'} into table parquet_01;
select count(*) from parquet_01;
â¤ count(*)[-5,64,0]  ğ„€
150
drop database parq;
