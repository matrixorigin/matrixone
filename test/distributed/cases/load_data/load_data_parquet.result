drop database if exists parq;
create database parq;
use parq;
create table t1(id bigint,name varchar);
load data infile {'filepath'='$resources/load_data/simple.parq', 'format'='parquet'} into table t1;
select * from t1;
â¤ id[-5,64,0]  Â¦  name[12,-1,0]  ğ„€
15  Â¦  user15  ğ„€
16  Â¦  user16  ğ„€
1  Â¦  user1  ğ„€
2  Â¦  user2  ğ„€
8  Â¦  user8  ğ„€
10  Â¦  user10  ğ„€
12  Â¦  user12  ğ„€
7  Â¦  user7
create table t2(id bigint not null, name varchar not null, sex bool, f32 float(5,2));
load data infile {'filepath'='$resources/load_data/simple2.parq', 'format'='parquet'} into table t2;
select * from t2;
â¤ id[-5,64,0]  Â¦  name[12,-1,0]  Â¦  sex[-7,1,0]  Â¦  f32[7,5,2]  ğ„€
7  Â¦  user7  Â¦  0  Â¦  7.0  ğ„€
1  Â¦  user1  Â¦  0  Â¦  1.0  ğ„€
2  Â¦  user2  Â¦  0  Â¦  null  ğ„€
8  Â¦  user8  Â¦  1  Â¦  null  ğ„€
10  Â¦  user10  Â¦  0  Â¦  10.0  ğ„€
15  Â¦  user15  Â¦  0  Â¦  null  ğ„€
16  Â¦  user16  Â¦  1  Â¦  null  ğ„€
12  Â¦  user12  Â¦  0  Â¦  null
create table t3(c varchar);
load data infile {'filepath'='$resources/load_data/indexed_str.parq', 'format'='parquet'} into table t3;
select * from t3;
â¤ c[12,-1,0]  ğ„€
null  ğ„€
aa  ğ„€
null  ğ„€
bb  ğ„€
aa  ğ„€
789$&@789$&@789$&@789$&@789$&@789$&@789$&@789$&@789$&@789$&@  ğ„€
789$&@789$&@789$&@789$&@789$&@789$&@789$&@789$&@789$&@789$&@  ğ„€
aa  ğ„€
bb  ğ„€
xyzABCxyzABCxyzABCxyzABCxyzABCxyzABCxyzABCxyzABCxyzABCxyzABC  ğ„€
null  ğ„€
null  ğ„€
xyzABCxyzABCxyzABCxyzABCxyzABCxyzABCxyzABCxyzABCxyzABCxyzABC
create table t4(id bigint not null, name varchar not null, sex bool, f32 float(5,2));
create stage parqstage URL='file:///$resources/load_data/';
load data infile {'filepath'='stage://parqstage/simple2.parq', 'format'='parquet'} into table t4;
select * from t4;
â¤ id[-5,64,0]  Â¦  name[12,-1,0]  Â¦  sex[-7,1,0]  Â¦  f32[7,5,2]  ğ„€
8  Â¦  user8  Â¦  1  Â¦  null  ğ„€
10  Â¦  user10  Â¦  0  Â¦  10.0  ğ„€
7  Â¦  user7  Â¦  0  Â¦  7.0  ğ„€
1  Â¦  user1  Â¦  0  Â¦  1.0  ğ„€
2  Â¦  user2  Â¦  0  Â¦  null  ğ„€
12  Â¦  user12  Â¦  0  Â¦  null  ğ„€
15  Â¦  user15  Â¦  0  Â¦  null  ğ„€
16  Â¦  user16  Â¦  1  Â¦  null
drop stage parqstage;
create table t5(id bigint, name varchar, int8column tinyint, int16column smallint, binarycolumn binary, varbinarycolumn varbinary(32), blobcolumn blob);
load data infile {'filepath'='$resources/load_data/int8_int16_binary_varbinary_blob.parq', 'format'='parquet'} into table t5;
select * from t5;
â¤ id[-5,64,0]  Â¦  name[12,-1,0]  Â¦  int8column[-6,8,0]  Â¦  int16column[5,16,0]  Â¦  binarycolumn[12,3,0]  Â¦  varbinarycolumn[12,96,0]  Â¦  blobcolumn[12,0,0]  ğ„€
1  Â¦  Alice  Â¦  1  Â¦  100  Â¦  binary1  Â¦  varbinary1  Â¦  blob1  ğ„€
2  Â¦  Bob  Â¦  2  Â¦  200  Â¦  binary2  Â¦  varbinary2  Â¦  blob2  ğ„€
3  Â¦  Charlie  Â¦  3  Â¦  300  Â¦  binary3  Â¦  varbinary3  Â¦  blob3  ğ„€
4  Â¦  Diana  Â¦  4  Â¦  400  Â¦  binary4  Â¦  varbinary4  Â¦  blob4  ğ„€
5  Â¦  Eve  Â¦  5  Â¦  500  Â¦  binary5  Â¦  varbinary5  Â¦  blob5
create table t6(id int, name varchar(100), scores text, address text, metadata text);
load data infile {'filepath'='$resources/load_data/nested_types.parq', 'format'='parquet'} into table t6;
select * from t6;
â¤ id[4,32,0]  Â¦  name[12,-1,0]  Â¦  scores[12,0,0]  Â¦  address[12,0,0]  Â¦  metadata[12,0,0]  ğ„€
1  Â¦  Alice  Â¦  [85, 90, 78]  Â¦  {"city": "Beijing", "zip": "100000"}  Â¦  {"key1": "value1", "key2": "value2"}  ğ„€
2  Â¦  Bob  Â¦  [92, 88]  Â¦  {"city": "Shanghai", "zip": "200000"}  Â¦  {"a": "b"}  ğ„€
3  Â¦  Charlie  Â¦  [76, 85, 90, 95]  Â¦  {"city": "Guangzhou", "zip": "510000"}  Â¦  {"m": "n", "x": "y", "z": "w"}
create table t7(id int, name varchar(100), scores json, address json, metadata json);
load data infile {'filepath'='$resources/load_data/nested_types.parq', 'format'='parquet'} into table t7;
select * from t7;
â¤ id[4,32,0]  Â¦  name[12,-1,0]  Â¦  scores[-1,2147483647,0]  Â¦  address[-1,2147483647,0]  Â¦  metadata[-1,2147483647,0]  ğ„€
1  Â¦  Alice  Â¦  [85, 90, 78]  Â¦  {"city": "Beijing", "zip": "100000"}  Â¦  {"key1": "value1", "key2": "value2"}  ğ„€
2  Â¦  Bob  Â¦  [92, 88]  Â¦  {"city": "Shanghai", "zip": "200000"}  Â¦  {"a": "b"}  ğ„€
3  Â¦  Charlie  Â¦  [76, 85, 90, 95]  Â¦  {"city": "Guangzhou", "zip": "510000"}  Â¦  {"m": "n", "x": "y", "z": "w"}
drop database parq;
