drop database if exists test_string_to_int;
create database test_string_to_int;
use test_string_to_int;
create table test_string_to_int_all(
int8_col tinyint not null,
int16_col smallint not null,
int32_col int not null,
int64_col bigint not null,
uint8_col tinyint unsigned not null,
uint16_col smallint unsigned not null,
uint32_col int unsigned not null,
uint64_col bigint unsigned not null
);
load data infile {'filepath'='$resources/load_data/string_to_int.parq', 'format'='parquet'}
into table test_string_to_int_all;
select * from test_string_to_int_all order by int32_col;
int8_col    int16_col    int32_col    int64_col    uint8_col    uint16_col    uint32_col    uint64_col
-128    -32768    -2147483648    -9223372036854775808    5    500    5000    50000
-1    -100    -1000    -10000    2    200    2000    20000
0    0    0    0    0    0    0    0
1    100    1000    10000    1    100    1000    10000
127    32767    2147483647    9223372036854775807    255    65535    4294967295    18446744073709551615
select
min(int8_col) as min_int8, max(int8_col) as max_int8,
min(int16_col) as min_int16, max(int16_col) as max_int16,
min(int32_col) as min_int32, max(int32_col) as max_int32,
max(uint8_col) as max_uint8,
max(uint16_col) as max_uint16,
max(uint32_col) as max_uint32
from test_string_to_int_all;
min_int8    max_int8    min_int16    max_int16    min_int32    max_int32    max_uint8    max_uint16    max_uint32
-128    127    -32768    32767    -2147483648    2147483647    255    65535    4294967295
create table test_string_to_int_nulls(
id int not null,
value bigint
);
load data infile {'filepath'='$resources/load_data/string_to_int_nulls.parq', 'format'='parquet'}
into table test_string_to_int_nulls;
select * from test_string_to_int_nulls order by id;
id    value
1    100
2    null
3    -50
4    null
5    200
select count(*) as total, count(value) as non_null, count(*) - count(value) as null_count
from test_string_to_int_nulls;
total    non_null    null_count
5    3    2
create table test_string_to_int_special(
leading_zero int not null,
positive_sign int not null,
leading_space int not null,
trailing_space int not null,
both_spaces int not null,
tab_newline int not null
);
load data infile {'filepath'='$resources/load_data/string_to_int_special.parq', 'format'='parquet'}
into table test_string_to_int_special;
select * from test_string_to_int_special order by leading_zero;
leading_zero    positive_sign    leading_space    trailing_space    both_spaces    tab_newline
0    0    0    0    0    0
1    1    1    1    1    1
123    123    123    123    123    123
create table test_int8_overflow(
test_case varchar(50) not null,
value tinyint not null
);
load data infile {'filepath'='$resources/load_data/string_to_int_overflow.parq', 'format'='parquet'}
into table test_int8_overflow;
internal error: failed to parse '128' as int8: strconv.ParseInt: parsing "128": value out of range
create table test_invalid_format(
test_case varchar(50) not null,
value int not null
);
load data infile {'filepath'='$resources/load_data/string_to_int_invalid.parq', 'format'='parquet'}
into table test_invalid_format;
internal error: failed to parse 'abc' as int32: strconv.ParseInt: parsing "abc": invalid syntax
create table test_only_whitespace(
test_case varchar(50) not null,
value int not null
);
load data infile {'filepath'='$resources/load_data/string_to_int_only_spaces.parq', 'format'='parquet'}
into table test_only_whitespace;
internal error: failed to parse '' as int32: strconv.ParseInt: parsing "": invalid syntax
create table test_scientific_notation(
test_case varchar(50) not null,
value int not null
);
load data infile {'filepath'='$resources/load_data/string_to_int_scientific.parq', 'format'='parquet'}
into table test_scientific_notation;
internal error: failed to parse '1e5' as int32: strconv.ParseInt: parsing "1e5": invalid syntax
create table test_hexadecimal(
test_case varchar(50) not null,
value int not null
);
load data infile {'filepath'='$resources/load_data/string_to_int_hex.parq', 'format'='parquet'}
into table test_hexadecimal;
internal error: failed to parse '0xFF' as int32: strconv.ParseInt: parsing "0xFF": invalid syntax
create table test_very_long_string(
test_case varchar(50) not null,
value bigint not null
);
load data infile {'filepath'='$resources/load_data/string_to_int_very_long.parq', 'format'='parquet'}
into table test_very_long_string;
internal error: failed to parse '9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999' as int64: strconv.ParseInt: parsing "9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999": value out of range
create table test_unicode_digits(
test_case varchar(50) not null,
value int not null
);
load data infile {'filepath'='$resources/load_data/string_to_int_unicode.parq', 'format'='parquet'}
into table test_unicode_digits;
internal error: failed to parse '１２３' as int32: strconv.ParseInt: parsing "１２３": invalid syntax
drop database test_string_to_int;
