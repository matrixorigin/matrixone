drop table if exists t1;
create table t1(
col1 tinyint,
col2 smallint,
col3 int,
col4 bigint,
col5 tinyint unsigned,
col6 smallint unsigned,
col7 int unsigned,
col8 bigint unsigned
);
load data infile '$resources/load_data/integer_numbers_1.csv' into table t1;
select * from t1;
col1    col2    col3    col4    col5    col6    col7    col8
127    32767    2147483647    9223372036854775807    255    65535    4294967295    18446744073709551615
-128    -32768    -2147483648    -9223372036854775808    0    0    0    0
0    0    0    0    0    0    0    0
null    null    null    null    null    null    null    null
1    null    null    0    0    0    null    null
null    null    null    null    null    null    null    null
127    32767    2147483647    9223372036854775807    255    65535    4294967295    18446744073709551615
select * from t1 into outfile '$resources/into_outfile/outfile_integer_numbers_1.csv';
delete from t1;
load data infile '$resources/into_outfile/outfile_integer_numbers_1.csv' into table t1 ignore 1 lines;
select * from t1;
col1    col2    col3    col4    col5    col6    col7    col8
127    32767    2147483647    9223372036854775807    255    65535    4294967295    18446744073709551615
-128    -32768    -2147483648    -9223372036854775808    0    0    0    0
0    0    0    0    0    0    0    0
null    null    null    null    null    null    null    null
1    null    null    0    0    0    null    null
null    null    null    null    null    null    null    null
127    32767    2147483647    9223372036854775807    255    65535    4294967295    18446744073709551615
delete from t1;
load data infile '$resources/load_data/integer_numbers_2.csv' into table t1 fields terminated by'*';
select * from t1;
col1    col2    col3    col4    col5    col6    col7    col8
127    32767    2147483647    9223372036854775807    255    65535    4294967295    18446744073709551615
-128    -32768    -2147483648    -9223372036854775808    0    0    0    0
0    0    0    0    0    0    0    0
null    null    null    null    null    null    null    null
1    null    null    0    0    0    null    null
null    null    null    null    null    null    null    null
127    32767    2147483647    9223372036854775807    255    65535    4294967295    18446744073709551615
delete from t1;
drop table t1;
drop table if exists t2;
create table t2(
col1 char(225),
col2 varchar(225),
col3 text,
col4 varchar(225)
);
load data infile '$resources/load_data/char_varchar_1.csv' into table t2;
select * from t2;
col1    col2    col3    col4
a    b    c    d
a    b    c    d
'a'    'b'    'c'    'd'
'a'    'b'    'c'    'd'
aa,aa    bb,bb    cc,cc    dd,dd
aa,    bb,    cc,    dd,
aa,,,aa    bb,,,bb    cc,,,cc    dd,,,dd
aa',',,aa    bb',',,bb    cc',',,cc    dd',',,dd
aa"aa    bb"bb    cc"cc    dd"dd
aa"aa    bb"bb    cc"cc    dd"dd
aa"aa    bb"bb    cc"cc    dd"dd
aa""aa    bb""bb    cc""cc    dd""dd
aa""aa    bb""bb    cc""cc    dd""dd
aa",aa    bb",bb    cc",cc    dd",dd
aa"",aa    bb"",bb    cc"",cc    dd"",dd
            
            
null    null    null    null
            
"    "    "    "
""    ""    ""    ""
select * from t2 into outfile '$resources/into_outfile/outfile_char_varchar_1.csv';
delete from t2;
load data infile '$resources/into_outfile/outfile_char_varchar_1.csv' into table t2 ignore 1 lines;
select * from t2;
col1    col2    col3    col4
a    b    c    d
a    b    c    d
'a'    'b'    'c'    'd'
'a'    'b'    'c'    'd'
aa,aa    bb,bb    cc,cc    dd,dd
aa,    bb,    cc,    dd,
aa,,,aa    bb,,,bb    cc,,,cc    dd,,,dd
aa',',,aa    bb',',,bb    cc',',,cc    dd',',,dd
aa"aa    bb"bb    cc"cc    dd"dd
aa"aa    bb"bb    cc"cc    dd"dd
aa"aa    bb"bb    cc"cc    dd"dd
aa""aa    bb""bb    cc""cc    dd""dd
aa""aa    bb""bb    cc""cc    dd""dd
aa",aa    bb",bb    cc",cc    dd",dd
aa"",aa    bb"",bb    cc"",cc    dd"",dd
            
            
null    null    null    null
            
"    "    "    "
""    ""    ""    ""
delete from t2;
load data infile '$resources/load_data/char_varchar_2.csv' into table t2;
select * from t2;
col1    col2    col3    col4
aa""aa    bb""bb    cc""cc    dd""dd
aa"aa    bb"bb    cc"cc    dd"dd
aa"""aa    bb"""bb    cc"""cc    dd"""dd
aa""aa    bb""bb    cc""cc    dd""dd
aa""""aa    bb""""bb    cc""""cc    dd""""dd
aa"""aa    bb""bb    cc""cc    dd""dd
delete from t2;
load data infile '$resources/load_data/char_varchar_3.csv' into table t2;
select * from t2;
col1    col2    col3    col4
aa",aa    bb",bb    cc",cc    dd",dd
aa"    aa"    bb"    bb"
aa"",aa    bb"",bb    cc"",cc    dd"",dd
aa""    aa"    bb"",bb    cc"",cc
delete from t2;
load data infile '$resources/load_data/char_varchar_4.csv' into table t2 fields terminated by'|';
select * from t2;
col1    col2    col3    col4
a    b    c    d
a    b    c    d
'a'    'b'    'c'    'd'
'a'    'b'    'c'    'd'
aa|aa    bb|bb    cc|cc    dd|dd
aa|    bb|    cc|    dd|
aa|||aa    bb|||bb    cc|||cc    dd|||dd
aa'|'||aa    bb'|'||bb    cc'|'||cc    dd'|'||dd
aa"aa    bb"bb    cc"cc    dd"dd
aa"aa    bb"bb    cc"cc    dd"dd
aa"aa    bb"bb    cc"cc    dd"dd
aa""aa    bb""bb    cc""cc    dd""dd
aa""aa    bb""bb    cc""cc    dd""dd
aa"|aa    bb"|bb    cc"|cc    dd"|dd
aa""|aa    bb""|bb    cc""|cc    dd""|dd
            
            
            
"    "    "    "
""    ""    ""    ""
delete from t2;
load data infile '$resources/load_data/char_varchar_5.csv' into table t2 fields terminated by'?';
select * from t2;
col1    col2    col3    col4
a    b    c    d
a    b    c    d
'a'    'b'    'c'    'd'
'a'    'b'    'c'    'd'
aa?aa    bb?bb    cc?cc    dd?dd
aa?    bb?    cc?    dd?
aa???aa    bb???bb    cc???cc    dd???dd
aa'?'??aa    bb'?'??bb    cc'?'??cc    dd'?'??dd
aa"aa    bb"bb    cc"cc    dd"dd
aa"aa    bb"bb    cc"cc    dd"dd
aa"aa    bb"bb    cc"cc    dd"dd
aa""aa    bb""bb    cc""cc    dd""dd
aa""aa    bb""bb    cc""cc    dd""dd
aa"?aa    bb"?bb    cc"?cc    dd"?dd
aa""?aa    bb""?bb    cc""?cc    dd""?dd
            
            
            
"    "    "    "
""    ""    ""    ""
delete from t2;
drop table t2;
drop table if exists t3;
create table t3(
col1 float,
col2 double,
col3 decimal(5,2),
col4 decimal(20,5)
);
insert into t3 values (1.3,1.3,1.3,1.3);
select * from t3;
col1    col2    col3    col4
1.3    1.3    1.30    1.30000
load data infile '$resources/load_data/float_1.csv' into table t3;
select * from t3;
col1    col2    col3    col4
1.3    1.3    1.30    1.30000
1.3    1.3    1.30    1.30000
delete from t3;
load data infile '$resources/load_data/float_2.csv' into table t3;
select * from t3;
col1    col2    col3    col4
1.0    1.0    1.00    1.00000
null    null    null    null
1.23456    1.23456    1.23    1.23456
1.2345679    1.23456789    1.23    1.23457
1.0123457    1.0123456789    1.01    1.01235
1.0E-10    1.0E-10    0.00    0.00000
select * from t3 into outfile '$resources/into_outfile/outfile_float_2.csv';
delete from t3;
load data infile '$resources/into_outfile/outfile_float_2.csv' into table t3 ignore 1 lines;
select * from t3;
col1    col2    col3    col4
1.0    1.0    1.00    1.00000
null    null    null    null
1.23456    1.23456    1.23    1.23456
1.2345679    1.23456789    1.23    1.23457
1.0123457    1.0123456789    1.01    1.01235
1.0E-10    1.0E-10    0.00    0.00000
delete from t3;
load data infile '$resources/load_data/float_3.csv' into table t3;
internal error: the input value '1000.001' is invalid Decimal64 type for column 2
drop table t3;
drop table if exists t4;
create table t4(
col1 date,
col2 datetime,
col3 timestamp,
col4 bool
);
set time_zone = 'SYSTEM';
load data infile '$resources/load_data/time_date_1.csv' into table t4;
select * from t4;
col1    col2    col3    col4
1000-01-01    0001-01-01 00:00:00    1970-01-01 00:00:01    false
9999-12-31    9999-12-31 00:00:00    2038-01-19 00:00:00    true
delete from t4;
load data infile '$resources/load_data/time_date_2.csv' into table t4;
select * from t4;
col1    col2    col3    col4
1000-01-01    0001-01-01 00:00:00    null    false
1000-01-01    0001-01-01 00:00:00    null    false
1000-01-01    0001-01-01 00:00:00    null    false
1000-01-01    0001-01-01 00:00:00    null    false
9999-12-31    9999-12-31 00:00:00    null    true
9999-12-31    9999-12-31 00:00:00    null    true
9999-12-31    9999-12-31 23:59:59    null    true
null    null    null    true
null    null    null    true
null    null    null    false
null    null    null    true
null    null    null    null
null    null    null    null
select * from t4 into outfile '$resources/into_outfile/outfile_time_date_2.csv';
delete from t4;
load data infile '$resources/into_outfile/outfile_time_date_2.csv' into table t4 ignore 1 lines;
select * from t4;
col1    col2    col3    col4
1000-01-01    0001-01-01 00:00:00    null    false
1000-01-01    0001-01-01 00:00:00    null    false
1000-01-01    0001-01-01 00:00:00    null    false
1000-01-01    0001-01-01 00:00:00    null    false
9999-12-31    9999-12-31 00:00:00    null    true
9999-12-31    9999-12-31 00:00:00    null    true
9999-12-31    9999-12-31 23:59:59    null    true
null    null    null    true
null    null    null    true
null    null    null    false
null    null    null    true
null    null    null    null
null    null    null    null
delete from t4;
load data infile '$resources/load_data/time_date_3.csv' into table t4;
delete from t4;
load data infile '$resources/load_data/time_date_4.csv' into table t4 fields terminated by';';
select * from t4;
col1    col2    col3    col4
1000-01-01    0001-01-01 00:00:00    null    false
1000-01-01    0001-01-01 00:00:00    null    false
9999-12-31    9999-12-31 00:00:00    null    true
9999-12-31    9999-12-31 00:00:00    null    true
null    null    null    true
null    null    null    true
null    null    null    false
null    null    null    true
null    null    null    null
null    null    null    null
delete from t4;
load data infile '$resources/load_data/time_date_5.csv' into table t4;
internal error: the input value '9999-12-31 23:59:59.999999' is not Datetime type for column 1
select * from t4;
col1    col2    col3    col4
delete from t4;
drop table t4;
drop table if exists t5;
create table t5(
col1 int auto_increment primary key,
col2 int,
col3 int
);
insert into t5 values (1,1,1);
load data infile '$resources/load_data/auto_increment_1.csv' into table t5;
Duplicate entry '1' for key 'col1'
select * from t5;
col1    col2    col3
1    1    1
drop table t5;
drop table if exists t6;
create table t6(
col1 int auto_increment primary key,
col2 int,
col3 int
);
load data infile '$resources/load_data/auto_increment_2.csv' into table t6;
Duplicate entry '4' for key 'col1'
select * from t6;
col1    col2    col3
load data infile '$resources/load_data/auto_increment_2.csv' into table t6 FIELDS ESCAPED BY '\\';
invalid configuration: load operation do not support EscapedBy field.
load data infile '$resources/load_data/auto_increment_2.csv' into table t6 LINES STARTING BY 'aaa';
invalid configuration: load operation do not support StartingBy field.
drop table t6;
create table t7(
col1 int,
col2 int,
col3 int
);
load data infile '$resources/load_data/auto_increment_2.csv' into table t7 parallel 'true';
select * from t7 order by col1;
col1    col2    col3
1    1    1
2    2    2
3    3    3
4    5    5
4    4    4
drop table t7;
create table t8(a int, b int);
load data infile '$resources/load_data/auto_increment_20.csv' into table t7 set col2=nullif(col2, '1');
invalid input: the file does not exist in load flow
create table t9(a varchar, b varchar, c varchar, d varchar);
load data infile {"filepath"="$resources/load_data/parallel.txt.gz", "compression"="gzip"} into table t9 FIELDS TERMINATED BY '|' OPTIONALLY ENCLOSED BY '"' LINES TERMINATED BY '\n';
select * from t9;
a    b    c    d
1    155190    7706    1
1    67310    7311    2
1    63700    3701    3
1    2132    4633    4
1    24027    1534    5
1    15635    638    6
2    106170    1191    1
3    4297    1798    1
3    19036    6540    2
3    128449    3474    3
load data infile {"filepath"="$resources/load_data/parallel.txt.gz", "compression"="gzip"} into table t9 FIELDS TERMINATED BY '|' OPTIONALLY ENCLOSED BY '"' LINES TERMINATED BY '\n' parallel 'true';
select * from t9;
a    b    c    d
1    155190    7706    1
1    67310    7311    2
1    63700    3701    3
1    2132    4633    4
1    24027    1534    5
1    15635    638    6
2    106170    1191    1
3    4297    1798    1
3    19036    6540    2
3    128449    3474    3
1    155190    7706    1
1    67310    7311    2
1    63700    3701    3
1    2132    4633    4
1    24027    1534    5
1    15635    638    6
2    106170    1191    1
3    4297    1798    1
3    19036    6540    2
3    128449    3474    3
create account if not exists `abc2` admin_name 'user' identified by '111';
create database if not exists ssb;
use ssb;
create table test_table(
col1 int AUTO_INCREMENT,
col2 float,
col3 bool,
col4 Date,
col5 varchar(255),
col6 text,
PRIMARY KEY (`col1`)
);
load data infile '$resources/load_data/test_1.csv' into table test_table parallel 'true';
select * from test_table;
col1    col2    col3    col4    col5    col6
0    0.1    true    1982-03-24    varchar_0    text_0
1    1.1    false    1982-07-31    varchar_1    text_1
2    2.1    true    2002-04-13    varchar_2    text_2
3    3.1    false    2019-09-29    varchar_3    text_3
4    4.1    true    1996-08-20    varchar_4    text_4
5    5.1    false    2008-10-13    varchar_5    text_5
6    6.1    true    2002-03-05    varchar_6    text_6
7    7.1    false    1993-11-07    varchar_7    text_7
8    8.1    true    1994-01-08    varchar_8    text_8
9    9.1    false    1999-09-17    varchar_9    text_9
10    10.1    true    2003-09-28    varchar_10    text_10
11    11.1    false    1984-01-22    varchar_11    text_11
12    12.1    true    1994-02-10    varchar_12    text_12
13    13.1    false    1994-12-02    varchar_13    text_13
14    14.1    true    2013-01-19    varchar_14    text_14
15    15.1    false    2002-09-29    varchar_15    text_15
16    16.1    true    2001-12-07    varchar_16    text_16
17    17.1    false    1989-03-11    varchar_17    text_17
18    18.1    true    2019-11-04    varchar_18    text_18
19    19.1    false    2002-08-15    varchar_19    text_19
20    20.1    true    1995-12-20    varchar_20    text_20
21    21.1    false    2018-08-03    varchar_21    text_21
22    22.1    true    1998-03-10    varchar_22    text_22
23    23.1    false    2022-04-08    varchar_23    text_23
24    24.1    true    1989-04-27    varchar_24    text_24
25    25.1    false    2009-03-14    varchar_25    text_25
26    26.1    true    2019-03-27    varchar_26    text_26
27    27.1    false    1983-10-28    varchar_27    text_27
28    28.1    true    1993-07-19    varchar_28    text_28
29    29.1    false    1986-09-11    varchar_29    text_29
30    30.1    true    1992-08-19    varchar_30    text_30
31    31.1    false    1981-08-07    varchar_31    text_31
32    32.1    true    1984-03-25    varchar_32    text_32
33    33.1    false    2001-09-05    varchar_33    text_33
34    34.1    true    2022-03-17    varchar_34    text_34
35    35.1    false    2008-06-24    varchar_35    text_35
36    36.1    true    1987-11-23    varchar_36    text_36
37    37.1    false    2008-11-10    varchar_37    text_37
38    38.1    true    1986-01-29    varchar_38    text_38
39    39.1    false    1985-02-27    varchar_39    text_39
40    40.1    true    2016-11-28    varchar_40    text_40
41    41.1    false    1991-02-11    varchar_41    text_41
42    42.1    true    2019-01-08    varchar_42    text_42
43    43.1    false    2009-05-01    varchar_43    text_43
44    44.1    true    1986-11-15    varchar_44    text_44
45    45.1    false    2000-07-22    varchar_45    text_45
46    46.1    true    2002-09-07    varchar_46    text_46
47    47.1    false    1987-09-23    varchar_47    text_47
48    48.1    true    1985-10-25    varchar_48    text_48
49    49.1    false    1988-10-06    varchar_49    text_49
drop table test_table;
drop database ssb;
drop account `abc2`;