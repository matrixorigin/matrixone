drop database if exists test_string_to_datetime;
create database test_string_to_datetime;
use test_string_to_datetime;
create table test_string_to_date(
date_col date not null
);
load data infile {'filepath'='$resources/load_data/string_to_date.parq', 'format'='parquet'}
into table test_string_to_date;
select * from test_string_to_date order by date_col;
â¤ date_col[91,64,0]  ğ„€
1970-01-01  ğ„€
1999-12-25  ğ„€
2000-06-15  ğ„€
2024-01-01  ğ„€
2024-12-31
create table test_string_to_time(
time_col time not null
);
load data infile {'filepath'='$resources/load_data/string_to_time.parq', 'format'='parquet'}
into table test_string_to_time;
select * from test_string_to_time order by time_col;
â¤ time_col[92,64,0]  ğ„€
00:00:00  ğ„€
01:15:30  ğ„€
12:30:45  ğ„€
15:45:00  ğ„€
23:59:59
create table test_string_to_time_scale(
time_col time(6) not null
);
load data infile {'filepath'='$resources/load_data/string_to_time_scale.parq', 'format'='parquet'}
into table test_string_to_time_scale;
select * from test_string_to_time_scale order by time_col;
â¤ time_col[92,64,0]  ğ„€
00:00:00.000001000  ğ„€
01:15:30.500000000  ğ„€
12:30:45.123456000  ğ„€
23:59:59.999999000
create table test_string_to_timestamp(
timestamp_col timestamp not null
);
load data infile {'filepath'='$resources/load_data/string_to_timestamp.parq', 'format'='parquet'}
into table test_string_to_timestamp;
select * from test_string_to_timestamp order by timestamp_col;
â¤ timestamp_col[93,64,0]  ğ„€
1970-01-01 00:00:00  ğ„€
2000-06-15 10:20:30  ğ„€
2024-01-01 12:30:45  ğ„€
2024-12-31 23:59:59
create table test_string_to_timestamp_scale(
timestamp_col timestamp(6) not null
);
load data infile {'filepath'='$resources/load_data/string_to_timestamp_scale.parq', 'format'='parquet'}
into table test_string_to_timestamp_scale;
select * from test_string_to_timestamp_scale order by timestamp_col;
â¤ timestamp_col[93,64,0]  ğ„€
1970-01-01 00:00:00.000001000  ğ„€
2000-06-15 10:20:30.500000000  ğ„€
2024-01-01 12:30:45.123456000  ğ„€
2024-12-31 23:59:59.999999000
create table test_datetime_nulls(
id int not null,
date_val date,
time_val time,
timestamp_val timestamp
);
load data infile {'filepath'='$resources/load_data/string_to_datetime_nulls.parq', 'format'='parquet'}
into table test_datetime_nulls;
select * from test_datetime_nulls order by id;
â¤ id[4,32,0]  Â¦  date_val[91,64,0]  Â¦  time_val[92,64,0]  Â¦  timestamp_val[93,64,0]  ğ„€
1  Â¦  2024-01-01  Â¦  12:30:45  Â¦  2024-01-01 12:30:45  ğ„€
2  Â¦  null  Â¦  null  Â¦  null  ğ„€
3  Â¦  2024-12-31  Â¦  23:59:59  Â¦  2024-12-31 23:59:59  ğ„€
4  Â¦  null  Â¦  12:30:45  Â¦  null
create table test_datetime_special(
date_val date not null,
time_val time not null,
timestamp_val timestamp not null
);
load data infile {'filepath'='$resources/load_data/string_to_datetime_special.parq', 'format'='parquet'}
into table test_datetime_special;
select * from test_datetime_special order by date_val;
â¤ date_val[91,64,0]  Â¦  time_val[92,64,0]  Â¦  timestamp_val[93,64,0]  ğ„€
2024-01-01  Â¦  12:30:45  Â¦  2024-01-01 12:30:45  ğ„€
2024-12-31  Â¦  23:59:59  Â¦  2024-12-31 23:59:59
create table test_datetime_invalid(
test_case varchar(50),
date_val date
);
load data infile {'filepath'='$resources/load_data/string_to_datetime_invalid.parq', 'format'='parquet'}
into table test_datetime_invalid;
internal error: failed to parse '2024-13-45' as DATE: invalid argument parsedate, bad value 2024-13-45
drop database test_string_to_datetime;
