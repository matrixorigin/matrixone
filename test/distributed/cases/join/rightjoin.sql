drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
CREATE TABLE t1 (S1 INT, S2 varchar(10));
CREATE TABLE t2 (S1 INT, S2 varchar(10));
CREATE TABLE t3 (S1 INT, S2 varchar(10));
INSERT INTO t1 VALUES (1,'aaa'),(2,'bbb'),(3,'ccc'),(4,NULL),(5,'eee'),(6,'fff'),(NULL,'aaa'),(9,'bbb'),(10,'ccc'),(11,'ddd'),(12,'abc'),(NULL,NULL);
INSERT INTO t2 VALUES  (11,'aaa'),(12,'bbb'),(13,'ccc'),(14,NULL),(1,'aaa'),(2,'bbb'),(3,'ccc'),(4,'ddd'),(NULL,'abc'),(NULL,NULL);
SELECT * FROM t1 RIGHT JOIN t2 on t1.S1=t2.S1;
SELECT * FROM t1 RIGHT JOIN t2 on t1.S2=t2.S2;
SELECT * FROM t2 RIGHT JOIN t1 on t1.S1=t2.S1;
SELECT * FROM t2 RIGHT JOIN t1 on t1.S2=t2.S2;
SELECT * FROM t3 RIGHT JOIN t1 on t1.S1=t3.S1;
SELECT * FROM t3 RIGHT JOIN t1 on t1.S2=t3.S2;
SELECT * FROM t1 RIGHT JOIN t3 on t1.S1=t3.S1;
SELECT * FROM t1 RIGHT JOIN t3 on t1.S2=t3.S2;

drop table if exists t1;
drop table if exists t2;
drop table if exists t3;
create table t1(a int);
create table t2(a int);
create table t3(a int);
insert into t1 select * from generate_series(1,1000000,1) g;
insert into t2 select * from generate_series(1,2000,1) g;
select count(*) from t1 right join t2 on t1.a=t2.a join t3 on t1.a=t3.a;
select count(*) from t1 right join t2 on t1.a=t2.a join t3 on t1.a=t3.a where t1.a<500000;
select count(*) from t1 right join t2 on t1.a=t2.a join t3 on t1.a=t3.a where t1.a<100000&&t2.a<1500;
select count(*) from t1 right join t2 on t1.a=t2.a join t3 on t1.a=t3.a where t1.a<20000;
select count(*) from t1 right join t2 on t1.a=t2.a join t3 on t1.a=t3.a where t2.a<1200;
drop table t1;
drop table t2;
drop table t3;
