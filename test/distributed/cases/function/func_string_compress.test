# Basic test case from requirements
SELECT UNCOMPRESS(COMPRESS('Hello World')) AS result1;

# Additional test cases
# Basic compression and decompression
SELECT COMPRESS('Hello World') AS compressed;
SELECT UNCOMPRESS(COMPRESS('Hello World')) AS decompressed;

# Empty string
SELECT COMPRESS('') AS empty_compressed;
SELECT UNCOMPRESS(COMPRESS('')) AS empty_decompressed;

# Long strings
SELECT UNCOMPRESS(COMPRESS('This is a very long string that should be compressed effectively')) AS long_string;

# Special characters
SELECT UNCOMPRESS(COMPRESS('Hello@#$%^&*()')) AS special_chars;
SELECT UNCOMPRESS(COMPRESS('MatrixOne数据库')) AS unicode_chars;

# NULL handling
SELECT COMPRESS(NULL) AS null_input;
SELECT UNCOMPRESS(NULL) AS null_compressed;
SELECT UNCOMPRESS('invalid') AS invalid_compressed;

# Table usage
CREATE TABLE t1(plaintext VARCHAR(100));
INSERT INTO t1 VALUES ('Hello'), ('World'), ('MatrixOne');
-- @bvt:issue#23021
SELECT plaintext, COMPRESS(plaintext) AS compressed FROM t1;
-- @bvt:issue
SELECT plaintext, UNCOMPRESS(COMPRESS(plaintext)) AS decompressed FROM t1;
DROP TABLE t1;

# WHERE clause
CREATE TABLE t1(plaintext VARCHAR(100));
INSERT INTO t1 VALUES ('Hello'), ('World'), ('MatrixOne');
SELECT * FROM t1 WHERE UNCOMPRESS(COMPRESS(plaintext)) = 'Hello';
DROP TABLE t1;

# Multiple COMPRESS operations
-- @bvt:issue#23021
SELECT COMPRESS('text1') AS comp1, COMPRESS('text2') AS comp2, COMPRESS('text3') AS comp3;
-- @bvt:issue

# Round-trip test with different data types
SELECT UNCOMPRESS(COMPRESS('12345')) AS numeric_string;
SELECT UNCOMPRESS(COMPRESS('2024-01-01')) AS date_string;

# Test that compressed data is different from original
SELECT COMPRESS('Hello World') != 'Hello World' AS compressed_different;

# Test compression ratio (compressed should be smaller for repetitive data)
SELECT LENGTH(COMPRESS('AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA')) < LENGTH('AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA') AS compression_works;

# UNCOMPRESSED_LENGTH function
SELECT UNCOMPRESSED_LENGTH(COMPRESS('Hello World')) AS result1;
SELECT UNCOMPRESSED_LENGTH(COMPRESS('Hello World')) AS length1;
SELECT LENGTH('Hello World') = UNCOMPRESSED_LENGTH(COMPRESS('Hello World')) AS length_match;

# UNCOMPRESSED_LENGTH with different strings
SELECT UNCOMPRESSED_LENGTH(COMPRESS('')) AS empty_length;
SELECT UNCOMPRESSED_LENGTH(COMPRESS('This is a very long string')) AS long_length;
SELECT UNCOMPRESSED_LENGTH(COMPRESS('MatrixOne数据库')) AS unicode_length;

# UNCOMPRESSED_LENGTH with NULL
SELECT UNCOMPRESSED_LENGTH(NULL) AS null_input;
SELECT UNCOMPRESSED_LENGTH('invalid') AS invalid_compressed;

# UNCOMPRESSED_LENGTH in table
CREATE TABLE t1(plaintext VARCHAR(100));
INSERT INTO t1 VALUES ('Hello'), ('World'), ('MatrixOne');
SELECT plaintext, UNCOMPRESSED_LENGTH(COMPRESS(plaintext)) AS original_length FROM t1;
SELECT plaintext, LENGTH(plaintext) = UNCOMPRESSED_LENGTH(COMPRESS(plaintext)) AS length_correct FROM t1;
DROP TABLE t1;

# RANDOM_BYTES function
-- @ignore:0
SELECT HEX(RANDOM_BYTES(16)) AS result1;

SELECT LENGTH(RANDOM_BYTES(16)) AS length_check;
SELECT LENGTH(RANDOM_BYTES(32)) AS length_32;

# RANDOM_BYTES with different lengths
SELECT LENGTH(RANDOM_BYTES(1)) AS len1;
SELECT LENGTH(RANDOM_BYTES(8)) AS len8;
SELECT LENGTH(RANDOM_BYTES(64)) AS len64;
SELECT LENGTH(RANDOM_BYTES(1024)) AS len1024;

# RANDOM_BYTES with NULL and invalid inputs
SELECT RANDOM_BYTES(NULL) AS null_input;
SELECT RANDOM_BYTES(0) AS zero_length;
SELECT RANDOM_BYTES(-1) AS negative_length;
SELECT RANDOM_BYTES(1025) AS too_large;

# RANDOM_BYTES generates different values
SELECT RANDOM_BYTES(16) != RANDOM_BYTES(16) AS different_values;

# RANDOM_BYTES in table
CREATE TABLE t1(len_val INT);
INSERT INTO t1 VALUES (8), (16), (32);
SELECT len_val, LENGTH(RANDOM_BYTES(len_val)) AS random_length FROM t1;
DROP TABLE t1;

# VALIDATE_PASSWORD_STRENGTH function
SELECT VALIDATE_PASSWORD_STRENGTH('password') AS result1;

# Additional test cases
# Weak passwords
SELECT VALIDATE_PASSWORD_STRENGTH('weak') AS weak;
SELECT VALIDATE_PASSWORD_STRENGTH('abc') AS short;
SELECT VALIDATE_PASSWORD_STRENGTH('') AS empty;

# Medium passwords
SELECT VALIDATE_PASSWORD_STRENGTH('password123') AS medium1;
SELECT VALIDATE_PASSWORD_STRENGTH('Password123') AS medium2;

# Strong passwords
SELECT VALIDATE_PASSWORD_STRENGTH('Password123!') AS strong1;
SELECT VALIDATE_PASSWORD_STRENGTH('MyP@ssw0rd') AS strong2;

# Very strong passwords
SELECT VALIDATE_PASSWORD_STRENGTH('VeryStrongP@ssw0rd123!') AS very_strong;
SELECT VALIDATE_PASSWORD_STRENGTH('N0Tweak$_@123!') AS very_strong2;

# NULL handling
SELECT VALIDATE_PASSWORD_STRENGTH(NULL) AS null_input;

# Table usage
CREATE TABLE t1(password VARCHAR(100));
INSERT INTO t1 VALUES ('weak'), ('Password123'), ('Password123!'), ('VeryStrongP@ssw0rd123!');
SELECT password, VALIDATE_PASSWORD_STRENGTH(password) AS strength FROM t1;
DROP TABLE t1;

# WHERE clause
CREATE TABLE t1(password VARCHAR(100));
INSERT INTO t1 VALUES ('weak'), ('Password123'), ('Password123!'), ('VeryStrongP@ssw0rd123!');
SELECT * FROM t1 WHERE VALIDATE_PASSWORD_STRENGTH(password) >= 50;
DROP TABLE t1;

