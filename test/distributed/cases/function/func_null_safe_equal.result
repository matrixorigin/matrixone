CREATE DATABASE IF NOT EXISTS test_null_safe;
USE test_null_safe;
SELECT 1 <=> 1;
1 <=> 1
1
SELECT 1 <=> 0;
1 <=> 0
0
SELECT 1 <=> NULL;
1 <=> null
0
SELECT NULL <=> 1;
null <=> 1
0
SELECT NULL <=> NULL;
null <=> null
1
SELECT 'a' <=> 'a';
a <=> a
1
SELECT 'a' <=> 'b';
a <=> b
0
SELECT 'a' <=> NULL;
a <=> null
0
SELECT NULL <=> 'a';
null <=> a
0
DROP TABLE IF EXISTS t1;
CREATE TABLE t1 (
id INT,
val INT
);
INSERT INTO t1 VALUES (1, 1), (2, 0), (3, NULL);
SELECT id, val, val <=> 1 AS eq_1, val <=> 0 AS eq_0, val <=> NULL AS eq_null FROM t1 ORDER BY id;
id    val    eq_1    eq_0    eq_null
1    1    1    0    0
2    0    0    1    0
3    null    0    0    1
DROP TABLE IF EXISTS t2;
CREATE TABLE t2 (
id INT,
val VARCHAR(20)
);
INSERT INTO t2 VALUES (1, 'a'), (2, 'b'), (3, NULL);
SELECT id, val, val <=> 'a' AS eq_a, val <=> 'b' AS eq_b, val <=> NULL AS eq_null FROM t2 ORDER BY id;
id    val    eq_a    eq_b    eq_null
1    a    1    0    0
2    b    0    1    0
3    null    0    0    1
DROP TABLE IF EXISTS t_left;
DROP TABLE IF EXISTS t_right;
CREATE TABLE t_left (id INT, val INT);
CREATE TABLE t_right (id INT, val INT);
INSERT INTO t_left VALUES (1, NULL), (2, 0), (3, 10);
INSERT INTO t_right VALUES (1, NULL), (2, 0), (3, 10);
SELECT l.id as lid, l.val as lval, r.id as rid, r.val as rval
FROM t_left l JOIN t_right r ON l.val <=> r.val
ORDER BY l.id, r.id;
lid    lval    rid    rval
1    null    1    null
2    0    2    0
3    10    3    10
DROP TABLE IF EXISTS t_json_left;
DROP TABLE IF EXISTS t_json_right;
CREATE TABLE t_json_left (id INT, j1 JSON, j2 JSON);
CREATE TABLE t_json_right (id INT, j1 JSON, j2 JSON);
INSERT INTO t_json_left VALUES
(1, CAST('{"a":1,"b":{"c":2}}' AS JSON), CAST('[1,2,3]' AS JSON)),
(2, CAST('{"a":1}' AS JSON), CAST('[1,2,3]' AS JSON)),
(3, NULL, CAST('[1,2,3]' AS JSON)),
(4, CAST('{"a":1,"b":{"c":2}}' AS JSON), NULL);
INSERT INTO t_json_right VALUES
(10, CAST('{"a":1,"b":{"c":2}}' AS JSON), CAST('[1,2,3]' AS JSON)),
(20, CAST('{"a":1}' AS JSON), CAST('[1,2,3]' AS JSON)),
(30, NULL, CAST('[1,2,3]' AS JSON)),
(40, CAST('{"a":1,"b":{"c":2}}' AS JSON), NULL);
SELECT l.id AS lid, r.id AS rid
FROM t_json_left l JOIN t_json_right r
ON l.j1 <=> r.j1 AND l.j2 <=> r.j2
ORDER BY l.id, r.id;
lid    rid
1    10
2    20
3    30
4    40
SELECT l.id AS lid, r.id AS rid
FROM t_json_left l JOIN t_json_right r
ON (l.j1, l.j2) <=> (r.j1, r.j2)
ORDER BY l.id, r.id;
lid    rid
1    10
2    20
3    30
4    40
SELECT 1.0 <=> 1;
1.0 <=> 1
1
SELECT 1.0 <=> 1.1;
1.0 <=> 1.1
0
SELECT 1.0 <=> NULL;
1.0 <=> null
0
SELECT 1 <=> '1';
1 <=> 1
1
SELECT '1' <=> 1;
1 <=> 1
1
SELECT CAST(1.10 AS DECIMAL(10,2)) <=> CAST(1.1 AS DECIMAL(10,1)) AS dec_eq_1;
dec_eq_1
1
SELECT CAST(1.10 AS DECIMAL(10,2)) <=> CAST(1.11 AS DECIMAL(10,2)) AS dec_eq_2;
dec_eq_2
0
SELECT CAST(NULL AS DECIMAL(10,2)) <=> CAST(NULL AS DECIMAL(10,2)) AS dec_eq_3;
dec_eq_3
1
SELECT CAST(1.00 AS DECIMAL(10,2)) <=> CAST(NULL AS DECIMAL(10,2)) AS dec_eq_4;
dec_eq_4
0
SELECT CAST('2024-01-01' AS DATE) <=> CAST('2024-01-01' AS DATE) AS date_eq_1;
date_eq_1
1
SELECT CAST('2024-01-01' AS DATE) <=> CAST('2024-01-02' AS DATE) AS date_eq_2;
date_eq_2
0
SELECT CAST('2024-01-01' AS DATE) <=> NULL AS date_eq_3;
date_eq_3
0
SELECT CAST('12:34:56' AS TIME) <=> CAST('12:34:56' AS TIME) AS time_eq_1;
time_eq_1
1
SELECT CAST('12:34:56' AS TIME) <=> CAST('12:34:57' AS TIME) AS time_eq_2;
time_eq_2
0
SELECT CAST('2024-01-01 00:00:00' AS TIMESTAMP) <=> CAST('2024-01-01 00:00:00' AS TIMESTAMP) AS ts_eq_1;
ts_eq_1
1
SELECT CAST('2024-01-01 00:00:00' AS TIMESTAMP) <=> NULL AS ts_eq_2;
ts_eq_2
0
SELECT TRUE <=> TRUE;
true <=> true
1
SELECT TRUE <=> FALSE;
true <=> false
0
SELECT TRUE <=> NULL;
true <=> null
0
SELECT FALSE <=> NULL;
false <=> null
0
SELECT (1, NULL) <=> (1, NULL);
(1, null) <=> (1, null)
1
SELECT (1, 1) <=> (1, NULL);
(1, 1) <=> (1, null)
0
SELECT (1, 2) <=> (1, 3);
(1, 2) <=> (1, 3)
0
SELECT (val <=> NULL) IS NULL FROM t1 ORDER BY id;
(val <=> null) is null
0
0
0
SELECT 1 as result WHERE NULL <=> NULL;
result
1
SELECT 1 as result WHERE 1 <=> NULL;
result
DROP TABLE IF EXISTS t1;
DROP TABLE IF EXISTS t2;
DROP TABLE IF EXISTS t_left;
DROP TABLE IF EXISTS t_right;
DROP TABLE IF EXISTS t_json_left;
DROP TABLE IF EXISTS t_json_right;
DROP DATABASE test_null_safe;
