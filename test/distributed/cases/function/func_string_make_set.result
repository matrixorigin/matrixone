SELECT MAKE_SET(1 | 4, 'hello', 'nice', 'world') AS result1;
result1
hello,world
SELECT MAKE_SET(1 | 4, 'hello', 'nice', 'world') AS make_set_basic;
make_set_basic
hello,world
SELECT MAKE_SET(1, 'hello', 'nice', 'world') AS make_set_first;
make_set_first
hello
SELECT MAKE_SET(2, 'hello', 'nice', 'world') AS make_set_second;
make_set_second
nice
SELECT MAKE_SET(4, 'hello', 'nice', 'world') AS make_set_third;
make_set_third
world
SELECT MAKE_SET(7, 'hello', 'nice', 'world') AS make_set_all;
make_set_all
hello,nice,world
SELECT MAKE_SET(0, 'hello', 'nice', 'world') AS make_set_zero;
make_set_zero

SELECT MAKE_SET(1 | 2, 'a', 'b', 'c') AS make_set_1_2;
make_set_1_2
a,b
SELECT MAKE_SET(1 | 2 | 4, 'a', 'b', 'c') AS make_set_1_2_4;
make_set_1_2_4
a,b,c
SELECT MAKE_SET(8, 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h') AS make_set_eighth;
make_set_eighth
d
SELECT MAKE_SET(1, 'single') AS make_set_single;
make_set_single
single
SELECT MAKE_SET(0, 'single') AS make_set_single_zero;
make_set_single_zero

SELECT MAKE_SET(1 | 4 | 16, 'a', 'b', 'c', 'd', 'e') AS make_set_many;
make_set_many
a,c,e
SELECT MAKE_SET(NULL, 'hello', 'nice', 'world') AS make_set_null_bits;
make_set_null_bits
null
SELECT MAKE_SET(1, NULL, 'nice', 'world') AS make_set_null_str1;
make_set_null_str1

SELECT MAKE_SET(2, 'hello', NULL, 'world') AS make_set_null_str2;
make_set_null_str2

SELECT MAKE_SET(1 | 2, 'hello', NULL, 'world') AS make_set_null_str2_included;
make_set_null_str2_included
hello
SELECT MAKE_SET(CAST(5 AS INT), 'a', 'b', 'c') AS make_set_int;
make_set_int
a,c
SELECT MAKE_SET(CAST(5 AS INT32), 'a', 'b', 'c') AS make_set_int32;
SQL parser error: You have an error in your SQL syntax; check the manual that corresponds to your MatrixOne server version for the right syntax to use. syntax error at line 1 column 31 near " INT32), 'a', 'b', 'c') AS make_set_int32;";
SELECT MAKE_SET(CAST(5 AS BIGINT), 'a', 'b', 'c') AS make_set_bigint;
make_set_bigint
a,c
CREATE TABLE t1(bits INT, s1 VARCHAR(10), s2 VARCHAR(10), s3 VARCHAR(10));
INSERT INTO t1 VALUES (1, 'a', 'b', 'c'), (5, 'x', 'y', 'z'), (7, '1', '2', '3');
SELECT bits, MAKE_SET(bits, s1, s2, s3) AS result FROM t1;
bits    result
1    a
5    x,z
7    1,2,3
DROP TABLE t1;
CREATE TABLE t1(bits INT, s1 VARCHAR(10), s2 VARCHAR(10));
INSERT INTO t1 VALUES (1, 'a', 'b'), (3, 'x', 'y'), (2, '1', '2');
SELECT * FROM t1 WHERE MAKE_SET(bits, s1, s2) LIKE 'a%';
bits    s1    s2
1    a    b
DROP TABLE t1;
SELECT MAKE_SET(1, '') AS make_set_empty_str;
make_set_empty_str

SELECT MAKE_SET(1 | 2, 'a', '') AS make_set_empty_str2;
make_set_empty_str2
a,
SELECT MAKE_SET(1 | 2, '你好', '世界', '测试') AS make_set_unicode;
make_set_unicode
你好,世界
SELECT MAKE_SET(255, 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h') AS make_set_255;
make_set_255
a,b,c,d,e,f,g,h
SELECT MAKE_SET(256, 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i') AS make_set_256;
make_set_256
i
