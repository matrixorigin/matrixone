#Test cases of json_extract from the command line
select json_extract('{"a":1,"b":2,"c":3}','$.a');
select json_extract('{"a":1,"b":2,"c":3}','$.b');
select json_extract('{"a":{"q":[1,2,3]}}','$.a.q[1]');
select json_extract('[{"a":1,"b":2,"c":3},{"a":4,"b":5,"c":6}]','$[1].a');
select json_extract('{"a":{"q":[{"a":1},{"a":2},{"a":3}]}}','$.a.q[1]');
select json_extract('{"a":{"q":[{"a":1},{"a":2},{"a":3}]}}','$.a.q');
select json_extract('[1,2,3]','$[*]');
select json_extract('{"a":[1,2,3,{"b":4}]}','$.a[3].b');
select json_extract('{"a":[1,2,3,{"b":4}]}','$.a[3].c');
select json_extract('{"a":[1,2,3,{"b":4}],"c":5}','$.*');
select json_extract('{"a":[1,2,3,{"a":4}]}','$**.a');
select json_extract('{"a":[1,2,3,{"a":4}]}','$.a[*].a');
select json_extract('{"a":1}','$[0]');
select json_extract('{"a":1}','$[0].a');
select json_extract('{"a":1}','$[0].b');
select json_extract('{"a":1}','$[1]');
select json_extract('{"af": [1, "2", {"aaf": "bb"}],"eab":"888"}','$**.f');
select json_extract('{"a": [1, "2", {"a": "bb"}]}','$**.a');
select  json_extract('{"a":"a1","b":"b1"}','$.**');
select  json_extract('{"a":"a1","b":"b1"}','$**.1');

# Test cases of json_extract from column
drop table if exists t1;
create table t1 (a json,b int);
insert into t1(a,b) values ('{"a":1,"b":2,"c":3}',1);
select json_extract(t1.a,'$.a') from t1 where t1.b=1;
insert into t1(a,b) values ('{"a":4,"b":5,"c":6}',2);
select json_extract(t1.a,'$.b') from t1 where t1.b=2;
select json_extract(t1.a,'$.a') from t1;
insert into t1(a,b) values ('{"a":{"q":[1,2,3]}}',3);
select json_extract(t1.a,'$.a.q[1]') from t1 where t1.b=3;
insert into t1(a,b) values ('[{"a":1,"b":2,"c":3},{"a":4,"b":5,"c":6}]',4);
select json_extract(t1.a,'$[1].a') from t1 where t1.b=4;
insert into t1(a,b) values ('{"a":{"q":[{"a":1},{"a":2},{"a":3}]}}',5);
select json_extract(t1.a,'$.a.q[1]') from t1 where t1.b=5;
select json_extract(t1.a,'$.a.q') from t1 where t1.b=5;
insert into t1(a,b) values ('[1,2,3]',6);
select json_extract(t1.a,'$[*]') from t1 where t1.b=6;
insert into t1(a,b) values ('{"a":[1,2,3,{"b":4}]}',7);
select json_extract(t1.a,'$.a[3].b') from t1 where t1.b=7;
select json_extract(t1.a,'$.a[3].c') from t1 where t1.b=7;
insert into t1(a,b) values ('{"a":[1,2,3,{"b":4}],"c":5}',8);
select json_extract(t1.a,'$.*') from t1 where t1.b=8;
insert into t1(a,b) values ('{"a":[1,2,3,{"a":4}]}',9);
select json_extract(t1.a,'$**.a') from t1 where t1.b=9;
select json_extract(t1.a,'$.a[*].a') from t1 where t1.b=9;
drop table t1;
create table t1 (a json);
insert into t1(a) values ('{"a":1}'),('[1,2]'),('{"xa":1}');
drop table if exists t2;
create table t2 (a varchar(100));
insert into t2 values ('$[0]'),('$.a');
select json_extract(t1.a,t2.a) qqq,t1.a,t2.a from t2, t1;
drop table if exists json_table_1;
create table json_table_1 (j1 json);
insert into json_table_1 values('{"key10": "value1", "key2": "value2"}'),('{"key1": "@#$_%^&*()!@", "123456": "中文mo"}'),('{"芝士面包": "12abc", "123456": "中文mo"}'),('{"": "", "123456": "中文mo"}'),('{"a 1": "b 1", "123456": "中文mo"}'),('{"d1": "2020-10-09", "d2": "2019-08-20 12:30:00"}'),('{"d1": [true,false]}'),('{}');
select json_extract('{"a":"a1","b":"b1"}','$.*') from json_table_1;
create view v1 as select json_extract('{"a":1}','$.a');
desc v1;
select json_extract('{"a":1}',null);
select json_extract(null,'$');
select json_extract(null,null);
select json_extract('{"a":1}',null) from json_table_1;
select json_extract(null,'$') from json_table_1;
select json_extract('[1,2,3]','$[last]');
select json_extract('[1,2,3]','$[last-1]');
select json_extract('[1,2,3]','$[last-2]');
select json_extract('[1,2,3]','$[last-3]');
select json_extract('[1,2,3]','$[0 to 2]');
select json_extract('[1,2,3]','$[0 to last]');
select json_extract('[1,2,3]','$[0 to last-1]');
select json_extract('[1,2,3]','$[last-2 to last]');
select json_extract('[1,2,3]','$[last-1 to last-2]');
select json_extract('[1,2,3]','$[last-8 to last-2]');
select json_extract('[1,2,3]','$[last-2 to last-8]');
select json_extract('[1,2,3]','$[0 to last-8]');

# Test multiple paths
select json_extract('{"a":1,"b":2,"c":3}','$.a','$.b');
select json_extract('{"a":1,"b":2,"c":3}','$.a','$.b','$.c');
select json_extract('{"a":1,"b":2,"c":3}','$.c','$.d');
select json_extract('[0,1,2]', '$[0]', '$[1]');
select json_extract('[0,1,2]', '$[1]', '$[0]');
select json_extract('[0,1,2]', '$[last-1]', '$[0]', '$[2]');

select json_extract('[0,1,2]','$[4]');
select json_extract('[0,1,2]','$[100]');
select json_extract('[0,234,32432,423,5234,11443242,44242342424,23424323]','$[2000]');