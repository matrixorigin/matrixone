SELECT IS_IPV4_COMPAT(INET6_ATON('::10.0.5.9')) AS result1;
result1
1
SELECT IS_IPV4_COMPAT(INET6_ATON('::10.0.5.9')) AS valid_compat1;
valid_compat1
1
SELECT IS_IPV4_COMPAT(INET6_ATON('::192.168.1.1')) AS valid_compat2;
valid_compat2
1
SELECT IS_IPV4_COMPAT(INET6_ATON('::127.0.0.1')) AS valid_compat3;
valid_compat3
1
SELECT IS_IPV4_COMPAT(INET6_ATON('::1.1.1.1')) AS valid_compat4;
valid_compat4
1
SELECT IS_IPV4_COMPAT(INET6_ATON('::1')) AS invalid1;  -- Regular IPv6, not IPv4-compatible
invalid1
1
SELECT IS_IPV4_COMPAT(INET6_ATON('2001:db8::1')) AS invalid2;  -- Regular IPv6
invalid2
0
SELECT IS_IPV4_COMPAT(INET6_ATON('::ffff:192.168.1.1')) AS invalid3;  -- IPv4-mapped, not compatible
invalid3
0
SELECT IS_IPV4_COMPAT(INET6_ATON('::')) AS invalid4;  -- All zeros (0.0.0.0)
invalid4
0
SELECT IS_IPV4_COMPAT(INET6_ATON('2001:0db8:85a3::8a2e:370:7334')) AS invalid5;  -- Regular IPv6
invalid5
0
SELECT IS_IPV4_COMPAT(INET6_ATON('192.168.1.1')) AS invalid6;  -- IPv4 returns 4 bytes, not 16
invalid6
0
SELECT IS_IPV4_COMPAT(NULL) AS null_input;
null_input
null
CREATE TABLE t1(id INT, ip_str VARCHAR(50));
INSERT INTO t1 VALUES (1, '::10.0.5.9');
INSERT INTO t1 VALUES (2, '::192.168.1.1');
INSERT INTO t1 VALUES (3, '::1');
INSERT INTO t1 VALUES (4, '::ffff:192.168.1.1');
INSERT INTO t1 VALUES (5, '2001:db8::1');
INSERT INTO t1 VALUES (6, NULL);
SELECT id, ip_str, IS_IPV4_COMPAT(INET6_ATON(ip_str)) AS is_compat FROM t1;
id    ip_str    is_compat
1    ::10.0.5.9    1
2    ::192.168.1.1    1
3    ::1    1
4    ::ffff:192.168.1.1    0
5    2001:db8::1    0
6    null    null
DROP TABLE t1;
CREATE TABLE t1(id INT, ip_str VARCHAR(50));
INSERT INTO t1 VALUES (1, '::10.0.5.9'), (2, '::1'), (3, '::192.168.1.1'), (4, '2001:db8::1');
SELECT id, ip_str FROM t1 WHERE IS_IPV4_COMPAT(INET6_ATON(ip_str)) = 1;
id    ip_str
1    ::10.0.5.9
2    ::1
3    ::192.168.1.1
SELECT id, ip_str FROM t1 WHERE IS_IPV4_COMPAT(INET6_ATON(ip_str)) = 0;
id    ip_str
4    2001:db8::1
DROP TABLE t1;
SELECT IS_IPV4_COMPAT(INET6_ATON('::10.0.5.9')) AS ip1, IS_IPV4_COMPAT(INET6_ATON('::1')) AS ip2, IS_IPV4_COMPAT(INET6_ATON('::192.168.1.1')) AS ip3;
ip1    ip2    ip3
1    1    1
SELECT IS_IPV4_COMPAT(INET6_ATON('::10.0.5.9')) = 1 AS is_compat;
is_compat
true
SELECT IS_IPV4_COMPAT(INET6_ATON('::1')) = 0 AS is_not_compat;
is_not_compat
false
SELECT IS_IPV4_COMPAT(INET6_ATON('::0.0.0.1')) AS min_compat;
min_compat
1
SELECT IS_IPV4_COMPAT(INET6_ATON('::255.255.255.255')) AS max_compat;
max_compat
1
SELECT IS_IPV4_COMPAT(INET6_ATON('::127.0.0.1')) AS loopback_compat;
loopback_compat
1
SELECT IS_IPV4_COMPAT(INET6_ATON('::10.0.5.9')) AND IS_IPV4_COMPAT(INET6_ATON('::192.168.1.1')) AS both_compat;
both_compat
true
SELECT IS_IPV4_COMPAT(INET6_ATON('::10.0.5.9')) OR IS_IPV4_COMPAT(INET6_ATON('::1')) AS one_compat;
one_compat
true
SELECT IS_IPV4_COMPAT(INET6_ATON('::192.168.1.1')) AS ipv4_compat;
ipv4_compat
1
SELECT IS_IPV4_COMPAT(INET6_ATON('::ffff:192.168.1.1')) AS ipv4_mapped;  -- Should be 0
ipv4_mapped
0
CREATE TABLE t1(id INT, ip_str VARCHAR(50));
INSERT INTO t1 VALUES (1, '::10.0.5.9'), (2, '::1');
SELECT (SELECT IS_IPV4_COMPAT(INET6_ATON(ip_str)) FROM t1 WHERE id = 1) AS subquery_result;
subquery_result
1
DROP TABLE t1;
SELECT IS_IPV4_COMPAT(UNHEX('C0A80101')) AS invalid_length;  -- 4 bytes instead of 16
invalid_length
0
SELECT IS_IPV4_COMPAT(UNHEX('01')) AS invalid_length2;  -- Too short
invalid_length2
0
