# Basic test case from requirements
SELECT TIMESTAMPADD(DAY, 5, '2024-12-20') AS result1;

# Additional test cases
# DATE type
SELECT TIMESTAMPADD(DAY, 5, '2024-12-20') AS date_add_days;
SELECT TIMESTAMPADD(DAY, -5, '2024-12-20') AS date_sub_days;
SELECT TIMESTAMPADD(HOUR, 24, '2024-12-20') AS date_add_hours;
SELECT TIMESTAMPADD(MONTH, 1, '2024-12-20') AS date_add_month;
SELECT TIMESTAMPADD(YEAR, 1, '2024-12-20') AS date_add_year;

# DATETIME type
SELECT TIMESTAMPADD(DAY, 5, '2024-12-20 10:30:45') AS datetime_add_days;
SELECT TIMESTAMPADD(HOUR, 2, '2024-12-20 10:30:45') AS datetime_add_hours;
SELECT TIMESTAMPADD(MINUTE, 30, '2024-12-20 10:30:45') AS datetime_add_minutes;
SELECT TIMESTAMPADD(SECOND, 60, '2024-12-20 10:30:45') AS datetime_add_seconds;

# TIMESTAMP type
SELECT TIMESTAMPADD(DAY, 5, TIMESTAMP('2024-12-20 10:30:45')) AS timestamp_add_days;

# Different interval units
SELECT TIMESTAMPADD(MICROSECOND, 1000000, '2024-12-20 10:30:45') AS add_microseconds;
SELECT TIMESTAMPADD(SECOND, 60, '2024-12-20 10:30:45') AS add_seconds;
SELECT TIMESTAMPADD(MINUTE, 60, '2024-12-20 10:30:45') AS add_minutes;
SELECT TIMESTAMPADD(HOUR, 24, '2024-12-20 10:30:45') AS add_hours;
SELECT TIMESTAMPADD(DAY, 7, '2024-12-20 10:30:45') AS add_days;
SELECT TIMESTAMPADD(WEEK, 1, '2024-12-20 10:30:45') AS add_weeks;
SELECT TIMESTAMPADD(MONTH, 1, '2024-12-20 10:30:45') AS add_months;
SELECT TIMESTAMPADD(QUARTER, 1, '2024-12-20 10:30:45') AS add_quarters;
SELECT TIMESTAMPADD(YEAR, 1, '2024-12-20 10:30:45') AS add_years;

# Negative intervals
SELECT TIMESTAMPADD(DAY, -5, '2024-12-20') AS sub_days;
SELECT TIMESTAMPADD(HOUR, -2, '2024-12-20 10:30:45') AS sub_hours;

# NULL handling
SELECT TIMESTAMPADD(DAY, 5, NULL) AS null_date;
SELECT TIMESTAMPADD(DAY, NULL, '2024-12-20') AS null_interval;

# Table usage
CREATE TABLE t1(d DATE);
INSERT INTO t1 VALUES ('2024-12-20'), ('2024-01-01'), ('2024-06-15');
SELECT d, TIMESTAMPADD(DAY, 5, d) AS added_date FROM t1;
DROP TABLE t1;

# MySQL compatibility: DATE + time unit → DATETIME, DATE + date unit → DATE
# Test DATE column with time units (should return DATETIME)
CREATE TABLE t1(d DATE);
INSERT INTO t1 VALUES ('2024-12-20');
SELECT TIMESTAMPADD(HOUR, 2, d) AS date_plus_hour FROM t1;
SELECT TIMESTAMPADD(MINUTE, 30, d) AS date_plus_minute FROM t1;
SELECT TIMESTAMPADD(SECOND, 45, d) AS date_plus_second FROM t1;
SELECT TIMESTAMPADD(MICROSECOND, 1000000, d) AS date_plus_microsecond FROM t1;
DROP TABLE t1;

# Test DATE column with date units (should return DATE)
CREATE TABLE t1(d DATE);
INSERT INTO t1 VALUES ('2024-12-20');
SELECT TIMESTAMPADD(DAY, 5, d) AS date_plus_day FROM t1;
SELECT TIMESTAMPADD(WEEK, 1, d) AS date_plus_week FROM t1;
SELECT TIMESTAMPADD(MONTH, 1, d) AS date_plus_month FROM t1;
SELECT TIMESTAMPADD(QUARTER, 1, d) AS date_plus_quarter FROM t1;
SELECT TIMESTAMPADD(YEAR, 1, d) AS date_plus_year FROM t1;
DROP TABLE t1;

# DATETIME table
CREATE TABLE t1(dt DATETIME);
INSERT INTO t1 VALUES ('2024-12-20 10:30:45'), ('2024-01-01 00:00:00'), ('2024-06-15 12:00:00');
SELECT dt, TIMESTAMPADD(HOUR, 2, dt) AS added_datetime FROM t1;
DROP TABLE t1;

# WHERE clause
CREATE TABLE t1(d DATE);
INSERT INTO t1 VALUES ('2024-12-20'), ('2024-01-01'), ('2024-06-15');
SELECT * FROM t1 WHERE TIMESTAMPADD(DAY, 5, d) > '2024-12-25';
DROP TABLE t1;

# Multiple units
SELECT TIMESTAMPADD(DAY, 5, '2024-12-20') AS result1, TIMESTAMPADD(HOUR, 12, '2024-12-20 10:30:45') AS result2, TIMESTAMPADD(MONTH, 1, '2024-12-20') AS result3;

# Large interval values that cause overflow (should return NULL, not panic)
# MySQL behavior: TIMESTAMPADD(DAY, 1000000000000, '1970-01-01 00:00:00') returns NULL
SELECT TIMESTAMPADD(DAY, 1000000000000, '1970-01-01 00:00:00') AS large_positive_interval;
SELECT TIMESTAMPADD(DAY, -1000000000000, '1970-01-01 00:00:00') AS large_negative_interval;
SELECT DATE_ADD('1970-01-01 00:00:00', INTERVAL 1000000000000 DAY) AS date_add_large_positive;
SELECT DATE_ADD('1970-01-01 00:00:00', INTERVAL -1000000000000 DAY) AS date_add_large_negative;

