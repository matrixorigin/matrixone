# INET_ATON and INET_NTOA functions
# Basic test case from requirements
SELECT INET_ATON('10.0.5.9') AS result1;

# INET_ATON tests
# Basic IPv4 addresses
SELECT INET_ATON('10.0.5.9') AS basic_ip;
SELECT INET_ATON('192.168.1.1') AS private_ip;
SELECT INET_ATON('127.0.0.1') AS loopback;
SELECT INET_ATON('255.255.255.255') AS max_ip;
SELECT INET_ATON('0.0.0.0') AS zero_ip;

# NULL handling
SELECT INET_ATON(NULL) AS null_input;

# Invalid addresses (should return NULL)
SELECT INET_ATON('invalid') AS invalid_address;
SELECT INET_ATON('256.256.256.256') AS invalid_octet;
SELECT INET_ATON('192.168.1') AS incomplete;
SELECT INET_ATON('192.168.1.1.1') AS too_many_octets;
SELECT INET_ATON('::1') AS ipv6_address;

# INET_NTOA tests
# Basic conversions
SELECT INET_NTOA(167773449) AS ip_from_int;  -- Should be '10.0.5.9'
SELECT INET_NTOA(3232235777) AS ip_from_int2;  -- Should be '192.168.1.1'
SELECT INET_NTOA(2130706433) AS loopback_from_int;  -- Should be '127.0.0.1'
SELECT INET_NTOA(4294967295) AS max_from_int;  -- Should be '255.255.255.255'
SELECT INET_NTOA(0) AS zero_from_int;  -- Should be '0.0.0.0'

# NULL handling
SELECT INET_NTOA(NULL) AS null_input;

# Different integer types
SELECT INET_NTOA(167773449) AS uint64_test;
SELECT INET_NTOA(CAST(167773449 AS UNSIGNED)) AS uint32_test;
SELECT INET_NTOA(CAST(167773449 AS SIGNED)) AS int64_test;
SELECT INET_NTOA(CAST(167773449 AS INT)) AS int32_test;

# Round-trip tests
SELECT INET_NTOA(INET_ATON('10.0.5.9')) AS roundtrip1;
SELECT INET_NTOA(INET_ATON('192.168.1.1')) AS roundtrip2;
SELECT INET_NTOA(INET_ATON('127.0.0.1')) AS roundtrip3;
SELECT INET_NTOA(INET_ATON('255.255.255.255')) AS roundtrip4;

# Table usage
CREATE TABLE t1(id INT, ip_str VARCHAR(50), ip_int BIGINT UNSIGNED);
INSERT INTO t1 VALUES (1, '192.168.1.1', 3232235777);
INSERT INTO t1 VALUES (2, '10.0.0.1', 167772161);
INSERT INTO t1 VALUES (3, '127.0.0.1', 2130706433);
INSERT INTO t1 VALUES (4, NULL, NULL);

SELECT id, ip_str, INET_ATON(ip_str) AS ip_int FROM t1;
SELECT id, ip_int, INET_NTOA(ip_int) AS ip_str FROM t1;
DROP TABLE t1;

# WHERE clause
CREATE TABLE t1(id INT, ip_str VARCHAR(50));
INSERT INTO t1 VALUES (1, '192.168.1.1'), (2, '10.0.0.1'), (3, '127.0.0.1');
SELECT id, ip_str FROM t1 WHERE INET_ATON(ip_str) = INET_ATON('192.168.1.1');
SELECT id, ip_str FROM t1 WHERE INET_ATON(ip_str) > INET_ATON('10.0.0.1');
DROP TABLE t1;

# Multiple function calls
SELECT INET_ATON('192.168.1.1') AS ip1, INET_ATON('10.0.0.1') AS ip2, INET_ATON('127.0.0.1') AS ip3;
SELECT INET_NTOA(3232235777) AS ip1, INET_NTOA(167772161) AS ip2, INET_NTOA(2130706433) AS ip3;

# Comparison and arithmetic
CREATE TABLE t1(id INT, ip_str VARCHAR(50));
INSERT INTO t1 VALUES (1, '192.168.1.1'), (2, '192.168.1.2'), (3, '10.0.0.1');
SELECT id, ip_str, INET_ATON(ip_str) AS ip_int FROM t1 ORDER BY INET_ATON(ip_str);
SELECT id, ip_str FROM t1 WHERE INET_ATON(ip_str) BETWEEN INET_ATON('10.0.0.0') AND INET_ATON('192.168.1.255');
DROP TABLE t1;

# Edge cases
SELECT INET_ATON('0.0.0.0') AS zero_ipv4;
SELECT INET_ATON('1.1.1.1') AS small_ip;
SELECT INET_NTOA(0) AS zero_result;
SELECT INET_NTOA(16843009) AS small_result;  -- Should be '1.1.1.1'

# Large values (should handle correctly)
SELECT INET_NTOA(4294967295) AS max_uint32;
SELECT INET_NTOA(18446744073709551615) AS max_uint64;  -- Should still be '255.255.255.255' (only lower 32 bits used)

