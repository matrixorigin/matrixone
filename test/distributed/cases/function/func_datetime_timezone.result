set time_zone = '+00:00';
select now(), @@session.time_zone;
now()    @@time_zone
2025-11-22 10:07:17.141386000    +00:00
set time_zone = '+08:00';
select now(), @@session.time_zone;
now()    @@time_zone
2025-11-22 18:07:17.148260000    +08:00
set time_zone = '-05:00';
select now(), @@session.time_zone;
now()    @@time_zone
2025-11-22 05:07:17.152942000    -05:00
set time_zone = '+00:00';
drop table if exists t_tz_test;
create table t_tz_test (
id int,
ts timestamp(6)
);
set time_zone = 'UTC';
insert into t_tz_test values (1, '2022-07-01 11:11:11.123456');
set time_zone = 'UTC';
select ts from t_tz_test;  -- should show: 2022-07-01 11:11:11.123456
ts
2022-07-01 11:11:11.123456000
set time_zone = '+08:00';  -- UTC+8
select ts from t_tz_test;  -- should show: 2022-07-01 19:11:11.123456 (add 8 hours)
ts
2022-07-01 19:11:11.123456000
set time_zone = '-05:00';  -- UTC-5
select ts from t_tz_test;  -- should show: 2022-07-01 06:11:11.123456 (subtract 5 hours)
ts
2022-07-01 06:11:11.123456000
drop table if exists t_tz_test;
set time_zone = '+00:00';
drop table if exists t_dt_ts;
create table t_dt_ts (
id int,
dt datetime(6),
ts timestamp(6)
);
set time_zone = 'UTC';
insert into t_dt_ts values (1, '2022-07-01 11:11:11.123456', '2022-07-01 11:11:11.123456');
set time_zone = '+08:00';
select dt, ts from t_dt_ts;
dt    ts
2022-07-01 11:11:11.123456000    2022-07-01 19:11:11.123456000
set time_zone = 'UTC';
select ts from t_dt_ts;  -- should have 6 digits: .123456
ts
2022-07-01 11:11:11.123456000
set time_zone = '+08:00';
select ts from t_dt_ts;  -- should still have 6 digits: .123456 (not 9 digits)
ts
2022-07-01 19:11:11.123456000
drop table if exists t_dt_ts;
set time_zone = '+00:00';
select
value_no_scale,
value_scale_0,
value_scale_3,
value_scale_6,
locate('.', value_no_scale) as has_dot_no_scale,
locate('.', value_scale_0) as has_dot_scale_0,
locate('.', value_scale_3) as dot_pos_scale_3,
locate('.', value_scale_6) as dot_pos_scale_6,
char_length(value_no_scale) as len_no_scale,
char_length(value_scale_0) as len_scale_0,
char_length(value_scale_3) - locate('.', value_scale_3) as decimal_digits_scale_3,
char_length(value_scale_6) - locate('.', value_scale_6) as decimal_digits_scale_6,
substring(value_scale_3, locate('.', value_scale_3) + 4) as last_6_digits_scale_3,
substring(value_scale_6, locate('.', value_scale_6) + 7) as last_3_digits_scale_6
from (
select
utc_timestamp() as value_no_scale,
utc_timestamp(0) as value_scale_0,
utc_timestamp(3) as value_scale_3,
utc_timestamp(6) as value_scale_6
) as t;
value_no_scale    value_scale_0    value_scale_3    value_scale_6    has_dot_no_scale    has_dot_scale_0    dot_pos_scale_3    dot_pos_scale_6    len_no_scale    len_scale_0    decimal_digits_scale_3    decimal_digits_scale_6    last_6_digits_scale_3    last_3_digits_scale_6
2025-11-22 10:07:17    2025-11-22 10:07:17    2025-11-22 10:07:17.272000000    2025-11-22 10:07:17.272414000    0    0    20    20    19    19    3    6        
select
value_scale_0,
value_scale_1,
value_scale_2,
value_scale_3,
value_scale_4,
value_scale_5,
value_scale_6,
locate('.', value_scale_0) as dot_scale_0,
locate('.', value_scale_1) as dot_scale_1,
locate('.', value_scale_2) as dot_scale_2,
locate('.', value_scale_3) as dot_scale_3,
locate('.', value_scale_4) as dot_scale_4,
locate('.', value_scale_5) as dot_scale_5,
locate('.', value_scale_6) as dot_scale_6,
char_length(value_scale_1) - locate('.', value_scale_1) as decimal_digits_scale_1,
char_length(value_scale_2) - locate('.', value_scale_2) as decimal_digits_scale_2,
char_length(value_scale_3) - locate('.', value_scale_3) as decimal_digits_scale_3,
char_length(value_scale_4) - locate('.', value_scale_4) as decimal_digits_scale_4,
char_length(value_scale_5) - locate('.', value_scale_5) as decimal_digits_scale_5,
char_length(value_scale_6) - locate('.', value_scale_6) as decimal_digits_scale_6,
substring(value_scale_1, locate('.', value_scale_1) + 2) as last_8_digits_scale_1,
substring(value_scale_2, locate('.', value_scale_2) + 3) as last_7_digits_scale_2,
substring(value_scale_3, locate('.', value_scale_3) + 4) as last_6_digits_scale_3,
substring(value_scale_4, locate('.', value_scale_4) + 5) as last_5_digits_scale_4,
substring(value_scale_5, locate('.', value_scale_5) + 6) as last_4_digits_scale_5,
substring(value_scale_6, locate('.', value_scale_6) + 7) as last_3_digits_scale_6
from (
select
utc_timestamp(0) as value_scale_0,
utc_timestamp(1) as value_scale_1,
utc_timestamp(2) as value_scale_2,
utc_timestamp(3) as value_scale_3,
utc_timestamp(4) as value_scale_4,
utc_timestamp(5) as value_scale_5,
utc_timestamp(6) as value_scale_6
) as t;
value_scale_0    value_scale_1    value_scale_2    value_scale_3    value_scale_4    value_scale_5    value_scale_6    dot_scale_0    dot_scale_1    dot_scale_2    dot_scale_3    dot_scale_4    dot_scale_5    dot_scale_6    decimal_digits_scale_1    decimal_digits_scale_2    decimal_digits_scale_3    decimal_digits_scale_4    decimal_digits_scale_5    decimal_digits_scale_6    last_8_digits_scale_1    last_7_digits_scale_2    last_6_digits_scale_3    last_5_digits_scale_4    last_4_digits_scale_5    last_3_digits_scale_6
2025-11-22 10:07:17    2025-11-22 10:07:17.300000000    2025-11-22 10:07:17.290000000    2025-11-22 10:07:17.286000000    2025-11-22 10:07:17.286300000    2025-11-22 10:07:17.286340000    2025-11-22 10:07:17.286344000    0    20    20    20    20    20    20    1    2    3    4    5    6                        
set time_zone = 'UTC';
select
value_now,
value_current_timestamp,
locate('.', value_now) as dot_pos_now,
locate('.', value_current_timestamp) as dot_pos_current_timestamp,
char_length(value_now) - locate('.', value_now) as decimal_digits_now,
char_length(value_current_timestamp) - locate('.', value_current_timestamp) as decimal_digits_current_timestamp,
substring(value_now, locate('.', value_now) + 7) as last_3_digits_now,
substring(value_current_timestamp, locate('.', value_current_timestamp) + 7) as last_3_digits_current_timestamp
from (
select now(6) as value_now, current_timestamp(6) as value_current_timestamp
) as t;
value_now    value_current_timestamp    dot_pos_now    dot_pos_current_timestamp    decimal_digits_now    decimal_digits_current_timestamp    last_3_digits_now    last_3_digits_current_timestamp
2025-11-22 10:07:17.310013000    2025-11-22 10:07:17.310013000    20    20    6    6        
set time_zone = '+08:00';
select
value_now,
value_current_timestamp,
locate('.', value_now) as dot_pos_now,
locate('.', value_current_timestamp) as dot_pos_current_timestamp,
char_length(value_now) - locate('.', value_now) as decimal_digits_now,
char_length(value_current_timestamp) - locate('.', value_current_timestamp) as decimal_digits_current_timestamp,
substring(value_now, locate('.', value_now) + 7) as last_3_digits_now,
substring(value_current_timestamp, locate('.', value_current_timestamp) + 7) as last_3_digits_current_timestamp
from (
select now(6) as value_now, current_timestamp(6) as value_current_timestamp
) as t;
value_now    value_current_timestamp    dot_pos_now    dot_pos_current_timestamp    decimal_digits_now    decimal_digits_current_timestamp    last_3_digits_now    last_3_digits_current_timestamp
2025-11-22 18:07:17.321246000    2025-11-22 18:07:17.321246000    20    20    6    6        
set time_zone = '+00:00';
