# IS_IPV4 function
# Basic test case from requirements
SELECT IS_IPV4('10.0.5.9') AS result1;

# Valid IPv4 addresses (should return 1)
SELECT IS_IPV4('10.0.5.9') AS valid_ip1;
SELECT IS_IPV4('192.168.1.1') AS valid_ip2;
SELECT IS_IPV4('127.0.0.1') AS valid_ip3;
SELECT IS_IPV4('255.255.255.255') AS valid_ip4;
SELECT IS_IPV4('0.0.0.0') AS valid_ip5;
SELECT IS_IPV4('1.1.1.1') AS valid_ip6;

# Invalid addresses (should return 0)
SELECT IS_IPV4('invalid') AS invalid1;
SELECT IS_IPV4('256.256.256.256') AS invalid2;
SELECT IS_IPV4('192.168.1') AS invalid3;
SELECT IS_IPV4('192.168.1.1.1') AS invalid4;
SELECT IS_IPV4('::1') AS invalid5;  -- IPv6 address
SELECT IS_IPV4('2001:db8::1') AS invalid6;  -- IPv6 address
SELECT IS_IPV4('') AS invalid7;  -- Empty string
SELECT IS_IPV4('192.168.1.256') AS invalid8;  -- Octet > 255
SELECT IS_IPV4('192.168.-1.1') AS invalid9;  -- Negative octet
SELECT IS_IPV4('192.168.1.1.') AS invalid10;  -- Trailing dot

# NULL handling (should return NULL)
SELECT IS_IPV4(NULL) AS null_input;

# Table usage
CREATE TABLE t1(id INT, ip_str VARCHAR(50));
INSERT INTO t1 VALUES (1, '192.168.1.1');
INSERT INTO t1 VALUES (2, '10.0.0.1');
INSERT INTO t1 VALUES (3, '::1');
INSERT INTO t1 VALUES (4, 'invalid');
INSERT INTO t1 VALUES (5, NULL);
INSERT INTO t1 VALUES (6, '127.0.0.1');

SELECT id, ip_str, IS_IPV4(ip_str) AS is_valid FROM t1;
DROP TABLE t1;

# WHERE clause
CREATE TABLE t1(id INT, ip_str VARCHAR(50));
INSERT INTO t1 VALUES (1, '192.168.1.1'), (2, '::1'), (3, '10.0.0.1'), (4, 'invalid');
SELECT id, ip_str FROM t1 WHERE IS_IPV4(ip_str) = 1;
SELECT id, ip_str FROM t1 WHERE IS_IPV4(ip_str) = 0;
DROP TABLE t1;

# Multiple function calls
SELECT IS_IPV4('192.168.1.1') AS ip1, IS_IPV4('::1') AS ip2, IS_IPV4('10.0.0.1') AS ip3;

# Comparison
SELECT IS_IPV4('192.168.1.1') = 1 AS is_valid_ip;
SELECT IS_IPV4('::1') = 0 AS is_not_ipv4;

# Edge cases
SELECT IS_IPV4('0.0.0.0') AS zero_ip;
SELECT IS_IPV4('255.255.255.255') AS max_ip;
SELECT IS_IPV4('1.1.1.1') AS min_nonzero;
SELECT IS_IPV4('192.168.01.1') AS leading_zero;  -- Should be valid (01 = 1)
SELECT IS_IPV4('192.168.1') AS incomplete;
SELECT IS_IPV4('192.168.1.') AS trailing_dot;
SELECT IS_IPV4('.192.168.1.1') AS leading_dot;

# Combined with other functions
SELECT IS_IPV4(INET_NTOA(3232235777)) AS from_ntoa;
SELECT IS_IPV4('192.168.1.1') AND IS_IPV4('10.0.0.1') AS both_valid;
SELECT IS_IPV4('192.168.1.1') OR IS_IPV4('::1') AS one_valid;

# Subquery usage
CREATE TABLE t1(id INT, ip_str VARCHAR(50));
INSERT INTO t1 VALUES (1, '192.168.1.1'), (2, '::1');
SELECT (SELECT IS_IPV4(ip_str) FROM t1 WHERE id = 1) AS subquery_result;
DROP TABLE t1;

