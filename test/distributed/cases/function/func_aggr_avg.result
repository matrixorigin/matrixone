SELECT avg(null);
â¤ avg(null)[8,54,0]  ğ„€
null
create table t1(a tinyint, b SMALLINT, c bigint, d INT, e BIGINT, f FLOAT, g DOUBLE, h decimal(38,19), i DATE, k datetime, l TIMESTAMP, m char(255), n varchar(255));
insert into t1 values(1, 1, 2, 4, 5, 5.5, 31.13, 14.314, "2012-03-12", "2012-03-12 10:03:12", "2012-03-12 13:03:12", "abc", "dcf");
insert into t1 values(1, 1, 2, 4, 5, 5.5, 31.13, 14.314, "2012-03-12", "2012-03-12 10:03:12", "2012-03-12 13:03:12", "abc", "dcf");
insert into t1 values(1, 1, 2, 4, 5, 5.5, 31.13, 14.314, "2012-03-12", "2012-03-12 10:03:12", "2012-03-12 13:03:12", "abc", "dcf");
insert into t1 values(1, 1, 2, 4, 5, 5.5, 31.13, 14.314, "2012-03-12", "2012-03-12 10:03:12", "2012-03-12 13:03:12", "abc", "dcf");
select avg(a) from t1;
â¤ avg(a)[8,54,0]  ğ„€
1.0
select avg(b) from t1;
â¤ avg(b)[8,54,0]  ğ„€
1.0
select avg(c) from t1;
â¤ avg(c)[8,54,0]  ğ„€
2.0
select avg(d) from t1;
â¤ avg(d)[8,54,0]  ğ„€
4.0
select avg(e) from t1;
â¤ avg(e)[8,54,0]  ğ„€
5.0
select avg(f) from t1;
â¤ avg(f)[8,54,0]  ğ„€
5.5
select avg(g) from t1;
â¤ avg(g)[8,54,0]  ğ„€
31.13
select avg(h) from t1;
â¤ avg(h)[3,38,19]  ğ„€
14.3140000000000000000
select avg(a) from t1 limit 1;
â¤ avg(a)[8,54,0]  ğ„€
1.0
select avg(b) from t1 limit 1;
â¤ avg(b)[8,54,0]  ğ„€
1.0
select avg(c) from t1 limit 1;
â¤ avg(c)[8,54,0]  ğ„€
2.0
select avg(d) from t1 limit 1;
â¤ avg(d)[8,54,0]  ğ„€
4.0
select avg(e) from t1 limit 1;
â¤ avg(e)[8,54,0]  ğ„€
5.0
select avg(f) from t1 limit 1;
â¤ avg(f)[8,54,0]  ğ„€
5.5
select avg(g) from t1 limit 1;
â¤ avg(g)[8,54,0]  ğ„€
31.13
select avg(h) from t1 limit 1;
â¤ avg(h)[3,38,19]  ğ„€
14.3140000000000000000
drop table t1;
create table t1(a bigint);
select avg(a) from t1;
â¤ avg(a)[8,54,0]  ğ„€
null
insert into t1 values(null),(null),(null),(null);
select avg(a) from t1;
â¤ avg(a)[8,54,0]  ğ„€
null
insert into t1 values(12417249128419),(124124125124151),(5124125151415),(124125152651515);
select avg(a) from t1 order by avg(a);
â¤ avg(a)[8,54,0]  ğ„€
6.6447663013875E13
drop table t1;
CREATE TABLE t1 (
bug_id bigint(9) NOT NULL,
groupset bigint(20) DEFAULT 0 NOT NULL,
assigned_to bigint(9) DEFAULT 0 NOT NULL,
bug_file_loc varchar(255)
);
CREATE TABLE t2 (
value varchar(255),
program varchar(64),
initialowner varchar(255) NOT NULL,
initialqacontact varchar(255) NOT NULL,
description varchar(255) NOT NULL,
id int not null
);
INSERT INTO t1 VALUES (1,0,0,'TestComponent');
INSERT INTO t1 VALUES (2,0,0,'BBBBBBBBBBBBB');
INSERT INTO t1 VALUES (3,0,0,'TestComponent2');
INSERT INTO t1 VALUES (4,0,0,'TestComponent2');
INSERT INTO t2 VALUES ('TestComponent','TestProduct','id0001','','',2);
INSERT INTO t2 VALUES ('BBBBBBBBBBBBB - conversion','AAAAA','id0001','','',2);
INSERT INTO t2 VALUES ('BBBBBBBBBBBBB - generic','AAAAA','id0001','','',3);
INSERT INTO t2 VALUES ('TestComponent2','TestProduct','id0001','','',3);
select any_value(value),any_value(description),avg(bug_id) from t2 left join t1 on t2.value=t1.bug_file_loc group by value having avg(bug_id)>0;
â¤ any_value(value)[12,-1,0]  Â¦  any_value(description)[12,-1,0]  Â¦  avg(bug_id)[8,54,0]  ğ„€
TestComponent  Â¦    Â¦  1.0  ğ„€
TestComponent2  Â¦    Â¦  3.5
SELECT avg(t1.bug_id) >= avg(t2.id) from t1 join t2 on t1.bug_file_loc = t2.value;
â¤ avg(t1.bug_id) >= avg(t2.id)[-7,1,0]  ğ„€
1
drop table t1;
drop table t2;
create table t1 (a int);
insert t1 values (1),(2);
select if(1>2,any_value(a),avg(a)) from t1;
â¤ if(1 > 2, any_value(a), avg(a))[8,54,0]  ğ„€
1.5
drop table t1;
CREATE TABLE t1(c0 INTEGER, c1 INTEGER, c2 INTEGER);
INSERT INTO t1 VALUES(1, 1, 1), (1, 1, 1);
SELECT CASE AVG (c0) WHEN any_value(c1) * any_value(c2) THEN 1 END FROM t1;
â¤ case AVG(c0) when any_value(c1) * any_value(c2) then 1 end[-5,64,0]  ğ„€
1
SELECT CASE any_value(c1) * any_value(c2) WHEN SUM(c0) THEN 1 WHEN AVG(c0) THEN 2 END FROM t1;
â¤ case any_value(c1) * any_value(c2) when SUM(c0) then 1 when AVG(c0) then 2 end[-5,64,0]  ğ„€
2
SELECT CASE any_value(c1) WHEN any_value(c1) + 1 THEN 1 END, ABS(AVG(c0)) FROM t1;
â¤ case any_value(c1) when any_value(c1) + 1 then 1 end[-5,64,0]  Â¦  ABS(AVG(c0))[8,54,0]  ğ„€
null  Â¦  1.0
DROP TABLE t1;
CREATE TABLE t1(a varchar(255), b INT, c INT UNSIGNED, d DECIMAL(12,2), e REAL);
INSERT INTO t1 VALUES('iynfj', 1, 1, 1, 1);
INSERT INTO t1 VALUES('innfj', 2, 2, 2, 2);
SELECT DISTINCT SUM(  a ) FROM t1 GROUP BY a HAVING a IN ( AVG( 1 ), 1 + a);
invalid argument aggregate function sum, bad value [VARCHAR]
SELECT DISTINCT SUM(  b ) FROM t1 GROUP BY b HAVING b IN ( AVG( 1 ), 1 + b);
â¤ SUM(b)[-5,64,0]  ğ„€
1
SELECT DISTINCT SUM(  c ) FROM t1 GROUP BY c HAVING c IN ( AVG( 1 ), 1 + c);
â¤ SUM(c)[-5,64,0]  ğ„€
1
SELECT DISTINCT SUM(  d ) FROM t1 GROUP BY d HAVING d IN ( AVG( 1 ), 1 + d);
â¤ SUM(d)[3,38,2]  ğ„€
1.00
SELECT DISTINCT SUM(  e ) FROM t1 GROUP BY e HAVING e IN ( AVG( 1 ), 1 + e);
â¤ SUM(e)[8,54,0]  ğ„€
1.0
DROP TABLE t1;
CREATE TABLE t1 (
a INT,
b INT,
c INT
);
INSERT INTO t1 VALUES
( 1, 1,  1 ),
( 1, 2,  2 ),
( 1, 3,  3 ),
( 1, 4,  6 ),
( 1, 5,  5 ),
( 1, 9, 13 ),
( 2, 1,  6 ),
( 2, 2,  7 ),
( 2, 3,  8 );
SELECT a, AVG(t1.b),
(SELECT t11.c FROM t1 t11 WHERE t11.a = t1.a AND t11.b = AVG(t1.b)) AS t11c,
(SELECT t12.c FROM t1 t12 WHERE t12.a = t1.a AND t12.b = AVG(t1.b)) AS t12c
FROM t1 GROUP BY a;
SQL syntax error: aggregate function avg not allowed in WHERE clause
DROP TABLE t1;
CREATE TABLE t1 (id int(11),value1 float(10,2));
INSERT INTO t1 VALUES (1,0.00),(1,1.00), (1,2.00), (2,10.00), (2,11.00), (2,12.00);
CREATE TABLE t2 (id int(11),name char(20));
INSERT INTO t2 VALUES (1,'Set One'),(2,'Set Two');
select id, avg(value1), std(value1), variance(value1) from t1 group by id;
â¤ id[4,32,0]  Â¦  avg(value1)[8,54,0]  Â¦  std(value1)[8,54,0]  Â¦  variance(value1)[8,54,0]  ğ„€
1  Â¦  1.0  Â¦  0.816496580927726  Â¦  0.6666666666666667  ğ„€
2  Â¦  11.0  Â¦  0.8164965809277289  Â¦  0.6666666666666714
select any_value(name), avg(value1), std(value1), variance(value1) from t1, t2 where t1.id = t2.id group by t1.id;
â¤ any_value(name)[1,20,0]  Â¦  avg(value1)[8,54,0]  Â¦  std(value1)[8,54,0]  Â¦  variance(value1)[8,54,0]  ğ„€
Set One  Â¦  1.0  Â¦  0.816496580927726  Â¦  0.6666666666666667  ğ„€
Set Two  Â¦  11.0  Â¦  0.8164965809277289  Â¦  0.6666666666666714
drop table t1;
drop table t2;
create table t1 (id int not null);
create table t2 (id int not null,rating int null);
insert into t1 values(1),(2),(3);
insert into t2 values(1, 3),(2, NULL),(2, NULL),(3, 2),(3, NULL);
select t1.id, avg(rating) from t1 left join t2 on ( t1.id = t2.id ) group by t1.id;
â¤ id[4,32,0]  Â¦  avg(rating)[8,54,0]  ğ„€
1  Â¦  3.0  ğ„€
2  Â¦  null  ğ„€
3  Â¦  2.0
drop table t1;
drop table t2;
CREATE TABLE t1 (a int, b int);
select count(b), sum(b), avg(b), std(b), min(b), max(b), bit_and(b), bit_or(b) from t1;
â¤ count(b)[-5,64,0]  Â¦  sum(b)[-5,64,0]  Â¦  avg(b)[8,54,0]  Â¦  std(b)[8,54,0]  Â¦  min(b)[4,32,0]  Â¦  max(b)[4,32,0]  Â¦  bit_and(b)[-5,64,0]  Â¦  bit_or(b)[-5,64,0]  ğ„€
0  Â¦  null  Â¦  null  Â¦  null  Â¦  null  Â¦  null  Â¦  null  Â¦  null
select a,count(b), sum(b), avg(b), std(b), min(b), max(b), bit_and(b), bit_or(b) from t1 group by a;
â¤ a[4,32,0]  Â¦  count(b)[-5,64,0]  Â¦  sum(b)[-5,64,0]  Â¦  avg(b)[8,54,0]  Â¦  std(b)[8,54,0]  Â¦  min(b)[4,32,0]  Â¦  max(b)[4,32,0]  Â¦  bit_and(b)[-5,64,0]  Â¦  bit_or(b)[-5,64,0]
insert into t1 values (1,null);
select a,count(b), sum(b), avg(b), std(b), min(b), max(b), bit_and(b), bit_or(b) from t1 group by a;
â¤ a[4,32,0]  Â¦  count(b)[-5,64,0]  Â¦  sum(b)[-5,64,0]  Â¦  avg(b)[8,54,0]  Â¦  std(b)[8,54,0]  Â¦  min(b)[4,32,0]  Â¦  max(b)[4,32,0]  Â¦  bit_and(b)[-5,64,0]  Â¦  bit_or(b)[-5,64,0]  ğ„€
1  Â¦  0  Â¦  null  Â¦  null  Â¦  null  Â¦  null  Â¦  null  Â¦  null  Â¦  null
insert into t1 values (1,null);
insert into t1 values (2,null);
select a,count(b), sum(b), avg(b), std(b), min(b), max(b), bit_and(b), bit_or(b) from t1 group by a;
â¤ a[4,32,0]  Â¦  count(b)[-5,64,0]  Â¦  sum(b)[-5,64,0]  Â¦  avg(b)[8,54,0]  Â¦  std(b)[8,54,0]  Â¦  min(b)[4,32,0]  Â¦  max(b)[4,32,0]  Â¦  bit_and(b)[-5,64,0]  Â¦  bit_or(b)[-5,64,0]  ğ„€
1  Â¦  0  Â¦  null  Â¦  null  Â¦  null  Â¦  null  Â¦  null  Â¦  null  Â¦  null  ğ„€
2  Â¦  0  Â¦  null  Â¦  null  Â¦  null  Â¦  null  Â¦  null  Â¦  null  Â¦  null
insert into t1 values (2,1);
select a,count(b), sum(b), avg(b), std(b), min(b), max(b), bit_and(b), bit_or(b) from t1 group by a;
â¤ a[4,32,0]  Â¦  count(b)[-5,64,0]  Â¦  sum(b)[-5,64,0]  Â¦  avg(b)[8,54,0]  Â¦  std(b)[8,54,0]  Â¦  min(b)[4,32,0]  Â¦  max(b)[4,32,0]  Â¦  bit_and(b)[-5,64,0]  Â¦  bit_or(b)[-5,64,0]  ğ„€
1  Â¦  0  Â¦  null  Â¦  null  Â¦  null  Â¦  null  Â¦  null  Â¦  null  Â¦  null  ğ„€
2  Â¦  1  Â¦  1  Â¦  1.0  Â¦  0.0  Â¦  1  Â¦  1  Â¦  1  Â¦  1
insert into t1 values (3,1);
select a,count(b), sum(b), avg(b), std(b), min(b), max(b), bit_and(b), bit_or(b) from t1 group by a;
â¤ a[4,32,0]  Â¦  count(b)[-5,64,0]  Â¦  sum(b)[-5,64,0]  Â¦  avg(b)[8,54,0]  Â¦  std(b)[8,54,0]  Â¦  min(b)[4,32,0]  Â¦  max(b)[4,32,0]  Â¦  bit_and(b)[-5,64,0]  Â¦  bit_or(b)[-5,64,0]  ğ„€
1  Â¦  0  Â¦  null  Â¦  null  Â¦  null  Â¦  null  Â¦  null  Â¦  null  Â¦  null  ğ„€
2  Â¦  1  Â¦  1  Â¦  1.0  Â¦  0.0  Â¦  1  Â¦  1  Â¦  1  Â¦  1  ğ„€
3  Â¦  1  Â¦  1  Â¦  1.0  Â¦  0.0  Â¦  1  Â¦  1  Â¦  1  Â¦  1
drop table t1;
create table t1 (a int);
select avg(2) from t1;
â¤ avg(2)[8,54,0]  ğ„€
null
drop table t1;
CREATE TABLE t1 (a INT, b INT);
INSERT INTO t1 VALUES (1,1),(1,2),(2,3);
SELECT (SELECT COUNT(DISTINCT t1.b)) FROM t1 GROUP BY t1.a;
correlated columns in aggregate function is not yet implemented
SELECT (SELECT COUNT(DISTINCT 12)) FROM t1 GROUP BY t1.a;
â¤ (select COUNT(distinct 12))[-5,64,0]  ğ„€
1  ğ„€
1
SELECT AVG(2), BIT_AND(2), BIT_OR(2), BIT_XOR(2), COUNT(*), COUNT(12), COUNT(DISTINCT 12), MIN(2),MAX(2),STD(2), VARIANCE(2),SUM(2);
â¤ AVG(2)[8,54,0]  Â¦  BIT_AND(2)[-5,64,0]  Â¦  BIT_OR(2)[-5,64,0]  Â¦  BIT_XOR(2)[-5,64,0]  Â¦  COUNT(*)[-5,64,0]  Â¦  COUNT(12)[-5,64,0]  Â¦  COUNT(distinct 12)[-5,64,0]  Â¦  MIN(2)[-5,64,0]  Â¦  MAX(2)[-5,64,0]  Â¦  STD(2)[8,54,0]  Â¦  VARIANCE(2)[8,54,0]  Â¦  SUM(2)[-5,64,0]  ğ„€
2.0  Â¦  2  Â¦  2  Â¦  2  Â¦  1  Â¦  1  Â¦  1  Â¦  2  Â¦  2  Â¦  0.0  Â¦  0.0  Â¦  2
DROP TABLE t1;
CREATE TABLE t1 (col1 decimal(16,12));
INSERT INTO t1 VALUES (-5.00000000001),(-5.00000000002),(-5.00000000003),(-5.00000000000),(-5.00000000001),(-5.00000000002);
insert into t1 select * from t1;
select col1,count(col1),sum(col1),avg(col1) from t1 group by col1;
â¤ col1[3,16,12]  Â¦  count(col1)[-5,64,0]  Â¦  sum(col1)[3,38,12]  Â¦  avg(col1)[3,38,12]  ğ„€
-5.000000000010  Â¦  4  Â¦  -20.000000000040  Â¦  -5.000000000010  ğ„€
-5.000000000020  Â¦  4  Â¦  -20.000000000080  Â¦  -5.000000000020  ğ„€
-5.000000000030  Â¦  2  Â¦  -10.000000000060  Â¦  -5.000000000030  ğ„€
-5.000000000000  Â¦  2  Â¦  -10.000000000000  Â¦  -5.000000000000
DROP TABLE t1;
CREATE TABLE t1 (a INT, b INT);
INSERT INTO t1 VALUES (1,1),(1,2),(1,3),(1,4),(1,5),(1,6),(1,7),(1,8);
INSERT INTO t1 SELECT a, b+8       FROM t1;
INSERT INTO t1 SELECT a, b+16      FROM t1;
INSERT INTO t1 SELECT a, b+32      FROM t1;
INSERT INTO t1 SELECT a, b+64      FROM t1;
INSERT INTO t1 SELECT a, b+128     FROM t1;
INSERT INTO t1 SELECT a, b+256     FROM t1;
INSERT INTO t1 SELECT a, b+512     FROM t1;
INSERT INTO t1 SELECT a, b+1024    FROM t1;
INSERT INTO t1 SELECT a, b+2048    FROM t1;
INSERT INTO t1 SELECT a, b+4096    FROM t1;
INSERT INTO t1 SELECT a, b+8192    FROM t1;
INSERT INTO t1 SELECT a, b+16384   FROM t1;
INSERT INTO t1 SELECT a, b+32768   FROM t1;
SELECT a,COUNT(DISTINCT b) AS cnt FROM t1 GROUP BY a HAVING cnt > 50;
â¤ a[4,32,0]  Â¦  cnt[-5,64,0]  ğ„€
1  Â¦  65536
SELECT DISTINCT a, SUM( b) AS sumation FROM t1 GROUP BY a HAVING sumation > 50;
â¤ a[4,32,0]  Â¦  sumation[-5,64,0]  ğ„€
1  Â¦  2147516416
SELECT DISTINCT a, AVG( b) AS average FROM t1 GROUP BY a HAVING average > 50;
â¤ a[4,32,0]  Â¦  average[8,54,0]  ğ„€
1  Â¦  32768.5
SELECT a,COUNT(DISTINCT b) FROM t1 GROUP BY a HAVING COUNT(DISTINCT b) > 50;
â¤ a[4,32,0]  Â¦  COUNT(distinct b)[-5,64,0]  ğ„€
1  Â¦  65536
SELECT DISTINCT a, SUM( b) FROM t1 GROUP BY a HAVING SUM( b) > 50;
â¤ a[4,32,0]  Â¦  SUM(b)[-5,64,0]  ğ„€
1  Â¦  2147516416
SELECT DISTINCT a, AVG( b) FROM t1 GROUP BY a HAVING AVG( b) > 50;
â¤ a[4,32,0]  Â¦  AVG(b)[8,54,0]  ğ„€
1  Â¦  32768.5
DROP TABLE t1;
CREATE TABLE t1(a DOUBLE);
INSERT INTO t1 VALUES (10), (20);
SELECT AVG(a), CAST(AVG(a) AS DECIMAL) FROM t1;
â¤ AVG(a)[8,54,0]  Â¦  cast(AVG(a) as decimal(38))[3,39,0]  ğ„€
15.0  Â¦  15
DROP TABLE t1;
create table t1 (grp int, a bigint unsigned, c char(10) not null);
insert into t1 values (1,1,"a");
insert into t1 values (2,2,"b");
insert into t1 values (2,3,"c");
insert into t1 values (3,4,"E");
insert into t1 values (3,5,"C");
insert into t1 values (3,6,"D");
select sum(all a),count(all a),avg(all a),std(all a),variance(all a),bit_or(all a),bit_and(all a),min(all a),max(all a),min(all c),max(all c) from t1;
â¤ sum(all a)[-5,64,0]  Â¦  count(all a)[-5,64,0]  Â¦  avg(all a)[8,54,0]  Â¦  std(all a)[8,54,0]  Â¦  variance(all a)[8,54,0]  Â¦  bit_or(all a)[-5,64,0]  Â¦  bit_and(all a)[-5,64,0]  Â¦  min(all a)[-5,64,0]  Â¦  max(all a)[-5,64,0]  Â¦  min(all c)[1,10,0]  Â¦  max(all c)[1,10,0]  ğ„€
21  Â¦  6  Â¦  3.5  Â¦  1.707825127659933  Â¦  2.916666666666666  Â¦  7  Â¦  0  Â¦  1  Â¦  6  Â¦  C  Â¦  c
select grp, sum(a),count(a),avg(a),std(a),variance(a),bit_or(a),bit_and(a),min(a),max(a),min(c),max(c) from t1 group by grp;
â¤ grp[4,32,0]  Â¦  sum(a)[-5,64,0]  Â¦  count(a)[-5,64,0]  Â¦  avg(a)[8,54,0]  Â¦  std(a)[8,54,0]  Â¦  variance(a)[8,54,0]  Â¦  bit_or(a)[-5,64,0]  Â¦  bit_and(a)[-5,64,0]  Â¦  min(a)[-5,64,0]  Â¦  max(a)[-5,64,0]  Â¦  min(c)[1,10,0]  Â¦  max(c)[1,10,0]  ğ„€
1  Â¦  1  Â¦  1  Â¦  1.0  Â¦  0.0  Â¦  0.0  Â¦  1  Â¦  1  Â¦  1  Â¦  1  Â¦  a  Â¦  a  ğ„€
2  Â¦  5  Â¦  2  Â¦  2.5  Â¦  0.5  Â¦  0.25  Â¦  3  Â¦  2  Â¦  2  Â¦  3  Â¦  b  Â¦  c  ğ„€
3  Â¦  15  Â¦  3  Â¦  5.0  Â¦  0.8164965809277268  Â¦  0.6666666666666679  Â¦  7  Â¦  4  Â¦  4  Â¦  6  Â¦  C  Â¦  E
select grp, sum(a)+count(a)+avg(a)+std(a)+variance(a)+bit_or(a)+bit_and(a)+min(a)+max(a)+min(c)+max(c) as sum from t1 group by grp;
â¤ grp[4,32,0]  Â¦  sum[8,54,0]  ğ„€
1  Â¦  7.0  ğ„€
2  Â¦  20.25  ğ„€
3  Â¦  45.48316324759439
create table t2 (grp int, a bigint unsigned, c char(10));
insert into t2 select grp,max(a)+max(grp),max(c) from t1 group by grp;
select * from t2;
â¤ grp[4,32,0]  Â¦  a[-5,64,0]  Â¦  c[1,10,0]  ğ„€
1  Â¦  2  Â¦  a  ğ„€
2  Â¦  5  Â¦  c  ğ„€
3  Â¦  9  Â¦  E
drop table t1;
drop table t2;
CREATE TABLE t1(a DOUBLE);
INSERT INTO t1 VALUES (10), (20);
SELECT AVG(min(a)) FROM t1 group by a;
SQL syntax error: aggregate function min calls cannot be nested
DROP TABLE t1;
CREATE TABLE t1 (id int(11),value1 float(10,2));
INSERT INTO t1 VALUES (1,0.00),(1,1.00), (1,2.00), (2,10.00), (2,11.00), (2,12.00);
CREATE TABLE t2 (id int(11),name char(20));
INSERT INTO t2 VALUES (1,'Set One'),(2,'Set Two');
select name, avg(value1), std(value1), variance(value1) from t1, t2 where t1.id = t2.id group by t1.id;
SQL syntax error: column "t2.name" must appear in the GROUP BY clause or be used in an aggregate function
drop table t1;
drop table t2;
create table t1 (grp int, a bigint unsigned, c char(10) not null);
insert into t1 values (1,1,"a");
insert into t1 values (2,2,"b");
insert into t1 values (2,3,"c");
insert into t1 values (3,4,"E");
insert into t1 values (3,5,"C");
insert into t1 values (3,6,"D");
select avg(distinct a),avg(distinct grp) from t1;
â¤ avg(distinct a)[8,54,0]  Â¦  avg(distinct grp)[8,54,0]  ğ„€
3.5  Â¦  2.0
insert into t1 values (null,null,'');
select avg(distinct a),avg(distinct grp) from t1;
â¤ avg(distinct a)[8,54,0]  Â¦  avg(distinct grp)[8,54,0]  ğ„€
3.5  Â¦  2.0
drop table t1;
create table d1 (i1 int);
insert into d1 select * from generate_series(0, 999) g;
select avg(distinct i1) from d1;
â¤ avg(distinct i1)[8,54,0]  ğ„€
499.5
drop table d1;
