# INET6_ATON and INET6_NTOA functions
# Basic test case from requirements
SELECT HEX(INET6_ATON('::1')) AS result1;

# INET6_ATON tests
# IPv6 addresses
SELECT HEX(INET6_ATON('::1')) AS ipv6_loopback;
SELECT HEX(INET6_ATON('2001:0db8:85a3:0000:0000:8a2e:0370:7334')) AS ipv6_full;
SELECT HEX(INET6_ATON('2001:db8:85a3::8a2e:370:7334')) AS ipv6_compressed;
SELECT HEX(INET6_ATON('::ffff:192.168.1.1')) AS ipv4_mapped;

# IPv4 addresses
SELECT HEX(INET6_ATON('192.168.1.1')) AS ipv4_basic;
SELECT HEX(INET6_ATON('127.0.0.1')) AS ipv4_loopback;
SELECT HEX(INET6_ATON('10.0.0.1')) AS ipv4_private;
SELECT HEX(INET6_ATON('255.255.255.255')) AS ipv4_max;

# NULL handling
SELECT INET6_ATON(NULL) AS null_input;

# Invalid addresses (should return NULL)
SELECT INET6_ATON('invalid') AS invalid_address;
SELECT INET6_ATON('256.256.256.256') AS invalid_ipv4;
SELECT INET6_ATON('2001::gggg::1') AS invalid_ipv6;

# INET6_NTOA tests
# IPv6 addresses
SELECT INET6_NTOA(UNHEX('00000000000000000000000000000001')) AS ipv6_loopback;
SELECT INET6_NTOA(UNHEX('20010DB885A3000000008A2E03707334')) AS ipv6_full;
SELECT INET6_NTOA(UNHEX('00000000000000000000FFFFC0A80101')) AS ipv4_mapped;

# IPv4 addresses (4 bytes)
SELECT INET6_NTOA(UNHEX('C0A80101')) AS ipv4_basic;
SELECT INET6_NTOA(UNHEX('7F000001')) AS ipv4_loopback;
SELECT INET6_NTOA(UNHEX('0A000001')) AS ipv4_private;
SELECT INET6_NTOA(UNHEX('FFFFFFFF')) AS ipv4_max;

# NULL handling
SELECT INET6_NTOA(NULL) AS null_input;

# Invalid input (should return NULL)
SELECT INET6_NTOA(UNHEX('01')) AS invalid_short;
SELECT INET6_NTOA(UNHEX('0101010101010101010101010101010101')) AS invalid_long;

# Round-trip tests
SELECT INET6_NTOA(INET6_ATON('::1')) AS roundtrip_ipv6;
SELECT INET6_NTOA(INET6_ATON('192.168.1.1')) AS roundtrip_ipv4;
SELECT INET6_NTOA(INET6_ATON('2001:db8::1')) AS roundtrip_ipv6_compressed;

# Table usage
CREATE TABLE t1(id INT, ip_str VARCHAR(50), ip_bin VARBINARY(16));
INSERT INTO t1 VALUES (1, '192.168.1.1', UNHEX('C0A80101'));
INSERT INTO t1 VALUES (2, '::1', UNHEX('00000000000000000000000000000001'));
INSERT INTO t1 VALUES (3, '2001:db8::1', UNHEX('20010DB8000000000000000000000001'));
INSERT INTO t1 VALUES (4, NULL, NULL);

SELECT id, ip_str, HEX(INET6_ATON(ip_str)) AS converted FROM t1;
SELECT id, HEX(ip_bin) AS ip_bin_hex, INET6_NTOA(ip_bin) AS converted FROM t1;
DROP TABLE t1;

# WHERE clause
CREATE TABLE t1(id INT, ip_str VARCHAR(50));
INSERT INTO t1 VALUES (1, '192.168.1.1'), (2, '10.0.0.1'), (3, '::1');
SELECT id, ip_str FROM t1 WHERE INET6_ATON(ip_str) IS NOT NULL;
DROP TABLE t1;

# Multiple function calls
SELECT INET6_ATON('192.168.1.1') AS ip1, INET6_ATON('10.0.0.1') AS ip2, INET6_ATON('::1') AS ip3;
SELECT INET6_NTOA(UNHEX('C0A80101')) AS ip1, INET6_NTOA(UNHEX('0A000001')) AS ip2, INET6_NTOA(UNHEX('00000000000000000000000000000001')) AS ip3;

# Comparison
CREATE TABLE t1(id INT, ip_str VARCHAR(50));
INSERT INTO t1 VALUES (1, '192.168.1.1'), (2, '192.168.1.2'), (3, '10.0.0.1');
SELECT id, ip_str, INET6_ATON(ip_str) AS binary_ip FROM t1 WHERE INET6_ATON(ip_str) = INET6_ATON('192.168.1.1');
DROP TABLE t1;

# Edge cases
SELECT HEX(INET6_ATON('0.0.0.0')) AS zero_ipv4;
SELECT HEX(INET6_ATON('::')) AS zero_ipv6;
SELECT INET6_NTOA(UNHEX('00000000')) AS zero_ipv4_result;
SELECT INET6_NTOA(UNHEX('00000000000000000000000000000000')) AS zero_ipv6_result;

