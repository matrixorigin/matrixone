select * from metadata_scan('func_ts_to_time.no_exist_table', '*') g;
SQL parser error: table "no_exist_table" does not exist
drop table if exists t;
create table t(a int, b varchar, c float, d decimal(10, 8), e float(5, 2));
insert into t values(1, null, 1.1, 1, 1.11);
insert into t values(2, "abc", 2.0, 2, 2.22);
insert into t select * from t;
insert into t select * from t;
insert into t select * from t;
insert into t select * from t;
insert into t select * from t;
insert into t select * from t;
insert into t select * from t;
insert into t select * from t;
insert into t select * from t;
insert into t select * from t;
insert into t select * from t;
insert into t select * from t;
select count(*) from t;
count(*)
8192
select mo_ctl("dn", "flush", "func_ts_to_time.t");
mo_ctl(dn, flush, func_ts_to_time.t)
{\n  "method": "Flush",\n  "result": [\n    {\n      "returnStr": "OK"\n    }\n  ]\n}\n
select sleep(1);
sleep(1)
0
select count(*) from metadata_scan("func_ts_to_time.t", "*")g where create_ts <= NOW();
count(*)
5
select count(*) from metadata_scan("func_ts_to_time.t", "*")g where create_ts = "0-0";
count(*)
0
select count(*) from metadata_scan("func_ts_to_time.t", "*")g where create_ts > 0;
count(*)
5
select count(*) from metadata_scan("func_ts_to_time.t", "*")g where create_ts > 9.9;
invalid argument operator >, bad value [TRANSACTION TIMESTAMP DECIMAL64]
select count(*) from metadata_scan("func_ts_to_time.t", "*")g where cast(create_ts as float) > 9.9;
invalid argument operator cast, bad value [TRANSACTION TIMESTAMP FLOAT]
select count(*) from metadata_scan("func_ts_to_time.t", "*")g where cast(create_ts as TIMESTAMP) <= NOW();
count(*)
5
select count(*) from metadata_scan("func_ts_to_time.t", "*")g where ts_to_time(create_ts) <= NOW();
count(*)
5
select count(*) from metadata_scan("func_ts_to_time.t", "*")g where ts_to_time(create_ts, 2) <= NOW();
count(*)
5
select count(*) from metadata_scan("func_ts_to_time.t", "*")g where ts_to_time(1) <= NOW();
invalid argument function ts_to_time, bad value [BIGINT]
