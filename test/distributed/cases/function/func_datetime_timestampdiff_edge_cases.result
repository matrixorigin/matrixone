SELECT TIMESTAMPDIFF(DAY, '2024-12-20', '2024-12-20') AS same_date;
same_date
0
SELECT TIMESTAMPDIFF(HOUR, '2024-12-20 10:30:45', '2024-12-20 10:30:45') AS same_datetime;
same_datetime
0
SELECT TIMESTAMPDIFF(MINUTE, '2024-12-20 10:30:45', '2024-12-20 10:30:45') AS same_minute;
same_minute
0
SELECT TIMESTAMPDIFF(SECOND, '2024-12-20 10:30:45', '2024-12-20 10:30:45') AS same_second;
same_second
0
SELECT TIMESTAMPDIFF(MICROSECOND, '2024-12-20 10:30:45.123456', '2024-12-20 10:30:45.123456') AS same_microsecond;
same_microsecond
0
SELECT TIMESTAMPDIFF(MONTH, '2024-12-20', '2024-12-20') AS same_month;
same_month
0
SELECT TIMESTAMPDIFF(YEAR, '2024-12-20', '2024-12-20') AS same_year;
same_year
0
SELECT TIMESTAMPDIFF(DAY, '2024-12-20 00:00:00', '2024-12-21 00:00:00') AS exactly_one_day;
exactly_one_day
1
SELECT TIMESTAMPDIFF(DAY, '2024-12-20 23:59:59', '2024-12-21 00:00:00') AS almost_one_day;
almost_one_day
0
SELECT TIMESTAMPDIFF(HOUR, '2024-12-20 10:00:00', '2024-12-20 11:00:00') AS exactly_one_hour;
exactly_one_hour
1
SELECT TIMESTAMPDIFF(MINUTE, '2024-12-20 10:30:00', '2024-12-20 10:31:00') AS exactly_one_minute;
exactly_one_minute
1
SELECT TIMESTAMPDIFF(SECOND, '2024-12-20 10:30:45', '2024-12-20 10:30:46') AS exactly_one_second;
exactly_one_second
1
SELECT TIMESTAMPDIFF(MICROSECOND, '2024-12-20 10:30:45.000000', '2024-12-20 10:30:45.000001') AS exactly_one_microsecond;
exactly_one_microsecond
1
SELECT TIMESTAMPDIFF(WEEK, '2024-12-20', '2024-12-27') AS exactly_one_week;
exactly_one_week
1
SELECT TIMESTAMPDIFF(MONTH, '2024-01-01', '2024-02-01') AS exactly_one_month;
exactly_one_month
1
SELECT TIMESTAMPDIFF(QUARTER, '2024-01-01', '2024-04-01') AS exactly_one_quarter;
exactly_one_quarter
1
SELECT TIMESTAMPDIFF(YEAR, '2024-01-01', '2025-01-01') AS exactly_one_year;
exactly_one_year
1
SELECT TIMESTAMPDIFF(DAY, '2023-12-31 23:59:59', '2024-01-01 00:00:00') AS cross_year_day;
cross_year_day
0
SELECT TIMESTAMPDIFF(HOUR, '2023-12-31 23:00:00', '2024-01-01 00:00:00') AS cross_year_hour;
cross_year_hour
1
SELECT TIMESTAMPDIFF(MINUTE, '2023-12-31 23:59:00', '2024-01-01 00:00:00') AS cross_year_minute;
cross_year_minute
1
SELECT TIMESTAMPDIFF(SECOND, '2023-12-31 23:59:59', '2024-01-01 00:00:00') AS cross_year_second;
cross_year_second
1
SELECT TIMESTAMPDIFF(YEAR, '2023-12-31', '2024-01-01') AS cross_year_boundary;
cross_year_boundary
0
SELECT TIMESTAMPDIFF(YEAR, '2023-01-01', '2024-12-31') AS same_year_span;
same_year_span
1
SELECT TIMESTAMPDIFF(YEAR, '2023-12-31', '2024-01-01') AS cross_year_one_day;
cross_year_one_day
0
SELECT TIMESTAMPDIFF(YEAR, '2020-12-31', '2024-01-01') AS cross_multiple_years;
cross_multiple_years
3
SELECT TIMESTAMPDIFF(DAY, '2024-01-31 23:59:59', '2024-02-01 00:00:00') AS cross_month;
cross_month
0
SELECT TIMESTAMPDIFF(MONTH, '2024-01-31', '2024-02-01') AS cross_month_boundary;
cross_month_boundary
0
SELECT TIMESTAMPDIFF(MONTH, '2024-01-01', '2024-02-28') AS jan_to_feb;
jan_to_feb
1
SELECT TIMESTAMPDIFF(MONTH, '2024-01-31', '2024-02-29') AS jan31_to_feb29_leap;
jan31_to_feb29_leap
0
SELECT TIMESTAMPDIFF(MONTH, '2024-01-31', '2024-03-01') AS jan31_to_mar1;
jan31_to_mar1
1
SELECT TIMESTAMPDIFF(QUARTER, '2024-01-31', '2024-04-01') AS cross_quarter;
cross_quarter
0
SELECT TIMESTAMPDIFF(DAY, '2020-02-28', '2020-03-01') AS leap_year_feb_to_mar;
leap_year_feb_to_mar
2
SELECT TIMESTAMPDIFF(DAY, '2021-02-28', '2021-03-01') AS non_leap_year_feb_to_mar;
non_leap_year_feb_to_mar
1
SELECT TIMESTAMPDIFF(DAY, '2020-02-29', '2020-03-01') AS leap_day_to_mar;
leap_day_to_mar
1
SELECT TIMESTAMPDIFF(YEAR, '2020-02-29', '2021-02-28') AS leap_to_non_leap_year;
leap_to_non_leap_year
0
SELECT TIMESTAMPDIFF(YEAR, '2020-02-29', '2021-03-01') AS leap_to_non_leap_year_plus;
leap_to_non_leap_year_plus
1
SELECT TIMESTAMPDIFF(DAY, '2020-01-01', '2020-12-31') AS leap_year_full_year;
leap_year_full_year
365
SELECT TIMESTAMPDIFF(DAY, '2021-01-01', '2021-12-31') AS non_leap_year_full_year;
non_leap_year_full_year
364
SELECT TIMESTAMPDIFF(DAY, '2024-02-29', '2024-03-01') AS leap_2024_feb29_to_mar;
leap_2024_feb29_to_mar
1
SELECT TIMESTAMPDIFF(MICROSECOND, '2024-12-20 10:30:45.000000', '2024-12-20 10:30:45.000001') AS one_microsecond;
one_microsecond
1
SELECT TIMESTAMPDIFF(MICROSECOND, '2024-12-20 10:30:45.123456', '2024-12-20 10:30:45.654321') AS microsecond_diff;
microsecond_diff
530865
SELECT TIMESTAMPDIFF(MICROSECOND, '2024-12-20 10:30:45.000000', '2024-12-20 10:30:45.999999') AS max_microsecond_diff;
max_microsecond_diff
999999
SELECT TIMESTAMPDIFF(MICROSECOND, '2024-12-20 10:30:45.123456', '2024-12-20 10:30:46.123455') AS microsecond_carry;
microsecond_carry
999999
SELECT TIMESTAMPDIFF(SECOND, '2024-12-20 10:30:45', '2024-12-20 10:30:45.123456') AS datetime_scale_diff;
datetime_scale_diff
0
SELECT TIMESTAMPDIFF(MICROSECOND, '2024-12-20 10:30:45.000000', '2024-12-20 10:30:46.000000') AS one_second_in_microseconds;
one_second_in_microseconds
1000000
SELECT TIMESTAMPDIFF(SECOND, '2024-12-20 00:00:00', '2024-12-20 23:59:59') AS full_day_seconds;
full_day_seconds
86399
SELECT TIMESTAMPDIFF(HOUR, '2024-12-20 00:00:00', '2024-12-20 23:59:59') AS full_day_hours;
full_day_hours
23
SELECT TIMESTAMPDIFF(MINUTE, '2024-12-20 00:00:00', '2024-12-20 23:59:59') AS full_day_minutes;
full_day_minutes
1439
SELECT TIMESTAMPDIFF(DAY, '2024-12-20 00:00:00', '2024-12-20 23:59:59') AS same_day_with_time;
same_day_with_time
0
SELECT TIMESTAMPDIFF(DAY, '2024-12-20 23:59:59', '2024-12-21 00:00:01') AS cross_midnight;
cross_midnight
0
SELECT TIMESTAMPDIFF(DAY, DATE('2024-12-20'), '2024-12-21 12:00:00') AS date_vs_datetime;
date_vs_datetime
1
SELECT TIMESTAMPDIFF(HOUR, DATE('2024-12-20'), '2024-12-20 12:00:00') AS date_vs_datetime_hours;
date_vs_datetime_hours
12
SELECT TIMESTAMPDIFF(DAY, TIMESTAMP('2024-12-20 10:30:45'), DATE('2024-12-21')) AS timestamp_vs_date;
timestamp_vs_date
0
SELECT TIMESTAMPDIFF(DAY, '2024-12-20', DATE('2024-12-21')) AS string_vs_date;
string_vs_date
1
SELECT TIMESTAMPDIFF(DAY, DATE('2024-12-20'), '2024-12-21 10:30:45') AS date_vs_string_datetime;
date_vs_string_datetime
1
SELECT TIMESTAMPDIFF(HOUR, DATE('2024-12-20'), TIMESTAMP('2024-12-20 12:00:00')) AS date_vs_timestamp;
date_vs_timestamp
12
SELECT TIMESTAMPDIFF(DAY, '2024-12-21', '2024-12-20') AS negative_day;
negative_day
-1
SELECT TIMESTAMPDIFF(HOUR, '2024-12-20 12:00:00', '2024-12-20 10:00:00') AS negative_hour;
negative_hour
-2
SELECT TIMESTAMPDIFF(MONTH, '2024-02-01', '2024-01-01') AS negative_month;
negative_month
-1
SELECT TIMESTAMPDIFF(YEAR, '2025-01-01', '2024-01-01') AS negative_year;
negative_year
-1
SELECT TIMESTAMPDIFF(MICROSECOND, '2024-12-20 10:30:45.654321', '2024-12-20 10:30:45.123456') AS negative_microsecond;
negative_microsecond
-530865
SELECT TIMESTAMPDIFF(DAY, '9999-12-31', '9999-12-31') AS max_date_same;
max_date_same
0
SELECT TIMESTAMPDIFF(DAY, '9999-12-30', '9999-12-31') AS max_date_one_day;
max_date_one_day
1
SELECT TIMESTAMPDIFF(DAY, '0001-01-01', '0001-01-01') AS min_date_same;
min_date_same
0
SELECT TIMESTAMPDIFF(DAY, '0001-01-01', '0001-01-02') AS min_date_one_day;
min_date_one_day
1
SELECT TIMESTAMPDIFF(YEAR, '0001-01-01', '9999-12-31') AS min_to_max_year;
min_to_max_year
9998
SELECT TIMESTAMPDIFF(DAY, '0001-01-01', '9999-12-31') AS min_to_max_day;
min_to_max_day
3652058
SELECT TIMESTAMPDIFF(MONTH, '0001-01-01', '9999-12-31') AS min_to_max_month;
min_to_max_month
119987
SELECT TIMESTAMPDIFF(DAY, '2024-01-01', '2024-12-31') AS full_year_days;
full_year_days
365
SELECT TIMESTAMPDIFF(MONTH, '2024-01-01', '2024-12-31') AS full_year_months;
full_year_months
11
SELECT TIMESTAMPDIFF(YEAR, '2000-01-01', '2100-01-01') AS century_span;
century_span
100
SELECT TIMESTAMPDIFF(QUARTER, '2024-01-01', '2024-12-31') AS full_year_quarters;
full_year_quarters
3
SELECT TIMESTAMPDIFF(WEEK, '2024-01-01', '2024-12-31') AS full_year_weeks;
full_year_weeks
52
SELECT TIMESTAMPDIFF(DAY, NULL, '2024-12-21') AS null_first;
null_first
null
SELECT TIMESTAMPDIFF(DAY, '2024-12-20', NULL) AS null_second;
null_second
null
SELECT TIMESTAMPDIFF(DAY, NULL, NULL) AS null_both;
null_both
null
SELECT TIMESTAMPDIFF(HOUR, NULL, '2024-12-20 12:00:00') AS null_first_hour;
null_first_hour
null
SELECT TIMESTAMPDIFF(MONTH, '2024-01-01', NULL) AS null_second_month;
null_second_month
null
CREATE TABLE t1(id INT, d1 DATE);
CREATE TABLE t2(id INT, d2 DATE);
INSERT INTO t1 VALUES (1, '2024-01-01'), (2, '2024-06-01');
INSERT INTO t2 VALUES (1, '2024-12-31'), (2, '2024-12-31');
SELECT t1.d1, t2.d2, TIMESTAMPDIFF(DAY, t1.d1, t2.d2) AS diff_days
FROM t1 JOIN t2 ON t1.id = t2.id;
d1    d2    diff_days
2024-01-01    2024-12-31    365
2024-06-01    2024-12-31    213
DROP TABLE t1;
DROP TABLE t2;
SELECT * FROM (
SELECT TIMESTAMPDIFF(DAY, '2024-01-01', '2024-12-31') AS days_in_year
) AS subquery;
days_in_year
365
CREATE TABLE t1(d1 DATE, d2 DATE, category VARCHAR(10));
INSERT INTO t1 VALUES ('2024-01-01', '2024-12-31', 'A'),
('2024-06-01', '2024-12-31', 'A'),
('2024-01-01', '2024-06-30', 'B');
SELECT category, AVG(TIMESTAMPDIFF(DAY, d1, d2)) AS avg_diff_days FROM t1 GROUP BY category;
category    avg_diff_days
A    289.0000
B    181.0000
DROP TABLE t1;
CREATE TABLE t1(d1 DATE, d2 DATE);
INSERT INTO t1 VALUES ('2024-12-20', '2024-12-25'), ('2024-01-01', '2024-12-31'), ('2024-06-15', '2024-06-20');
SELECT d1, d2, TIMESTAMPDIFF(DAY, d1, d2) AS d_diff FROM t1 ORDER BY TIMESTAMPDIFF(DAY, d1, d2);
d1    d2    d_diff
2024-12-20    2024-12-25    5
2024-06-15    2024-06-20    5
2024-01-01    2024-12-31    365
DROP TABLE t1;
SELECT TIMESTAMPDIFF(YEAR, '1999-12-31', '2000-01-01') AS century_boundary;
century_boundary
0
SELECT TIMESTAMPDIFF(DAY, '1999-12-31', '2000-01-01') AS century_boundary_day;
century_boundary_day
1
SELECT TIMESTAMPDIFF(YEAR, '1899-12-31', '1900-01-01') AS previous_century;
previous_century
0
SELECT TIMESTAMPDIFF(DAY, '1999-12-31', '2000-01-01') AS y2k_day;
y2k_day
1
SELECT TIMESTAMPDIFF(YEAR, '1999-01-01', '2000-01-01') AS y2k_year;
y2k_year
1
SELECT TIMESTAMPDIFF(DAY, '2100-02-28', '2100-03-01') AS year_2100_feb_to_mar;
year_2100_feb_to_mar
1
SELECT TIMESTAMPDIFF(YEAR, '2099-12-31', '2100-01-01') AS year_2100_boundary;
year_2100_boundary
0
SELECT TIMESTAMPDIFF(DAY, '2400-02-28', '2400-03-01') AS year_2400_feb_to_mar;
year_2400_feb_to_mar
2
SELECT TIMESTAMPDIFF(DAY, '2400-02-29', '2400-03-01') AS year_2400_leap_day;
year_2400_leap_day
1
SELECT TIMESTAMPDIFF(WEEK, '2024-12-16', '2024-12-23') AS exactly_one_week;
exactly_one_week
1
SELECT TIMESTAMPDIFF(WEEK, '2024-12-16', '2024-12-30') AS two_weeks;
two_weeks
2
SELECT TIMESTAMPDIFF(DAY, '2024-12-16', '2024-12-23') AS one_week_in_days;
one_week_in_days
7
SELECT TIMESTAMPDIFF(WEEK, '2024-01-01', '2024-01-08') AS week_start_of_year;
week_start_of_year
1
SELECT TIMESTAMPDIFF(QUARTER, '2024-01-01', '2024-04-01') AS q1_to_q2;
q1_to_q2
1
SELECT TIMESTAMPDIFF(QUARTER, '2024-03-31', '2024-04-01') AS q1_to_q2_boundary;
q1_to_q2_boundary
0
SELECT TIMESTAMPDIFF(QUARTER, '2024-01-01', '2024-12-31') AS full_year_quarters;
full_year_quarters
3
SELECT TIMESTAMPDIFF(QUARTER, '2024-01-01', '2025-01-01') AS cross_year_quarter;
cross_year_quarter
4
SELECT TIMESTAMPDIFF(DAY, '2024-12-20T10:30:45', '2024-12-21T10:30:45') AS iso_format_day;
iso_format_day
1
SELECT TIMESTAMPDIFF(HOUR, '2024-12-20T10:30:45', '2024-12-20T11:30:45') AS iso_format_hour;
iso_format_hour
1
SELECT TIMESTAMPDIFF(MICROSECOND, '2024-12-20T10:30:45.123456', '2024-12-20T10:30:45.654321') AS iso_format_microsecond;
iso_format_microsecond
530865
SELECT TIMESTAMPDIFF(DAY, '2024-12-20', '2024-12-21') AS date_string_format;
date_string_format
1
SELECT TIMESTAMPDIFF(DAY, '2024-12-20 10:30:45', '2024-12-21 10:30:45') AS datetime_string_format;
datetime_string_format
1
SELECT TIMESTAMPDIFF(HOUR, '2024-12-20 10:00:00', '2024-12-20 12:00:00') AS time_part_only;
time_part_only
2
