drop table if exists jrt;
create table jrt (
id int,
b bool, i int, bi bigint, f float, d double,
d64 decimal(10, 3), d128 decimal(30, 10),
c1 char(1), c2 char(10), vc varchar(100), t text,
td date, tt time, tdt datetime,
js json
);
insert into jrt values
(1, true, 1, 11111111111111, 0.1, 0.2222222, 3.14, 3.14159265359, 'a', 'aaa', 'vvvv', 'tttttttt', '2021-02-01', '11:11:11', '2021-02-01 11:11:11', '{"foo": "bar", "zoo": [1, 2, 3]}'),
(2, false, 1, 11111111111111, 0.1, 0.2222222, 3.14, 3.14159265359, 'a', 'aaa', 'v\vvv', 'ttt"ttttt', '2021-02-01', '11:11:11', '2021-02-01 11:11:11', '{"foo": "bar", "zoo": [1, 2, 3]}'),
(3, true, 1, 11111111111111, 0.1, 0.2222222, 3.14, 3.14159265359, 'a', 'aaa', 'v\\vvv', 'tttt""tttt', '2021-02-01', '11:11:11', '2021-02-01 11:11:11', '{"foo": "bar", "zoo": [1, 2, 3]}'),
(4, true, 1, 11111111111111, 0.1, 0.2222222, 3.14, 3.14159265359, 'a', 'aaa', 'v\\\vvv', 'tttt"""tttt', '2021-02-01', '11:11:11', '2021-02-01 11:11:11', '{"foo": "bar", "zoo": [1, 2, 3]}'),
(5, true, 1, 11111111111111, 0.1, 0.2222222, 3.14, 3.14159265359, 'a', 'aaa', 'v\\\\vvv', 'tttt""""tttt', '2021-02-01', '11:11:11', '2021-02-01 11:11:11', '{"foo": "bar", "zoo": [1, 2, 3]}'),
(6, true, 1, 11111111111111, 0.1, 0.2222222, 3.14, 3.14159265359, 'a', 'aaa', 'vv\nvv', 'tttt''tttt', '2021-02-01', '11:11:11', '2021-02-01 11:11:11', '{"foo": "bar", "zoo": [1, 2, 3]}'),
(7, true, 1, 11111111111111, 0.1, 0.2222222, 3.14, 3.14159265359, 'a', 'aaa', 'vv\n\nvv', 'tttt''''tttt', '2021-02-01', '11:11:11', '2021-02-01 11:11:11', '{"foo": "bar", "zoo": [1, 2, 3]}'),
(8, true, 1, 11111111111111, 0.1, 0.2222222, 3.14, 3.14159265359, 'a', 'aaa', 'v{vvv', 'tttt}tttt', '2021-02-01', '11:11:11', '2021-02-01 11:11:11', '{"foo": "bar", "zoo": [1, 2, 3]}'),
(9, true, 1, 11111111111111, 0.1, 0.2222222, 3.14, 3.14159265359, 'a', 'aaa', 'v{{vvv', 'ttt}ttttt', '2021-02-01', '11:11:11', '2021-02-01 11:11:11', '{"foo": "bar", "zoo": [1, 2, 3]}'),
(10, true, 1, 11111111111111, 0.1, 0.2222222, 3.14, 3.14159265359, 'a', 'aaa', 'vvvv', 'tttttttt[[[[', '2021-02-01', '11:11:11', '2021-02-01 11:11:11', '{"foo": "bar", "zoo": [1, 2, 3]}'),
(11, true, 1, 11111111111111, 0.1, 0.2222222, 3.14, 3.14159265359, 'a', 'aaa', 'vvvv', 'tttttttt]]]]', '2021-02-01', '11:11:11', '2021-02-01 11:11:11', '{"foo": "bar", "zoo": [1, 2, 3]}'),
(12, true, 1, 11111111111111, 0.1, 0.2222222, 3.14, 3.14159265359, 'a', 'aaa', 'vvvv', 'tttttttt', '2021-02-01', '11:11:11', '2021-02-01 11:11:11', '{"foo": "bar", "zoo": [1, 2, 3]}'),
(13, true, 1, 11111111111111, 0.1, 0.2222222, 3.14, 3.14159265359, 'a', 'aaa', 'vvvv', 'tttttttt', '2021-02-01', '11:11:11', '2021-02-01 11:11:11', '{"foo": "bar", "zoo": [1, 2, 3]}'),
(14, false, 1, 11111111111111, 0.1, 0.2222222, 3.14, 3.14159265359, 'a', 'aaa', 'vvvv', 'tttttttt', '2021-02-01', '11:11:11', '2021-02-01 11:11:11', '{"foo": "bar", "zoo": [1, 2, 3]}'),
(15, true, 1, 11111111111111, 0.1, 0.2222222, 3.14, 3.14159265359, 'a', 'aaa', 'vvvv', 'tttttttt', '2021-02-01', '11:11:11', '2021-02-01 11:11:11', '{"foo": "bar", "zoo": [1, 2, 3]}'),
(16, true, 1, 11111111111111, 0.1, 0.2222222, 3.14, 3.14159265359, 'a', 'aaa', 'vvvv', 'tttttttt', '2021-02-01', '11:11:11', '2021-02-01 11:11:11', '{"foo": "bar", "zoo": [1, 2, 3]}'),
(17, true, 1, 11111111111111, 0.1, 0.2222222, 3.14, 3.14159265359, 'a', 'aaa', 'vvvv', 'tttttttt', '2021-02-01', '11:11:11', '2021-02-01 11:11:11', '{"foo": "bar", "zoo": [1, 2, 3]}'),
(18, true, 1, 11111111111111, 0.1, 0.2222222, 3.14, 3.14159265359, 'a', 'aaa', 'vvvv', 'tttttttt', '2021-02-01', '11:11:11', '2021-02-01 11:11:11', '{"foo": "bar", "zoo": [1, 2, 3]}'),
(19, true, 1, 11111111111111, 0.1, 0.2222222, 3.14, 3.14159265359, 'a', 'aaa', 'vvvv', 'tttttttt', '2021-02-01', '11:11:11', '2021-02-01 11:11:11', '{"foo": "bar", "zoo": [1, 2, 3]}'),
(1000, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null)
;
select count(*) from jrt;
count(*)
20
select id, cast(json_row(b, i, bi, f, d) as json) from jrt;
id    cast(json_row(b, i, bi, f, d) as json)
1    [true, 1, 11111111111111, 0.10000000149011612, 0.2222222]
2    [false, 1, 11111111111111, 0.10000000149011612, 0.2222222]
3    [true, 1, 11111111111111, 0.10000000149011612, 0.2222222]
4    [true, 1, 11111111111111, 0.10000000149011612, 0.2222222]
5    [true, 1, 11111111111111, 0.10000000149011612, 0.2222222]
6    [true, 1, 11111111111111, 0.10000000149011612, 0.2222222]
7    [true, 1, 11111111111111, 0.10000000149011612, 0.2222222]
8    [true, 1, 11111111111111, 0.10000000149011612, 0.2222222]
9    [true, 1, 11111111111111, 0.10000000149011612, 0.2222222]
10    [true, 1, 11111111111111, 0.10000000149011612, 0.2222222]
11    [true, 1, 11111111111111, 0.10000000149011612, 0.2222222]
12    [true, 1, 11111111111111, 0.10000000149011612, 0.2222222]
13    [true, 1, 11111111111111, 0.10000000149011612, 0.2222222]
14    [false, 1, 11111111111111, 0.10000000149011612, 0.2222222]
15    [true, 1, 11111111111111, 0.10000000149011612, 0.2222222]
16    [true, 1, 11111111111111, 0.10000000149011612, 0.2222222]
17    [true, 1, 11111111111111, 0.10000000149011612, 0.2222222]
18    [true, 1, 11111111111111, 0.10000000149011612, 0.2222222]
19    [true, 1, 11111111111111, 0.10000000149011612, 0.2222222]
1000    [null, null, null, null, null]
select id, cast(json_row(d64, d128, d64-d128, d128-d64) as json) from jrt;
id    cast(json_row(d64, d128, d64 - d128, d128 - d64) as json)
1    [3.14, 3.1415926536, -0.0015926536, 0.0015926536]
2    [3.14, 3.1415926536, -0.0015926536, 0.0015926536]
3    [3.14, 3.1415926536, -0.0015926536, 0.0015926536]
4    [3.14, 3.1415926536, -0.0015926536, 0.0015926536]
5    [3.14, 3.1415926536, -0.0015926536, 0.0015926536]
6    [3.14, 3.1415926536, -0.0015926536, 0.0015926536]
7    [3.14, 3.1415926536, -0.0015926536, 0.0015926536]
8    [3.14, 3.1415926536, -0.0015926536, 0.0015926536]
9    [3.14, 3.1415926536, -0.0015926536, 0.0015926536]
10    [3.14, 3.1415926536, -0.0015926536, 0.0015926536]
11    [3.14, 3.1415926536, -0.0015926536, 0.0015926536]
12    [3.14, 3.1415926536, -0.0015926536, 0.0015926536]
13    [3.14, 3.1415926536, -0.0015926536, 0.0015926536]
14    [3.14, 3.1415926536, -0.0015926536, 0.0015926536]
15    [3.14, 3.1415926536, -0.0015926536, 0.0015926536]
16    [3.14, 3.1415926536, -0.0015926536, 0.0015926536]
17    [3.14, 3.1415926536, -0.0015926536, 0.0015926536]
18    [3.14, 3.1415926536, -0.0015926536, 0.0015926536]
19    [3.14, 3.1415926536, -0.0015926536, 0.0015926536]
1000    [null, null, null, null]
select id, cast(json_row(c1, c2, vc, t) as json) from jrt;
id    cast(json_row(c1, c2, vc, t) as json)
1    ["a", "aaa", "vvvv", "tttttttt"]
2    ["a", "aaa", "vvvv", "ttt\"ttttt"]
3    ["a", "aaa", "v\\vvv", "tttt\"\"tttt"]
4    ["a", "aaa", "v\\vvv", "tttt\"\"\"tttt"]
5    ["a", "aaa", "v\\\\vvv", "tttt\"\"\"\"tttt"]
6    ["a", "aaa", "vv\nvv", "tttt'tttt"]
7    ["a", "aaa", "vv\n\nvv", "tttt''tttt"]
8    ["a", "aaa", "v{vvv", "tttt}tttt"]
9    ["a", "aaa", "v{{vvv", "ttt}ttttt"]
10    ["a", "aaa", "vvvv", "tttttttt[[[["]
11    ["a", "aaa", "vvvv", "tttttttt]]]]"]
12    ["a", "aaa", "vvvv", "tttttttt"]
13    ["a", "aaa", "vvvv", "tttttttt"]
14    ["a", "aaa", "vvvv", "tttttttt"]
15    ["a", "aaa", "vvvv", "tttttttt"]
16    ["a", "aaa", "vvvv", "tttttttt"]
17    ["a", "aaa", "vvvv", "tttttttt"]
18    ["a", "aaa", "vvvv", "tttttttt"]
19    ["a", "aaa", "vvvv", "tttttttt"]
1000    [null, null, null, null]
select id, cast(json_row(td, tt, tdt) as json) from jrt;
id    cast(json_row(td, tt, tdt) as json)
1    ["2021-02-01", "11:11:11", "2021-02-01 11:11:11"]
2    ["2021-02-01", "11:11:11", "2021-02-01 11:11:11"]
3    ["2021-02-01", "11:11:11", "2021-02-01 11:11:11"]
4    ["2021-02-01", "11:11:11", "2021-02-01 11:11:11"]
5    ["2021-02-01", "11:11:11", "2021-02-01 11:11:11"]
6    ["2021-02-01", "11:11:11", "2021-02-01 11:11:11"]
7    ["2021-02-01", "11:11:11", "2021-02-01 11:11:11"]
8    ["2021-02-01", "11:11:11", "2021-02-01 11:11:11"]
9    ["2021-02-01", "11:11:11", "2021-02-01 11:11:11"]
10    ["2021-02-01", "11:11:11", "2021-02-01 11:11:11"]
11    ["2021-02-01", "11:11:11", "2021-02-01 11:11:11"]
12    ["2021-02-01", "11:11:11", "2021-02-01 11:11:11"]
13    ["2021-02-01", "11:11:11", "2021-02-01 11:11:11"]
14    ["2021-02-01", "11:11:11", "2021-02-01 11:11:11"]
15    ["2021-02-01", "11:11:11", "2021-02-01 11:11:11"]
16    ["2021-02-01", "11:11:11", "2021-02-01 11:11:11"]
17    ["2021-02-01", "11:11:11", "2021-02-01 11:11:11"]
18    ["2021-02-01", "11:11:11", "2021-02-01 11:11:11"]
19    ["2021-02-01", "11:11:11", "2021-02-01 11:11:11"]
1000    [null, null, null]
select id, cast(json_row(id, js) as json) from jrt;
id    cast(json_row(id, js) as json)
1    [1, {"foo": "bar", "zoo": [1, 2, 3]}]
2    [2, {"foo": "bar", "zoo": [1, 2, 3]}]
3    [3, {"foo": "bar", "zoo": [1, 2, 3]}]
4    [4, {"foo": "bar", "zoo": [1, 2, 3]}]
5    [5, {"foo": "bar", "zoo": [1, 2, 3]}]
6    [6, {"foo": "bar", "zoo": [1, 2, 3]}]
7    [7, {"foo": "bar", "zoo": [1, 2, 3]}]
8    [8, {"foo": "bar", "zoo": [1, 2, 3]}]
9    [9, {"foo": "bar", "zoo": [1, 2, 3]}]
10    [10, {"foo": "bar", "zoo": [1, 2, 3]}]
11    [11, {"foo": "bar", "zoo": [1, 2, 3]}]
12    [12, {"foo": "bar", "zoo": [1, 2, 3]}]
13    [13, {"foo": "bar", "zoo": [1, 2, 3]}]
14    [14, {"foo": "bar", "zoo": [1, 2, 3]}]
15    [15, {"foo": "bar", "zoo": [1, 2, 3]}]
16    [16, {"foo": "bar", "zoo": [1, 2, 3]}]
17    [17, {"foo": "bar", "zoo": [1, 2, 3]}]
18    [18, {"foo": "bar", "zoo": [1, 2, 3]}]
19    [19, {"foo": "bar", "zoo": [1, 2, 3]}]
1000    [1000, null]
select id, cast(json_row(null, js) as json) from jrt;
id    cast(json_row(null, js) as json)
1    [null, {"foo": "bar", "zoo": [1, 2, 3]}]
2    [null, {"foo": "bar", "zoo": [1, 2, 3]}]
3    [null, {"foo": "bar", "zoo": [1, 2, 3]}]
4    [null, {"foo": "bar", "zoo": [1, 2, 3]}]
5    [null, {"foo": "bar", "zoo": [1, 2, 3]}]
6    [null, {"foo": "bar", "zoo": [1, 2, 3]}]
7    [null, {"foo": "bar", "zoo": [1, 2, 3]}]
8    [null, {"foo": "bar", "zoo": [1, 2, 3]}]
9    [null, {"foo": "bar", "zoo": [1, 2, 3]}]
10    [null, {"foo": "bar", "zoo": [1, 2, 3]}]
11    [null, {"foo": "bar", "zoo": [1, 2, 3]}]
12    [null, {"foo": "bar", "zoo": [1, 2, 3]}]
13    [null, {"foo": "bar", "zoo": [1, 2, 3]}]
14    [null, {"foo": "bar", "zoo": [1, 2, 3]}]
15    [null, {"foo": "bar", "zoo": [1, 2, 3]}]
16    [null, {"foo": "bar", "zoo": [1, 2, 3]}]
17    [null, {"foo": "bar", "zoo": [1, 2, 3]}]
18    [null, {"foo": "bar", "zoo": [1, 2, 3]}]
19    [null, {"foo": "bar", "zoo": [1, 2, 3]}]
1000    [null, null]
select 'agg';
agg
agg
select count(*), cast('[' || group_concat(json_row(id, bi, d, d128, t, js)) || ']' as json) from jrt;
count(*)    cast(concat(concat([, group_concat(json_row(id, bi, d, d128, t, js), ,)), ]) as json)
20    [[1, 11111111111111, 0.2222222, 3.1415926536, "tttttttt", {"foo": "bar", "zoo": [1, 2, 3]}], [2, 11111111111111, 0.2222222, 3.1415926536, "ttt\"ttttt", {"foo": "bar", "zoo": [1, 2, 3]}], [3, 11111111111111, 0.2222222, 3.1415926536, "tttt\"\"tttt", {"foo": "bar", "zoo": [1, 2, 3]}], [4, 11111111111111, 0.2222222, 3.1415926536, "tttt\"\"\"tttt", {"foo": "bar", "zoo": [1, 2, 3]}], [5, 11111111111111, 0.2222222, 3.1415926536, "tttt\"\"\"\"tttt", {"foo": "bar", "zoo": [1, 2, 3]}], [6, 11111111111111, 0.2222222, 3.1415926536, "tttt'tttt", {"foo": "bar", "zoo": [1, 2, 3]}], [7, 11111111111111, 0.2222222, 3.1415926536, "tttt''tttt", {"foo": "bar", "zoo": [1, 2, 3]}], [8, 11111111111111, 0.2222222, 3.1415926536, "tttt}tttt", {"foo": "bar", "zoo": [1, 2, 3]}], [9, 11111111111111, 0.2222222, 3.1415926536, "ttt}ttttt", {"foo": "bar", "zoo": [1, 2, 3]}], [10, 11111111111111, 0.2222222, 3.1415926536, "tttttttt[[[[", {"foo": "bar", "zoo": [1, 2, 3]}], [11, 11111111111111, 0.2222222, 3.1415926536, "tttttttt]]]]", {"foo": "bar", "zoo": [1, 2, 3]}], [12, 11111111111111, 0.2222222, 3.1415926536, "tttttttt", {"foo": "bar", "zoo": [1, 2, 3]}]]
select b, count(*), '[' || group_concat(json_row(id)) || ']' as js from jrt group by b;
b    count(*)    js
true    17    [[1],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[15],[16],[17],[18],[19]]
false    2    [[2],[14]]
null    1    [[1000]]
select b, '[' || json_row(id, bi, d, d128, t, js) || ']' as js from jrt where b = false;
b    js
false    [[2,11111111111111,0.2222222,3.1415926536,"ttt\"ttttt",{"foo": "bar", "zoo": [1, 2, 3]}]]
false    [[14,11111111111111,0.2222222,3.1415926536,"tttttttt",{"foo": "bar", "zoo": [1, 2, 3]}]]
select b, count(*), '[' || group_concat(json_row(id, bi, d, d128, t, js)) || ']' as js from jrt group by b;
b    count(*)    js
true    17    [[1,11111111111111,0.2222222,3.1415926536,"tttttttt",{"foo": "bar", "zoo": [1, 2, 3]}],[3,11111111111111,0.2222222,3.1415926536,"tttt\"\"tttt",{"foo": "bar", "zoo": [1, 2, 3]}],[4,11111111111111,0.2222222,3.1415926536,"tttt\"\"\"tttt",{"foo": "bar", "zoo": [1, 2, 3]}],[5,11111111111111,0.2222222,3.1415926536,"tttt\"\"\"\"tttt",{"foo": "bar", "zoo": [1, 2, 3]}],[6,11111111111111,0.2222222,3.1415926536,"tttt'tttt",{"foo": "bar", "zoo": [1, 2, 3]}],[7,11111111111111,0.2222222,3.1415926536,"tttt''tttt",{"foo": "bar", "zoo": [1, 2, 3]}],[8,11111111111111,0.2222222,3.1415926536,"tttt}tttt",{"foo": "bar", "zoo": [1, 2, 3]}],[9,11111111111111,0.2222222,3.1415926536,"ttt}ttttt",{"foo": "bar", "zoo": [1, 2, 3]}],[10,11111111111111,0.2222222,3.1415926536,"tttttttt[[[[",{"foo": "bar", "zoo": [1, 2, 3]}],[11,11111111111111,0.2222222,3.1415926536,"tttttttt]]]]",{"foo": "bar", "zoo": [1, 2, 3]}],[12,11111111111111,0.2222222,3.1415926536,"tttttttt",{"foo": "bar", "zoo": [1, 2, 3]}],[13,11111111111111,0.2222222,3.1415926536,"tttttttt",{"foo": "bar", "zoo": [1, 2, 3]}]]
false    2    [,[3,11111111111111,0.2222222,3.1415926536,"tttt\"\"tttt",{"foo": "bar", "zoo": [1, 2, 3,[14,11111111111111,0.2222222,3.1415926536,"tttttttt",{"foo": "bar", "zoo": [1, 2, 3]}]]
null    1    [[1000,null,null,null,null,null]]
select b, '[' || group_concat(t, t, t, t, t) || ']' as js from jrt group by b;
b    js
true    [tttttttttttttttttttttttttttttttttttttttt,tttt""tttttttt""tttttttt""tttttttt""tttttttt""tttt,tttt"""tttttttt"""tttttttt"""tttttttt"""tttttttt"""tttt,tttt""""tttttttt""""tttttttt""""tttttttt""""tttttttt""""tttt,tttt'tttttttt'tttttttt'tttttttt'tttttttt'tttt,tttt''tttttttt''tttttttt''tttttttt''tttttttt''tttt,tttt}tttttttt}tttttttt}tttttttt}tttttttt}tttt,ttt}tttttttt}tttttttt}tttttttt}tttttttt}ttttt,tttttttt[[[[tttttttt[[[[tttttttt[[[[tttttttt[[[[tttttttt[[[[,tttttttt]]]]tttttttt]]]]tttttttt]]]]tttttttt]]]]tttttttt]]]],tttttttttttttttttttttttttttttttttttttttt,tttttttttttttttttttttttttttttttttttttttt,tttttttttttttttttttttttttttttttttttttttt,tttttttttttttttttttttttttttttttttttttttt,tttttttttttttttttttttttttttttttttttttttt,tttttttttttttttttttttttttttttttttttttttt,tttttttttttttttttttttttttttttttttttttttt]
false    [,tttttttttttttttttttttttttttttttttttttttttttt,tttttttttttttttttttttttttttttttttttttttt]
null    null
select json_row(id, cast(vc as varbinary)) from jrt;
invalid input: binary data not supported json_row: VARBINARY
drop table jrt;
