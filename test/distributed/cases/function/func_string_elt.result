SELECT ELT(1, 'ej', 'Heja', 'hej', 'foo') AS result1;
result1
ej
SELECT ELT(1, 'ej', 'Heja', 'hej', 'foo') AS elt1;
elt1
ej
SELECT ELT(2, 'ej', 'Heja', 'hej', 'foo') AS elt2;
elt2
Heja
SELECT ELT(3, 'ej', 'Heja', 'hej', 'foo') AS elt3;
elt3
hej
SELECT ELT(4, 'ej', 'Heja', 'hej', 'foo') AS elt4;
elt4
foo
SELECT ELT(0, 'ej', 'Heja', 'hej', 'foo') AS elt0;
elt0
null
SELECT ELT(5, 'ej', 'Heja', 'hej', 'foo') AS elt5;
elt5
null
SELECT ELT(-1, 'ej', 'Heja', 'hej', 'foo') AS elt_neg;
elt_neg
null
SELECT ELT(NULL, 'ej', 'Heja', 'hej', 'foo') AS elt_null;
elt_null
null
SELECT ELT(1, NULL, 'Heja', 'hej', 'foo') AS elt_str_null;
elt_str_null
null
SELECT ELT(2, 'ej', NULL, 'hej', 'foo') AS elt_str_null2;
elt_str_null2
null
SELECT ELT(1, 'single') AS elt_single;
elt_single
single
CREATE TABLE t1(id INT, s1 VARCHAR(10), s2 VARCHAR(10), s3 VARCHAR(10));
INSERT INTO t1 VALUES (1, 'a', 'b', 'c'), (2, 'x', 'y', 'z'), (3, '1', '2', '3');
SELECT id, ELT(id, s1, s2, s3) AS elt_result FROM t1;
internal error: panic type mismatch: casting INT vector to []int64: 
github.com/matrixorigin/matrixone/pkg/container/vector.checkType[...]
	/home/fengttt/m/matrixone/pkg/container/vector/vector.go:107
github.com/matrixorigin/matrixone/pkg/container/vector.ToSlice[...]
	/home/fengttt/m/matrixone/pkg/container/vector/vector.go:101
github.com/matrixorigin/matrixone/pkg/container/vector.ToFixedCol[...]
	/home/fengttt/m/matrixone/pkg/container/vector/tools.go:42
github.com/matrixorigin/matrixone/pkg/container/vector.MustFixedColWithTypeCheck[...]
	/home/fengttt/m/matrixone/pkg/container/vector/tools.go:56
github.com/matrixorigin/matrixone/pkg/container/vector.GenerateFunctionFixedTypeParameter[...]
	/home/fengttt/m/matrixone/pkg/container/vector/functionTools.go:67
github.com/matrixorigin/matrixone/pkg/sql/plan/function.Elt
	/home/fengttt/m/matrixone/pkg/sql/plan/function/func_binary.go:3166
github.com/matrixorigin/matrixone/pkg/sql/colexec.(*FunctionExpressionExecutor).Eval
	/home/fengttt/m/matrixone/pkg/sql/colexec/evalExpression.go:633
github.com/matrixorigin/matrixone/pkg/sql/colexec/projection.(*Projection).Call
	/home/fengttt/m/matrixone/pkg/sql/colexec/projection/projection.go:76
github.com/matrixorigin/matrixone/pkg/vm.Exec
	/home/fengttt/m/matrixone/pkg/vm/types.go:514
github.com/matrixorigin/matrixone/pkg/vm.ChildrenCall
	/home/fengttt/m/matrixone/pkg/vm/types.go:525
github.com/matrixorigin/matrixone/pkg/sql/colexec/output.(*Output).Call
	/home/fengttt/m/matrixone/pkg/sql/colexec/output/output.go:55
github.com/matrixorigin/matrixone/pkg/vm.Exec
	/home/fengttt/m/matrixone/pkg/vm/types.go:514
github.com/matrixorigin/matrixone/pkg/vm/pipeline.(*Pipeline).Run
	/home/fengttt/m/matrixone/pkg/vm/pipeline/pipeline.go:71
github.com/matrixorigin/matrixone/pkg/vm/pipeline.(*Pipeline).RunWithReader
	/home/fengttt/m/matrixone/pkg/vm/pipeline/pipeline.go:59
github.com/matrixorigin/matrixone/pkg/sql/compile.(*Scope).Run
	/home/fengttt/m/matrixone/pkg/sql/compile/scope.go:198
github.com/matrixorigin/matrixone/pkg/sql/compile.(*Scope).ParallelRun
	/home/fengttt/m/matrixone/pkg/sql/compile/scope.go:490
github.com/matrixorigin/matrixone/pkg/sql/compile.(*Scope).MergeRun
	/home/fengttt/m/matrixone/pkg/sql/compile/scope.go:276
github.com/matrixorigin/matrixone/pkg/sql/compile.(*Scope).RemoteRun
	/home/fengttt/m/matrixone/pkg/sql/compile/scope.go:395
github.com/matrixorigin/matrixone/pkg/sql/compile.(*Compile).run
	/home/fengttt/m/matrixone/pkg/sql/compile/compile.go:375
github.com/matrixorigin/matrixone/pkg/sql/compile.(*Compile).runOnce
	/home/fengttt/m/matrixone/pkg/sql/compile/compile.go:522
github.com/matrixorigin/matrixone/pkg/sql/compile.(*Compile).Run
	/home/fengttt/m/matrixone/pkg/sql/compile/compile2.go:250
github.com/matrixorigin/matrixone/pkg/frontend.executeResultRowStmt
	/home/fengttt/m/matrixone/pkg/frontend/result_row_stmt.go:87
github.com/matrixorigin/matrixone/pkg/frontend.executeStmt
	/home/fengttt/m/matrixone/pkg/frontend/mysql_cmd_executor.go:2994
github.com/matrixorigin/matrixone/pkg/frontend.dispatchStmt
	/home/fengttt/m/matrixone/pkg/frontend/mysql_cmd_executor.go:2847
github.com/matrixorigin/matrixone/pkg/frontend.executeStmtWithIncrStmt
	/home/fengttt/m/matrixone/pkg/frontend/mysql_cmd_executor.go:2812
github.com/matrixorigin/matrixone/pkg/frontend.executeStmtWithWorkspace
	/home/fengttt/m/matrixone/pkg/frontend/mysql_cmd_executor.go:2756
github.com/matrixorigin/matrixone/pkg/frontend.executeStmtWithTxn
	/home/fengttt/m/matrixone/pkg/frontend/mysql_cmd_executor.go:2631
github.com/matrixorigin/matrixone/pkg/frontend.executeStmtWithResponse
	/home/fengttt/m/matrixone/pkg/frontend/mysql_cmd_executor.go:2594
github.com/matrixorigin/matrixone/pkg/frontend.doComQuery
	/home/fengttt/m/matrixone/pkg/frontend/mysql_cmd_executor.go:3237
github.com/matrixorigin/matrixone/pkg/frontend.ExecRequest
	/home/fengttt/m/matrixone/pkg/frontend/mysql_cmd_executor.go:3317
github.com/matrixorigin/matrixone/pkg/frontend.(*Routine).handleRequest
	/home/fengttt/m/matrixone/pkg/frontend/routine.go:298
github.com/matrixorigin/matrixone/pkg/frontend.(*RoutineManager).Handler
	/home/fengttt/m/matrixone/pkg/frontend/routine_manager.go:384
DROP TABLE t1;
CREATE TABLE t1(id INT, s1 VARCHAR(10), s2 VARCHAR(10));
INSERT INTO t1 VALUES (1, 'a', 'b'), (2, 'x', 'y'), (3, '1', '2');
SELECT * FROM t1 WHERE ELT(1, s1, s2) = 'a';
id    s1    s2
1    a    b
DROP TABLE t1;
SELECT ELT(1, 'a', 'b', 'c') AS int64_index;
int64_index
a
SELECT ELT(CAST(2 AS INT), 'a', 'b', 'c') AS int_index;
internal error: panic type mismatch: casting INT vector to []int64: 
github.com/matrixorigin/matrixone/pkg/container/vector.checkType[...]
	/home/fengttt/m/matrixone/pkg/container/vector/vector.go:107
github.com/matrixorigin/matrixone/pkg/container/vector.ToSlice[...]
	/home/fengttt/m/matrixone/pkg/container/vector/vector.go:101
github.com/matrixorigin/matrixone/pkg/container/vector.ToFixedCol[...]
	/home/fengttt/m/matrixone/pkg/container/vector/tools.go:42
github.com/matrixorigin/matrixone/pkg/container/vector.MustFixedColWithTypeCheck[...]
	/home/fengttt/m/matrixone/pkg/container/vector/tools.go:56
github.com/matrixorigin/matrixone/pkg/container/vector.GenerateFunctionFixedTypeParameter[...]
	/home/fengttt/m/matrixone/pkg/container/vector/functionTools.go:67
github.com/matrixorigin/matrixone/pkg/sql/plan/function.Elt
	/home/fengttt/m/matrixone/pkg/sql/plan/function/func_binary.go:3166
github.com/matrixorigin/matrixone/pkg/sql/colexec.(*FunctionExpressionExecutor).doFold
	/home/fengttt/m/matrixone/pkg/sql/colexec/evalExpressionReset.go:171
github.com/matrixorigin/matrixone/pkg/sql/colexec.(*FunctionExpressionExecutor).Eval
	/home/fengttt/m/matrixone/pkg/sql/colexec/evalExpression.go:576
github.com/matrixorigin/matrixone/pkg/sql/colexec.getReadonlyResultFromExpression
	/home/fengttt/m/matrixone/pkg/sql/colexec/evalExpressionOpt.go:67
github.com/matrixorigin/matrixone/pkg/sql/colexec.GetReadonlyResultFromExpression
	/home/fengttt/m/matrixone/pkg/sql/colexec/evalExpressionOpt.go:57
github.com/matrixorigin/matrixone/pkg/sql/plan/rule.(*ConstantFold).constantFold
	/home/fengttt/m/matrixone/pkg/sql/plan/rule/constant_fold.go:190
github.com/matrixorigin/matrixone/pkg/sql/plan/rule.(*ConstantFold).Apply
	/home/fengttt/m/matrixone/pkg/sql/plan/rule/constant_fold.go:80
github.com/matrixorigin/matrixone/pkg/sql/plan.(*BaseOptimizer).exploreNode
	/home/fengttt/m/matrixone/pkg/sql/plan/optimize.go:87
github.com/matrixorigin/matrixone/pkg/sql/plan.(*BaseOptimizer).optimize
	/home/fengttt/m/matrixone/pkg/sql/plan/optimize.go:73
github.com/matrixorigin/matrixone/pkg/sql/plan.(*BaseOptimizer).Optimize
	/home/fengttt/m/matrixone/pkg/sql/plan/optimize.go:65
github.com/matrixorigin/matrixone/pkg/frontend.buildPlan
	/home/fengttt/m/matrixone/pkg/frontend/mysql_cmd_executor.go:2079
github.com/matrixorigin/matrixone/pkg/frontend.(*TxnComputationWrapper).Compile
	/home/fengttt/m/matrixone/pkg/frontend/computation_wrapper.go:210
github.com/matrixorigin/matrixone/pkg/frontend.executeStmt
	/home/fengttt/m/matrixone/pkg/frontend/mysql_cmd_executor.go:2953
github.com/matrixorigin/matrixone/pkg/frontend.dispatchStmt
	/home/fengttt/m/matrixone/pkg/frontend/mysql_cmd_executor.go:2847
github.com/matrixorigin/matrixone/pkg/frontend.executeStmtWithIncrStmt
	/home/fengttt/m/matrixone/pkg/frontend/mysql_cmd_executor.go:2812
github.com/matrixorigin/matrixone/pkg/frontend.executeStmtWithWorkspace
	/home/fengttt/m/matrixone/pkg/frontend/mysql_cmd_executor.go:2756
github.com/matrixorigin/matrixone/pkg/frontend.executeStmtWithTxn
	/home/fengttt/m/matrixone/pkg/frontend/mysql_cmd_executor.go:2631
github.com/matrixorigin/matrixone/pkg/frontend.executeStmtWithResponse
	/home/fengttt/m/matrixone/pkg/frontend/mysql_cmd_executor.go:2594
github.com/matrixorigin/matrixone/pkg/frontend.doComQuery
	/home/fengttt/m/matrixone/pkg/frontend/mysql_cmd_executor.go:3237
github.com/matrixorigin/matrixone/pkg/frontend.ExecRequest
	/home/fengttt/m/matrixone/pkg/frontend/mysql_cmd_executor.go:3317
github.com/matrixorigin/matrixone/pkg/frontend.(*Routine).handleRequest
	/home/fengttt/m/matrixone/pkg/frontend/routine.go:298
github.com/matrixorigin/matrixone/pkg/frontend.(*RoutineManager).Handler
	/home/fengttt/m/matrixone/pkg/frontend/routine_manager.go:384
github.com/matrixorigin/matrixone/pkg/frontend.(*MOServer).handleRequest
	/home/fengttt/m/matrixone/pkg/frontend/server.go:527
github.com/matrixorigin/matrixone/pkg/frontend.(*MOServer).handleMessage
	/home/fengttt/m/matrixone/pkg/frontend/server.go:495
github.com/matrixorigin/matrixone/pkg/frontend.(*MOServer).handleLoop
	/home/fengttt/m/matrixone/pkg/frontend/server.go:212
github.com/matrixorigin/matrixone/pkg/frontend.(*MOServer).handleConn
	/home/fengttt/m/matrixone/pkg/frontend/server.go:208
runtime.goexit
	/usr/local/go/src/runtime/asm_amd64.s:1693
SELECT ELT(1, 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j') AS elt_many;
elt_many
a
SELECT ELT(10, 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j') AS elt_many_last;
elt_many_last
j
SELECT ELT(1, '', 'b', 'c') AS elt_empty;
elt_empty

SELECT ELT(2, 'a', '', 'c') AS elt_empty2;
elt_empty2

SELECT ELT(1, '你好', '世界', '测试') AS elt_unicode;
elt_unicode
你好
SELECT ELT(2, 'Hello', 'World', 'Test') AS elt_ascii;
elt_ascii
World
