drop database if exists d1;
create database d1;
use d1;
drop table if exists t1;
drop table if exists t2;
create table t1(c2 int, c1 int, c3 int) cluster by (c1,c2);
create table t2(c1 int, c2 int, c3 int, primary key(c1,c2));
insert into t1 select result%100,result%10000, result from generate_series(100000) g;
select count(*) from t1;
â¤ count(*)[-5,64,0]  ğ„€
100000
insert into t2 select result%100,*,* from generate_series(1000000) g;
select count(*) from t2;
â¤ count(*)[-5,64,0]  ğ„€
1000000
select mo_ctl('dn', 'flush', 'd1.t1');
â¤ mo_ctl(dn, flush, d1.t1)[12,-1,0]  ğ„€
{
  "method": "Flush",
  "result": [
    {
      "returnStr": "OK"
    }
  ]
}

select mo_ctl('dn', 'flush', 'd1.t2');
â¤ mo_ctl(dn, flush, d1.t2)[12,-1,0]  ğ„€
{
  "method": "Flush",
  "result": [
    {
      "returnStr": "OK"
    }
  ]
}

select Sleep(1);
â¤ Sleep(1)[-6,8,0]  ğ„€
0
explain select count(*) from t1 where c1 = 1;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Aggregate  ğ„€
        Aggregate Functions: starcount(1)  ğ„€
        ->  Table Scan on d1.t1  ğ„€
              Filter Cond: prefix_eq(t1.__mo_cbkey_002c1002c2)  ğ„€
              Block Filter Cond: prefix_eq(t1.__mo_cbkey_002c1002c2)
select count(*) from t1 where c1 = 1;
â¤ count(*)[-5,64,0]  ğ„€
10
explain select count(*) from t1 where c1 > 10;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Aggregate  ğ„€
        Aggregate Functions: starcount(1)  ğ„€
        ->  Table Scan on d1.t1  ğ„€
              Filter Cond: (t1.c1 > 10)  ğ„€
              Block Filter Cond: (t1.c1 > 10)
select count(*) from t1 where c1 > 10;
â¤ count(*)[-5,64,0]  ğ„€
99890
explain select count(*) from t1 where c1 in (1,2,3);
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Aggregate  ğ„€
        Aggregate Functions: starcount(1)  ğ„€
        ->  Table Scan on d1.t1  ğ„€
              Filter Cond: prefix_in(t1.__mo_cbkey_002c1002c2)  ğ„€
              Block Filter Cond: prefix_in(t1.__mo_cbkey_002c1002c2)
select count(*) from t1 where c1 in (1,2,3);
â¤ count(*)[-5,64,0]  ğ„€
30
explain select count(*) from t1 where c1 between 1 and 5;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Aggregate  ğ„€
        Aggregate Functions: starcount(1)  ğ„€
        ->  Table Scan on d1.t1  ğ„€
              Filter Cond: prefix_between(t1.__mo_cbkey_002c1002c2)  ğ„€
              Block Filter Cond: prefix_between(t1.__mo_cbkey_002c1002c2)
select count(*) from t1 where c1 between 1 and 5;
â¤ count(*)[-5,64,0]  ğ„€
50
explain select count(*) from t1 where c1 = 2 and c2 = 10;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Aggregate  ğ„€
        Aggregate Functions: starcount(1)  ğ„€
        ->  Table Scan on d1.t1  ğ„€
              Filter Cond: (t1.__mo_cbkey_002c1002c2 = )  ğ„€
              Block Filter Cond: (t1.__mo_cbkey_002c1002c2 = )
select count(*) from t1 where c1 = 2 and c2 = 10;
â¤ count(*)[-5,64,0]  ğ„€
0
explain select count(*) from t1 where c1 = 5 and c2 > 10;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Aggregate  ğ„€
        Aggregate Functions: starcount(1)  ğ„€
        ->  Table Scan on d1.t1  ğ„€
              Filter Cond: prefix_eq(t1.__mo_cbkey_002c1002c2), (t1.c2 > 10)  ğ„€
              Block Filter Cond: prefix_eq(t1.__mo_cbkey_002c1002c2), (t1.c2 > 10)
select count(*) from t1 where c1 = 5 and c2 > 10;
â¤ count(*)[-5,64,0]  ğ„€
0
explain select count(*) from t1 where c1 = 3 and c2 in (1,2,3);
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Aggregate  ğ„€
        Aggregate Functions: starcount(1)  ğ„€
        ->  Table Scan on d1.t1  ğ„€
              Filter Cond: t1.__mo_cbkey_002c1002c2 in ()  ğ„€
              Block Filter Cond: t1.__mo_cbkey_002c1002c2 in ()
select count(*) from t1 where c1 = 3 and c2 in (1,2,3);
â¤ count(*)[-5,64,0]  ğ„€
10
explain select count(*) from t1 where c1=4 and c2 between 1 and 5;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Aggregate  ğ„€
        Aggregate Functions: starcount(1)  ğ„€
        ->  Table Scan on d1.t1  ğ„€
              Filter Cond: t1.__mo_cbkey_002c1002c2 BETWEEN '::' AND '::'  ğ„€
              Block Filter Cond: t1.__mo_cbkey_002c1002c2 BETWEEN '::' AND '::'
select count(*) from t1 where c1=4 and c2 between 1 and 5;
â¤ count(*)[-5,64,0]  ğ„€
10
explain select count(*) from t2 where c1 = 1;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Aggregate  ğ„€
        Aggregate Functions: starcount(1)  ğ„€
        ->  Table Scan on d1.t2  ğ„€
              Filter Cond: prefix_eq(t2.__mo_cpkey_col)  ğ„€
              Block Filter Cond: prefix_eq(t2.__mo_cpkey_col)
select count(*) from t2 where c1 = 1;
â¤ count(*)[-5,64,0]  ğ„€
10000
explain select count(*) from t2 where c1 > 10;
â¤ AP QUERY PLAN ON ONE CN(24 core)[12,0,0]  ğ„€
Project  ğ„€
  ->  Aggregate  ğ„€
        Aggregate Functions: starcount(1)  ğ„€
        ->  Table Scan on d1.t2  ğ„€
              Filter Cond: (t2.c1 > 10)  ğ„€
              Block Filter Cond: (t2.c1 > 10)
select count(*) from t2 where c1 > 10;
â¤ count(*)[-5,64,0]  ğ„€
890000
explain select count(*) from t2 where c1 in (1,2,3);
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Aggregate  ğ„€
        Aggregate Functions: starcount(1)  ğ„€
        ->  Table Scan on d1.t2  ğ„€
              Filter Cond: prefix_in(t2.__mo_cpkey_col)  ğ„€
              Block Filter Cond: prefix_in(t2.__mo_cpkey_col)
select count(*) from t2 where c1 in (1,2,3);
â¤ count(*)[-5,64,0]  ğ„€
30000
explain select count(*) from t2 where c1 between 1 and 5;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Aggregate  ğ„€
        Aggregate Functions: starcount(1)  ğ„€
        ->  Table Scan on d1.t2  ğ„€
              Filter Cond: prefix_between(t2.__mo_cpkey_col)  ğ„€
              Block Filter Cond: prefix_between(t2.__mo_cpkey_col)
select count(*) from t2 where c1 between 1 and 5;
â¤ count(*)[-5,64,0]  ğ„€
50000
explain select count(*) from t2 where c1 = 2 and c2 = 10;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Aggregate  ğ„€
        Aggregate Functions: starcount(1)  ğ„€
        ->  Table Scan on d1.t2  ğ„€
              Filter Cond: (t2.__mo_cpkey_col = )  ğ„€
              Block Filter Cond: (t2.__mo_cpkey_col = )
select count(*) from t2 where c1 = 2 and c2 = 10;
â¤ count(*)[-5,64,0]  ğ„€
0
explain select count(*) from t2 where c1 = 5 and c2 > 10;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Aggregate  ğ„€
        Aggregate Functions: starcount(1)  ğ„€
        ->  Table Scan on d1.t2  ğ„€
              Filter Cond: prefix_eq(t2.__mo_cpkey_col), (t2.c2 > 10)  ğ„€
              Block Filter Cond: prefix_eq(t2.__mo_cpkey_col), (t2.c2 > 10)
select count(*) from t2 where c1 = 5 and c2 > 10;
â¤ count(*)[-5,64,0]  ğ„€
9999
explain select count(*) from t2 where c1 = 3 and c2 in (1,2,3);
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Aggregate  ğ„€
        Aggregate Functions: starcount(1)  ğ„€
        ->  Table Scan on d1.t2  ğ„€
              Filter Cond: t2.__mo_cpkey_col in ()  ğ„€
              Block Filter Cond: t2.__mo_cpkey_col in ()
select count(*) from t2 where c1 = 3 and c2 in (1,2,3);
â¤ count(*)[-5,64,0]  ğ„€
1
explain select count(*) from t2 where c1=4 and c2 between 1 and 5;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Aggregate  ğ„€
        Aggregate Functions: starcount(1)  ğ„€
        ->  Table Scan on d1.t2  ğ„€
              Filter Cond: t2.__mo_cpkey_col BETWEEN '::' AND '::'  ğ„€
              Block Filter Cond: t2.__mo_cpkey_col BETWEEN '::' AND '::'
select count(*) from t2 where c1=4 and c2 between 1 and 5;
â¤ count(*)[-5,64,0]  ğ„€
1
drop table if exists t1;
create table t1 (a varchar(100) primary key, b int);
insert into t1 select result, 2 from generate_series('2021-01-01 00:00:00','2022-01-01 00:00:00', '1 minute') g;
select count(*) as ttl from t1 where a between "2021-02-02 20:00:00" and "2021-02-03 00:00:00";
â¤ ttl[-5,64,0]  ğ„€
241
drop database if exists d1;
