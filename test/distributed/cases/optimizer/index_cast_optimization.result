DROP TABLE IF EXISTS t_int32;
DROP TABLE IF EXISTS t_float32;
DROP TABLE IF EXISTS t_float64;
DROP TABLE IF EXISTS t_decimal;
CREATE TABLE t_int32 (
id INT PRIMARY KEY,
val INT,
KEY idx_val (val)
);
INSERT INTO t_int32 VALUES (1, 9), (2, 10), (3, 100);
EXPLAIN SELECT * FROM t_int32 WHERE val = 9;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Index Table Scan on t_int32.idx_val  ğ„€
        Filter Cond: prefix_eq(__mo_index_idx_col)
EXPLAIN SELECT * FROM t_int32 WHERE val = 9.0;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Table Scan on index_cast_optimization.t_int32  ğ„€
        Filter Cond: (cast(t_int32.val AS DECIMAL128(38, 1)) = 9.0)
              -- HINT: Cast expression may prevent index usage
EXPLAIN SELECT * FROM t_int32 WHERE val = 9.5;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Table Scan on index_cast_optimization.t_int32  ğ„€
        Filter Cond: (cast(t_int32.val AS DECIMAL128(38, 1)) = 9.5)
              -- HINT: Cast expression may prevent index usage
SELECT * FROM t_int32 WHERE val = 9;
â¤ id[4,32,0]  Â¦  val[4,32,0]  ğ„€
1  Â¦  9
SELECT * FROM t_int32 WHERE val = 9.0;
â¤ id[4,32,0]  Â¦  val[4,32,0]  ğ„€
1  Â¦  9
SELECT * FROM t_int32 WHERE val = 9.5;
â¤ id[4,32,0]  Â¦  val[4,32,0]
CREATE TABLE t_float32 (
id INT PRIMARY KEY,
val FLOAT,
KEY idx_val (val)
);
INSERT INTO t_float32 VALUES (1, 9.0), (2, 9.5), (3, 10.0);
EXPLAIN SELECT * FROM t_float32 WHERE val = 9.0;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Index Table Scan on t_float32.idx_val  ğ„€
        Filter Cond: prefix_eq(__mo_index_idx_col)
EXPLAIN SELECT * FROM t_float32 WHERE val = 9;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Index Table Scan on t_float32.idx_val  ğ„€
        Filter Cond: prefix_eq(__mo_index_idx_col)
EXPLAIN SELECT * FROM t_float32 WHERE val >= 9;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Table Scan on index_cast_optimization.t_float32  ğ„€
        Filter Cond: (t_float32.val >= 9)
SELECT * FROM t_float32 WHERE val = 9.0;
â¤ id[4,32,0]  Â¦  val[7,24,0]  ğ„€
1  Â¦  9.0
SELECT * FROM t_float32 WHERE val = 9;
â¤ id[4,32,0]  Â¦  val[7,24,0]  ğ„€
1  Â¦  9.0
SELECT * FROM t_float32 WHERE val >= 9 ORDER BY id;
â¤ id[4,32,0]  Â¦  val[7,24,0]  ğ„€
1  Â¦  9.0  ğ„€
2  Â¦  9.5  ğ„€
3  Â¦  10.0
CREATE TABLE t_float64 (
id INT PRIMARY KEY,
val DOUBLE,
KEY idx_val (val)
);
INSERT INTO t_float64 VALUES (1, 9.0), (2, 9.5), (3, 10.0);
EXPLAIN SELECT * FROM t_float64 WHERE val = 9.0;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Index Table Scan on t_float64.idx_val  ğ„€
        Filter Cond: prefix_eq(__mo_index_idx_col)
EXPLAIN SELECT * FROM t_float64 WHERE val = 9;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Index Table Scan on t_float64.idx_val  ğ„€
        Filter Cond: prefix_eq(__mo_index_idx_col)
SELECT * FROM t_float64 WHERE val = 9.0;
â¤ id[4,32,0]  Â¦  val[8,54,0]  ğ„€
1  Â¦  9.0
SELECT * FROM t_float64 WHERE val = 9;
â¤ id[4,32,0]  Â¦  val[8,54,0]  ğ„€
1  Â¦  9.0
CREATE TABLE t_decimal (
id INT PRIMARY KEY,
val DECIMAL(10,2),
KEY idx_val (val)
);
INSERT INTO t_decimal VALUES (1, 9.00), (2, 9.50), (3, 10.00);
EXPLAIN SELECT * FROM t_decimal WHERE val = 9.0;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Index Table Scan on t_decimal.idx_val  ğ„€
        Filter Cond: prefix_eq(__mo_index_idx_col)
SELECT * FROM t_decimal WHERE val = 9.0;
â¤ id[4,32,0]  Â¦  val[3,10,2]  ğ„€
1  Â¦  9.00
SELECT * FROM t_decimal WHERE val = 9.5;
â¤ id[4,32,0]  Â¦  val[3,10,2]  ğ„€
2  Â¦  9.50
EXPLAIN SELECT * FROM t_float32 WHERE val < 10;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Table Scan on index_cast_optimization.t_float32  ğ„€
        Filter Cond: (t_float32.val < 10)
EXPLAIN SELECT * FROM t_float32 WHERE val <= 10;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Table Scan on index_cast_optimization.t_float32  ğ„€
        Filter Cond: (t_float32.val <= 10)
EXPLAIN SELECT * FROM t_float32 WHERE val > 9;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Table Scan on index_cast_optimization.t_float32  ğ„€
        Filter Cond: (t_float32.val > 9)
EXPLAIN SELECT * FROM t_float32 WHERE val >= 9;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Table Scan on index_cast_optimization.t_float32  ğ„€
        Filter Cond: (t_float32.val >= 9)
EXPLAIN SELECT * FROM t_float32 WHERE val <> 9;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Table Scan on index_cast_optimization.t_float32  ğ„€
        Filter Cond: (t_float32.val <> 9)
SELECT COUNT(*) FROM t_float32 WHERE val < 10;
â¤ COUNT(*)[-5,64,0]  ğ„€
2
SELECT COUNT(*) FROM t_float32 WHERE val <= 10;
â¤ COUNT(*)[-5,64,0]  ğ„€
3
SELECT COUNT(*) FROM t_float32 WHERE val > 9;
â¤ COUNT(*)[-5,64,0]  ğ„€
2
SELECT COUNT(*) FROM t_float32 WHERE val >= 9;
â¤ COUNT(*)[-5,64,0]  ğ„€
3
SELECT COUNT(*) FROM t_float32 WHERE val <> 9;
â¤ COUNT(*)[-5,64,0]  ğ„€
2
EXPLAIN SELECT * FROM t_float32 WHERE val = CAST(9.0 AS DECIMAL);
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Index Table Scan on t_float32.idx_val  ğ„€
        Filter Cond: prefix_eq(__mo_index_idx_col)
EXPLAIN SELECT * FROM t_float32 WHERE val = 8 + 1;
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Index Table Scan on t_float32.idx_val  ğ„€
        Filter Cond: prefix_eq(__mo_index_idx_col)
EXPLAIN SELECT * FROM t_float32 WHERE val = ABS(-9);
â¤ TP QUERY PLAN[12,0,0]  ğ„€
Project  ğ„€
  ->  Index Table Scan on t_float32.idx_val  ğ„€
        Filter Cond: prefix_eq(__mo_index_idx_col)
SELECT * FROM t_float32 WHERE val = CAST(9.0 AS DECIMAL);
â¤ id[4,32,0]  Â¦  val[7,24,0]  ğ„€
1  Â¦  9.0
SELECT * FROM t_float32 WHERE val = 8 + 1;
â¤ id[4,32,0]  Â¦  val[7,24,0]  ğ„€
1  Â¦  9.0
SELECT * FROM t_float32 WHERE val = ABS(-9);
â¤ id[4,32,0]  Â¦  val[7,24,0]  ğ„€
1  Â¦  9.0
DROP TABLE t_int32;
DROP TABLE t_float32;
DROP TABLE t_float64;
DROP TABLE t_decimal;
