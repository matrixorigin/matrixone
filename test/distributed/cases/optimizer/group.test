drop database if exists d1;
create database d1;
use d1;
drop table if exists t1;
create table t1(c1 bigint primary key, c2 varchar(64) not null);
insert into t1 select result, result%10 from generate_series(1,100000)g;
select count(*) from t1;

select sum(c1),c2 from t1 group by c2 order by c2;
delete from t1 where c2=1;
select count(*) from t1;

insert into t1 select result, 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa' from generate_series(100001,200000)g;
select count(*) from t1;

insert into t1 select result, 'bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb' from generate_series(200001,300000)g;
select count(*) from t1;

select sum(c1),c2 from t1 group by c2 order by c2;
drop table if exists t1;
create table t1(c1 bigint, c2 varchar(64)) cluster by c1;
insert into t1 select result, result%5 from generate_series(1,100000)g;
select sum(c1),c2 from t1 group by c2 order by c2;
insert into t1 select result, null from generate_series(1,100000)g;
select sum(c1),c2 from t1 group by c2 order by c2;
delete from t1 where c2=1;
select sum(c1),c2 from t1 group by c2 order by c2;
insert into t1 select result, 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa' from generate_series(100001,200000)g;
insert into t1 select result, 'bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb' from generate_series(200001,300000)g;
select sum(c1),c2 from t1 group by c2 order by c2;
drop table if exists t1;
create table t1(c1 bigint primary key, c2 varchar(64) not null, c3 varchar(64) not null);
insert into t1 select result, result%3, result %4 from generate_series(1,100000)g;
select sum(c1),c2,c3 from t1 group by c2,c3 order by c2,c3;
delete from t1 where c2=1;
insert into t1 select result, 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa','a' from generate_series(100001,200000)g;
insert into t1 select result, 'bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb','b' from generate_series(200001,300000)g;
select sum(c1),c2,c3 from t1 group by c2,c3 order by c2,c3;
drop table if exists t1;
create table t1(c1 bigint, c2 varchar(64), c3 varchar(64)) cluster by c1;
insert into t1 select result, result%4, result%3 from generate_series(1,100000)g;
select sum(c1),c2,c3 from t1 group by c2,c3 order by c2,c3;
insert into t1 select result, null, null from generate_series(1,100000)g;
select sum(c1),c2,c3 from t1 group by c2,c3 order by c2,c3;
delete from t1 where c2=1;
select sum(c1),c2,c3 from t1 group by c2,c3 order by c2,c3;
insert into t1 select result, 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa','a' from generate_series(100001,200000)g;
insert into t1 select result, 'bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb','b' from generate_series(200001,300000)g;
select sum(c1),c2,c3 from t1 group by c2,c3 order by c2,c3;
drop database if exists d1;
