drop database if exists d1;
create database d1;
use d1;
drop table if exists t1;
create table t1(c1 bigint primary key, c2 varchar(64) not null);
insert into t1 select result, result%10 from generate_series(1,100000)g;
select count(*) from t1;
â¤ count(*)[-5,64,0]  ğ„€
100000
select sum(c1),c2 from t1 group by c2 order by c2;
â¤ sum(c1)[-5,64,0]  Â¦  c2[12,-1,0]  ğ„€
500050000  Â¦  0  ğ„€
499960000  Â¦  1  ğ„€
499970000  Â¦  2  ğ„€
499980000  Â¦  3  ğ„€
499990000  Â¦  4  ğ„€
500000000  Â¦  5  ğ„€
500010000  Â¦  6  ğ„€
500020000  Â¦  7  ğ„€
500030000  Â¦  8  ğ„€
500040000  Â¦  9
delete from t1 where c2=1;
select count(*) from t1;
â¤ count(*)[-5,64,0]  ğ„€
90000
insert into t1 select result, 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa' from generate_series(100001,200000)g;
select count(*) from t1;
â¤ count(*)[-5,64,0]  ğ„€
190000
insert into t1 select result, 'bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb' from generate_series(200001,300000)g;
select count(*) from t1;
â¤ count(*)[-5,64,0]  ğ„€
290000
select sum(c1),c2 from t1 group by c2 order by c2;
â¤ sum(c1)[-5,64,0]  Â¦  c2[12,-1,0]  ğ„€
500050000  Â¦  0  ğ„€
499970000  Â¦  2  ğ„€
499980000  Â¦  3  ğ„€
499990000  Â¦  4  ğ„€
500000000  Â¦  5  ğ„€
500010000  Â¦  6  ğ„€
500020000  Â¦  7  ğ„€
500030000  Â¦  8  ğ„€
500040000  Â¦  9  ğ„€
15000050000  Â¦  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa  ğ„€
25000050000  Â¦  bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
drop table if exists t1;
create table t1(c1 bigint, c2 varchar(64)) cluster by c1;
insert into t1 select result, result%5 from generate_series(1,100000)g;
select sum(c1),c2 from t1 group by c2 order by c2;
â¤ sum(c1)[-5,64,0]  Â¦  c2[12,-1,0]  ğ„€
1000050000  Â¦  0  ğ„€
999970000  Â¦  1  ğ„€
999990000  Â¦  2  ğ„€
1000010000  Â¦  3  ğ„€
1000030000  Â¦  4
insert into t1 select result, null from generate_series(1,100000)g;
select sum(c1),c2 from t1 group by c2 order by c2;
â¤ sum(c1)[-5,64,0]  Â¦  c2[12,-1,0]  ğ„€
5000050000  Â¦  null  ğ„€
1000050000  Â¦  0  ğ„€
999970000  Â¦  1  ğ„€
999990000  Â¦  2  ğ„€
1000010000  Â¦  3  ğ„€
1000030000  Â¦  4
delete from t1 where c2=1;
select sum(c1),c2 from t1 group by c2 order by c2;
â¤ sum(c1)[-5,64,0]  Â¦  c2[12,-1,0]  ğ„€
5000050000  Â¦  null  ğ„€
1000050000  Â¦  0  ğ„€
999990000  Â¦  2  ğ„€
1000010000  Â¦  3  ğ„€
1000030000  Â¦  4
insert into t1 select result, 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa' from generate_series(100001,200000)g;
insert into t1 select result, 'bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb' from generate_series(200001,300000)g;
select sum(c1),c2 from t1 group by c2 order by c2;
â¤ sum(c1)[-5,64,0]  Â¦  c2[12,-1,0]  ğ„€
5000050000  Â¦  null  ğ„€
1000050000  Â¦  0  ğ„€
999990000  Â¦  2  ğ„€
1000010000  Â¦  3  ğ„€
1000030000  Â¦  4  ğ„€
15000050000  Â¦  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa  ğ„€
25000050000  Â¦  bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
drop table if exists t1;
create table t1(c1 bigint primary key, c2 varchar(64) not null, c3 varchar(64) not null);
insert into t1 select result, result%3, result %4 from generate_series(1,100000)g;
select sum(c1),c2,c3 from t1 group by c2,c3 order by c2,c3;
â¤ sum(c1)[-5,64,0]  Â¦  c2[12,-1,0]  Â¦  c3[12,-1,0]  ğ„€
416683332  Â¦  0  Â¦  0  ğ„€
416658333  Â¦  0  Â¦  1  ğ„€
416633334  Â¦  0  Â¦  2  ğ„€
416708334  Â¦  0  Â¦  3  ğ„€
416716668  Â¦  1  Â¦  0  ğ„€
416691666  Â¦  1  Â¦  1  ğ„€
416666666  Â¦  1  Â¦  2  ğ„€
416641667  Â¦  1  Â¦  3  ğ„€
416650000  Â¦  2  Â¦  0  ğ„€
416625001  Â¦  2  Â¦  1  ğ„€
416700000  Â¦  2  Â¦  2  ğ„€
416674999  Â¦  2  Â¦  3
delete from t1 where c2=1;
insert into t1 select result, 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa','a' from generate_series(100001,200000)g;
insert into t1 select result, 'bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb','b' from generate_series(200001,300000)g;
select sum(c1),c2,c3 from t1 group by c2,c3 order by c2,c3;
â¤ sum(c1)[-5,64,0]  Â¦  c2[12,-1,0]  Â¦  c3[12,-1,0]  ğ„€
416683332  Â¦  0  Â¦  0  ğ„€
416658333  Â¦  0  Â¦  1  ğ„€
416633334  Â¦  0  Â¦  2  ğ„€
416708334  Â¦  0  Â¦  3  ğ„€
416650000  Â¦  2  Â¦  0  ğ„€
416625001  Â¦  2  Â¦  1  ğ„€
416700000  Â¦  2  Â¦  2  ğ„€
416674999  Â¦  2  Â¦  3  ğ„€
15000050000  Â¦  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa  Â¦  a  ğ„€
25000050000  Â¦  bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb  Â¦  b
drop table if exists t1;
create table t1(c1 bigint, c2 varchar(64), c3 varchar(64)) cluster by c1;
insert into t1 select result, result%4, result%3 from generate_series(1,100000)g;
select sum(c1),c2,c3 from t1 group by c2,c3 order by c2,c3;
â¤ sum(c1)[-5,64,0]  Â¦  c2[12,-1,0]  Â¦  c3[12,-1,0]  ğ„€
416683332  Â¦  0  Â¦  0  ğ„€
416716668  Â¦  0  Â¦  1  ğ„€
416650000  Â¦  0  Â¦  2  ğ„€
416658333  Â¦  1  Â¦  0  ğ„€
416691666  Â¦  1  Â¦  1  ğ„€
416625001  Â¦  1  Â¦  2  ğ„€
416633334  Â¦  2  Â¦  0  ğ„€
416666666  Â¦  2  Â¦  1  ğ„€
416700000  Â¦  2  Â¦  2  ğ„€
416708334  Â¦  3  Â¦  0  ğ„€
416641667  Â¦  3  Â¦  1  ğ„€
416674999  Â¦  3  Â¦  2
insert into t1 select result, null, null from generate_series(1,100000)g;
select sum(c1),c2,c3 from t1 group by c2,c3 order by c2,c3;
â¤ sum(c1)[-5,64,0]  Â¦  c2[12,-1,0]  Â¦  c3[12,-1,0]  ğ„€
5000050000  Â¦  null  Â¦  null  ğ„€
416683332  Â¦  0  Â¦  0  ğ„€
416716668  Â¦  0  Â¦  1  ğ„€
416650000  Â¦  0  Â¦  2  ğ„€
416658333  Â¦  1  Â¦  0  ğ„€
416691666  Â¦  1  Â¦  1  ğ„€
416625001  Â¦  1  Â¦  2  ğ„€
416633334  Â¦  2  Â¦  0  ğ„€
416666666  Â¦  2  Â¦  1  ğ„€
416700000  Â¦  2  Â¦  2  ğ„€
416708334  Â¦  3  Â¦  0  ğ„€
416641667  Â¦  3  Â¦  1  ğ„€
416674999  Â¦  3  Â¦  2
delete from t1 where c2=1;
select sum(c1),c2,c3 from t1 group by c2,c3 order by c2,c3;
â¤ sum(c1)[-5,64,0]  Â¦  c2[12,-1,0]  Â¦  c3[12,-1,0]  ğ„€
5000050000  Â¦  null  Â¦  null  ğ„€
416683332  Â¦  0  Â¦  0  ğ„€
416716668  Â¦  0  Â¦  1  ğ„€
416650000  Â¦  0  Â¦  2  ğ„€
416633334  Â¦  2  Â¦  0  ğ„€
416666666  Â¦  2  Â¦  1  ğ„€
416700000  Â¦  2  Â¦  2  ğ„€
416708334  Â¦  3  Â¦  0  ğ„€
416641667  Â¦  3  Â¦  1  ğ„€
416674999  Â¦  3  Â¦  2
insert into t1 select result, 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa','a' from generate_series(100001,200000)g;
insert into t1 select result, 'bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb','b' from generate_series(200001,300000)g;
select sum(c1),c2,c3 from t1 group by c2,c3 order by c2,c3;
â¤ sum(c1)[-5,64,0]  Â¦  c2[12,-1,0]  Â¦  c3[12,-1,0]  ğ„€
5000050000  Â¦  null  Â¦  null  ğ„€
416683332  Â¦  0  Â¦  0  ğ„€
416716668  Â¦  0  Â¦  1  ğ„€
416650000  Â¦  0  Â¦  2  ğ„€
416633334  Â¦  2  Â¦  0  ğ„€
416666666  Â¦  2  Â¦  1  ğ„€
416700000  Â¦  2  Â¦  2  ğ„€
416708334  Â¦  3  Â¦  0  ğ„€
416641667  Â¦  3  Â¦  1  ğ„€
416674999  Â¦  3  Â¦  2  ğ„€
15000050000  Â¦  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa  Â¦  a  ğ„€
25000050000  Â¦  bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb  Â¦  b
drop database if exists d1;
