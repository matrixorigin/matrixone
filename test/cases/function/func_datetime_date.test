#各种数据类型
-- @bvt:issue#3588
SELECT DATE(0.0124);
-- @bvt:issue
SELECT DATE("2112123");
-- @bvt:issue#3588
SELECT DATE(1231241.4513);
-- @bvt:issue
SELECT DATE("2017-06-15");


SELECT DATE("2017-06-15 09:34:21");

SELECT DATE("The date is 2017-06-15");


SELECT DATE('2008-05-17 11:31:31') as required_DATE;


#NULL值
-- @bvt:issue#3183
select coalesce(date(NULL)), coalesce(cast(NULL as DATE));
-- @bvt:issue
select date(NULL);


#函数嵌套

CREATE TABLE t1 (d1 datetime);
INSERT INTO t1(d1) VALUES ('2007-07-19 08:30:00'), (NULL),
('2007-07-19 08:34:00'), (NULL), ('2007-07-19 08:36:00');
-- @bvt:issue#3588
SELECT cast(date(d1) as signed) FROM t1;
-- @bvt:issue
drop table t1;


#函数嵌套

CREATE TABLE t1 (d1 datetime);
INSERT INTO t1(d1) VALUES ('2007-07-19 08:30:00'), (NULL),
('2007-07-19 08:34:00'), (NULL), ('2007-07-19 08:36:00');
-- @bvt:issue#3588
SELECT sum(date(d1)) FROM t1;
-- @bvt:issue
drop table t1;


#函数嵌套
#CREATE TABLE t1 AS
#SELECT
#DATE_ADD('2007-08-03', INTERVAL 1 MINUTE) AS field_str1,
#DATE_ADD('2007-08-03 17:33:00', INTERVAL 1 MINUTE) AS field1_str2,
#DATE_ADD(DATE('2007-08-03'), INTERVAL 1 DAY) AS field_date,
#DATE_ADD(CAST('2007-08-03 17:33:00' AS DATETIME), INTERVAL 1 MINUTE) AS field_datetime;
#SELECT * FROM t1;
#DROP TABLE t1;


#EXTREME VALUES

select date("1997-12-31 23:59:59.000001");


select date("1997-13-31 23:59:59.000001");
-- @bvt:issue#3588
SELECT DATE(20110512154559.6 + 0e0);
-- @bvt:issue

SELECT DATE(concat_ws('a', 0));


#timestamp type
CREATE TABLE t1 (a timestamp);
INSERT INTO t1 VALUES ("2020-12-31 12:01:32");
SELECT DATE(MIN(a)) FROM t1;
DROP TABLE t1;


#逻辑比较
-- @bvt:issue#3183
CREATE TABLE t1
(first_usage DATE, last_recharge DATETIME, life_time SMALLINT(4) UNSIGNED);
INSERT INTO t1 VALUES ('2011-04-27', null, 900);
SELECT
DATE_ADD(coalesce(last_recharge, first_usage), INTERVAL life_time DAY ) as dt,
DATE_ADD(coalesce(last_recharge, first_usage), INTERVAL life_time DAY ) <
DATE('2011-04-28') as exp FROM t1;
DROP TABLE t1;
-- @bvt:issue


#EXTREME VALUES
-- @bvt:issue#3588
SELECT DATE(20110512154559.616), DATE(FLOOR(20110512154559.616));
-- @bvt:issue

#各种数据类型
DROP TABLE IF EXISTS t3;
CREATE TABLE t3(c1 DATE NOT NULL);
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('1999-12-31');
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('2006-12-25');
INSERT INTO t3 VALUES('2008-02-29');
SELECT DATE(c1) FROM t3;
DROP TABLE t3;
CREATE TABLE t3(c1 DATETIME NOT NULL);
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('1999-12-31');
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('2006-12-25');
INSERT INTO t3 VALUES('2008-02-29');
SELECT DATE(c1) FROM t3;
DROP TABLE t3;
CREATE TABLE t3(c1 TIMESTAMP NOT NULL);
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('1999-12-31');
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('2006-12-25');
INSERT INTO t3 VALUES('2008-02-29');
SELECT DATE(c1) FROM t3;
DROP TABLE t3;

#0.5 not supported
#/* 
#CREATE TABLE t3(c1 DATE NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT DAYNAME(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 DATETIME NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT DAYNAME(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 TIMESTAMP NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT DAYNAME(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 DATE NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT DAYOFMONTH(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 DATETIME NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT DAYOFMONTH(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 TIMESTAMP NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT DAYOFMONTH(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 DATE NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT DAYOFWEEK(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 DATETIME NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT DAYOFWEEK(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 TIMESTAMP NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT DAYOFWEEK(c1) FROM t3;
#DROP TABLE t3; 
#*/


CREATE TABLE t3(c1 DATE NOT NULL);
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('1999-12-31');
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('2006-12-25');
INSERT INTO t3 VALUES('2008-02-29');
SELECT DAYOFYEAR(c1) FROM t3;
DROP TABLE t3;

CREATE TABLE t3(c1 DATETIME NOT NULL);
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('1999-12-31');
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('2006-12-25');
INSERT INTO t3 VALUES('2008-02-29');
SELECT DAYOFYEAR(c1) FROM t3;
DROP TABLE t3;
CREATE TABLE t3(c1 TIMESTAMP NOT NULL);
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('1999-12-31');
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('2006-12-25');
INSERT INTO t3 VALUES('2008-02-29');
SELECT DAYOFYEAR(c1) FROM t3;
DROP TABLE t3;
-- @bvt:issue

#0.5 not supported
#/* 
#CREATE TABLE t3(c1 DATE NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT FROM_DAYS(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 DATETIME NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT FROM_DAYS(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 TIMESTAMP NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT FROM_DAYS(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 DATE NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT LAST_DAY(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 DATETIME NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT LAST_DAY(c1) FROM t3;
#DROP TABLE t3;
#*/

CREATE TABLE t3(c1 DATE NOT NULL);
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('1999-12-31');
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('2006-12-25');
INSERT INTO t3 VALUES('2008-02-29');
SELECT MONTH(c1) FROM t3;
DROP TABLE t3;
CREATE TABLE t3(c1 DATETIME NOT NULL);
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('1999-12-31');
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('2006-12-25');
INSERT INTO t3 VALUES('2008-02-29');
SELECT MONTH(c1) FROM t3;
DROP TABLE t3;

CREATE TABLE t3(c1 TIMESTAMP NOT NULL);
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('1999-12-31');
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('2006-12-25');
INSERT INTO t3 VALUES('2008-02-29');
SELECT MONTH(c1) FROM t3;
DROP TABLE t3;


#0.5 not supported
#/* 
#CREATE TABLE t3(c1 DATE NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT MONTHNAME(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 DATETIME NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT MONTHNAME(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 TIMESTAMP NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT MONTHNAME(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 DATE NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT QUARTER(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 DATETIME NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT QUARTER(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 TIMESTAMP NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT QUARTER(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 DATE NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT TIMESTAMP(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 DATETIME NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT TIMESTAMP(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 TIMESTAMP NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT TIMESTAMP(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 DATE NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT TO_DAYS(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 DATETIME NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT TO_DAYS(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 TIMESTAMP NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT TO_DAYS(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 DATE NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT WEEK(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 DATETIME NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT WEEK(c1) FROM t3;
#DROP TABLE t3;
#CREATE TABLE t3(c1 TIMESTAMP NOT NULL);
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('1999-12-31');
#INSERT INTO t3 VALUES('2000-01-01');
#INSERT INTO t3 VALUES('2006-12-25');
#INSERT INTO t3 VALUES('2008-02-29');
#SELECT WEEK(c1) FROM t3;
#DROP TABLE t3; 
#*/

CREATE TABLE t3(c1 DATE NOT NULL);
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('1999-12-31');
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('2006-12-25');
INSERT INTO t3 VALUES('2008-02-29');
SELECT WEEKDAY(c1) FROM t3;
DROP TABLE t3;

CREATE TABLE t3(c1 DATETIME NOT NULL);
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('1999-12-31');
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('2006-12-25');
INSERT INTO t3 VALUES('2008-02-29');
SELECT WEEKDAY(c1) FROM t3;
DROP TABLE t3;

CREATE TABLE t3(c1 TIMESTAMP NOT NULL);
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('1999-12-31');
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('2006-12-25');
INSERT INTO t3 VALUES('2008-02-29');
SELECT WEEKDAY(c1) FROM t3;
DROP TABLE t3;

# /* CREATE TABLE t3(c1 DATE NOT NULL);
# INSERT INTO t3 VALUES('2000-01-01');
# INSERT INTO t3 VALUES('1999-12-31');
# INSERT INTO t3 VALUES('2000-01-01');
# INSERT INTO t3 VALUES('2006-12-25');
# INSERT INTO t3 VALUES('2008-02-29');
# SELECT WEEKOFYEAR(c1) FROM t3;
# DROP TABLE t3;
# CREATE TABLE t3(c1 DATETIME NOT NULL);
# INSERT INTO t3 VALUES('2000-01-01');
# INSERT INTO t3 VALUES('1999-12-31');
# INSERT INTO t3 VALUES('2000-01-01');
# INSERT INTO t3 VALUES('2006-12-25');
# INSERT INTO t3 VALUES('2008-02-29');
# SELECT WEEKOFYEAR(c1) FROM t3;
# DROP TABLE t3;
# CREATE TABLE t3(c1 TIMESTAMP NOT NULL);
# INSERT INTO t3 VALUES('2000-01-01');
# INSERT INTO t3 VALUES('1999-12-31');
# INSERT INTO t3 VALUES('2000-01-01');
# INSERT INTO t3 VALUES('2006-12-25');
# INSERT INTO t3 VALUES('2008-02-29');
# SELECT WEEKOFYEAR(c1) FROM t3;
# DROP TABLE t3; */


CREATE TABLE t3(c1 DATE NOT NULL);
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('1999-12-31');
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('2006-12-25');
INSERT INTO t3 VALUES('2008-02-29');
SELECT YEAR(c1) FROM t3;
DROP TABLE t3;

CREATE TABLE t3(c1 DATETIME NOT NULL);
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('1999-12-31');
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('2006-12-25');
INSERT INTO t3 VALUES('2008-02-29');
SELECT YEAR(c1) FROM t3;
DROP TABLE t3;

CREATE TABLE t3(c1 TIMESTAMP NOT NULL);
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('1999-12-31');
INSERT INTO t3 VALUES('2000-01-01');
INSERT INTO t3 VALUES('2006-12-25');
INSERT INTO t3 VALUES('2008-02-29');
SELECT YEAR(c1) FROM t3;
DROP TABLE t3;

# /* CREATE TABLE t3(c1 DATE NOT NULL);
# INSERT INTO t3 VALUES('2000-01-01');
# INSERT INTO t3 VALUES('1999-12-31');
# INSERT INTO t3 VALUES('2000-01-01');
# INSERT INTO t3 VALUES('2006-12-25');
# INSERT INTO t3 VALUES('2008-02-29');
# SELECT YEARWEEK(c1) FROM t3;
# DROP TABLE t3;
# CREATE TABLE t3(c1 DATETIME NOT NULL);
# INSERT INTO t3 VALUES('2000-01-01');
# INSERT INTO t3 VALUES('1999-12-31');
# INSERT INTO t3 VALUES('2000-01-01');
# INSERT INTO t3 VALUES('2006-12-25');
# INSERT INTO t3 VALUES('2008-02-29');
# SELECT YEARWEEK(c1) FROM t3;
# DROP TABLE t3;
# CREATE TABLE t3(c1 TIMESTAMP NOT NULL);
# INSERT INTO t3 VALUES('2000-01-01');
# INSERT INTO t3 VALUES('1999-12-31');
# INSERT INTO t3 VALUES('2000-01-01');
# INSERT INTO t3 VALUES('2006-12-25');
# INSERT INTO t3 VALUES('2008-02-29');
# SELECT YEARWEEK(c1) FROM t3;
# DROP TABLE t3; */

#逻辑操作

#SELECT date(now()) = date(utc_timestamp());



SELECT date("2022-12-22 02:34:23") = date("2022-12-22 03:34:23");


#insert & distinct

drop table if exists t1;
create table t1(a date);
insert into t1 SELECT DATE("2017-06-15 09:34:21");
insert into t1 SELECT DATE("2019-06-25 10:12:21");
insert into t1 SELECT DATE("2019-06-25 18:20:49");
select distinct a from t1;
drop table t1;


#HAVING & 算术运算

drop table if exists t1;
create table t1(a INT,  b datetime);
insert into t1 values(1, "2017-06-15 09:34:21"),(1, "2019-06-25 10:12:21"),(2, "2019-06-25 18:20:49"),(3, "2019-06-25 18:20:49");
select b from t1 group by b having date(b)>"2018-01-01";
drop table t1;


#WHERE

drop table if exists t1;
create table t1(a INT,  b date);
insert into t1 values(1, "2012-10-12"),(2, "2004-04-24"),(3, "2008-12-04"),(4, "2012-03-23");
select * from t1 where date(b)!="2012-10-12";
drop table t1;



#ON CONDITION
create table t1(a INT,  b date);
create table t2(a INT,  b date);
insert into t1 values(1, "2012-10-12"),(2, "2004-04-24"),(3, "2008-12-04"),(4, "2012-03-23");
insert into t2 values(1, "2013-04-30"),(2, "1994-10-04"),(3, "2018-06-04"),(4, "2012-10-12");
SELECT t1.a, t2.a FROM t1 JOIN t2 ON (date(t1.b) = date(t2.b));
drop table t1;
drop table t2;
