version: '3.9'

services:
  node0:
    container_name: node0
    image: matrixorigin/matrixone:test
    ports:
      - "10000"
      - "20000"
      - "20100"
      - "30000"
      - "40000"
      - "50000"
      - "6001:6001"
    volumes:
      - $PWD/config0/config.toml:/opt/matrixone/system_vars_config.toml:ro
    restart: on-failure
    tty: true
    networks:
      monet:
        ipv4_address: 172.19.0.2

  node1:
    container_name: node1
    image: matrixorigin/matrixone:test
    ports:
      - "10000"
      - "20000"
      - "20100"
      - "30000"
      - "40000"
      - "50000"
      - "6002:6001"
    volumes:
      - $PWD/config1/config.toml:/opt/matrixone/system_vars_config.toml:ro
    restart: on-failure
    tty: true
    networks:
      monet:
        ipv4_address: 172.19.0.3

  node2:
    container_name: node2
    image: matrixorigin/matrixone:test
    ports:
      - "40000"
      - "50000"
      - "20100"
      - "10000"
      - "20000"
      - "30000"
      - "6003:6001"
    volumes:
      - $PWD/config2/config.toml:/opt/matrixone/system_vars_config.toml:ro
    restart: on-failure
    tty: true
    networks:
      monet:
        ipv4_address: 172.19.0.4
networks:
  monet:
    driver: bridge
    ipam:
      config:
        - subnet: 172.19.0.0/16
